
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Zehua Zeng" name="author"/>
<link href="../pp/pyg_knn_implementation/" rel="prev"/>
<link href="../space/" rel="next"/>
<link href="../../../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.1.2" name="generator"/>
<title>single - omicverse Readthedocs</title>
<link href="../../../assets/stylesheets/main.7bf56d0a.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/mkapi-common.css" rel="stylesheet"/>
<link href="../../../css/mkapi-material.css" rel="stylesheet"/>
<link href="../../../css/tags.css" rel="stylesheet"/>
<link href="../../../css/custom.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#omicverse.single">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="omicverse Readthedocs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            omicverse Readthedocs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              single
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="omicverse Readthedocs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
    omicverse Readthedocs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Index
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Installation_guild/">
        Installation
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Bulk
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
          Bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_1">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_bulk_combat/">
        Batch correction in Bulk RNA-seq or microarray data
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_2">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deg/">
        Different Expression Analysis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deseq2/">
        Different Expression Analysis with DEseq2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_network/">
        Protein-Protein interaction (PPI) analysis by String-db
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_wgcna/">
        WGCNA (Weighted gene co-expression network analysis) analysis
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_3">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_decov_bulk/">
        Bulk deconvolution with reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
          Others
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_4">
<span class="md-nav__icon md-icon"></span>
          Others
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_tcga/">
        TCGA database preprocess
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          Alignment
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_1">
<span class="md-nav__icon md-icon"></span>
          Alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_1k/">
        Alignment and analysis of single-cell RNA-seq data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_velocity/">
        Alignment and RNA velocity analysis of single-cell RNA-seq data.
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_2">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_cpu/">
        Preprocessing the data of scRNA-seq with omicverse[CPU-GPU-mixed]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_gpu/">
        Preprocessing the data of scRNA-seq with omicverse[GPU]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cluster/">
        Clustering space
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_single_batch/">
        Data integration and batch correction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cnmf/">
        GeneModule Identified
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_lazy/">
        Lazy analysis of scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
          Annotation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_3">
<span class="md-nav__icon md-icon"></span>
          Annotation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_noref/">
        Reference-free automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_ref/">
        Reference automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_gptanno/">
        Automatic cell type annotation with GPT/Other
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellmatch/">
        Mapping Cell Names to the Cell Ontology/Taxonomy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellanno/">
        Celltype auto annotation with SCSA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metatime/">
        Celltype auto annotation with MetaTiME
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_tosica/">
        Celltype annotation migration(mapping) with TOSICA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scmulan/">
        Celltype auto annotation with scMulan
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellvote/">
        Consensus annotation with CellVote
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
          Trajectory
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
          Trajectory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cytotrace/">
        Prediction of absolute developmental potential using CytoTrace2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_traj/">
        Basic Trajectory Inference
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_stavia/">
        Trajectory Inference with StaVIA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate_gene/">
        Timing-associated genes analysis with TimeFateKernel
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate/">
        Identify the driver regulators of cell fate decisions
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
          Cell Structure
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_5">
<span class="md-nav__icon md-icon"></span>
          Cell Structure
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metacells/">
        Inference of MetaCell from Single-Cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_deg_single/">
        Differential expression and celltype analysis [All Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdeg/">
        Differential expression analysis [Meta Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scenic/">
        Gene Regulatory Network Analysis with SCENIC
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_aucell/">
        Pathway analysis with AUCell
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellphonedb/">
        Cell-cell communication using CellPhoneDBViz
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdrug/">
        Drug response predict with scDrug
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_simba/">
        Data integration and batch correction with SIMBA
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
          Velocity
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_6">
<span class="md-nav__icon md-icon"></span>
          Velocity
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_velo/">
        Velocity Basic Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_graphvelo/">
        Velocity Optimization
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_7" id="__nav_3_2_7_label" tabindex="0">
          Multi omics
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_7">
<span class="md-nav__icon md-icon"></span>
          Multi omics
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa/">
        Multi omics analysis by MOFA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa_glue/">
        Multi omics analysis by MOFA and GLUE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_trans/">
        Celltype annotation transfer in multi-omics
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Bulk2Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          Bulk2Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulktrajblend/">
        Bulk RNA-seq generate 'interrupted' cells to interpolate scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulk2single/">
        Bulk RNA-seq to Single RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_single2spatial/">
        Single RNA-seq to Spatial RNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Space
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
          Space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
          Preprocess
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_1">
<span class="md-nav__icon md-icon"></span>
          Preprocess
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_crop_rotate/">
        Crop and Rotation of spatial transcriptomic data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cellpose/">
        Cell Segmemtation (10x HD)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cluster_space/">
        Spatial clustering and denoising expressions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_staligner/">
        Spatial integration and clustering
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_2">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_spaceflow/">
        Identifying Pseudo-Spatial Map
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_decov/">
        Spatial deconvolution with reference scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_flashdeconv/">
        FlashDeconv: Fast Spatial Deconvolution via Structure-Preserving Sketching
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_starfysh_new/">
        Spatial deconvolution without reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_3">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_stt/">
        Spatial transition tensor of single cells
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_commot_flowsig/">
        Spatial Communication
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_gaston/">
        Spatial IsoDepth Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_slat/">
        Single cell spatial alignment tools
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          LLM
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          LLM
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr/">
        Domain Research (dr): Comprehensive Report Tutorial
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr_web/">
        Domain Research (dr) — Live Web
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_ov_agent_pbmc3k/">
        ov.Agent with Skills: Natural‑Language Single‑Cell Analysis (PBMC3k)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_uce/">
        UCE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scgpt/">
        scGPT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scfoundation/">
        scFoundation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_geneformer/">
        GeneFormer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_cellplm/">
        CellPLM
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Plotting
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
          Plotting
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_single/">
        Visualization of single cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_bulk/">
        Visualization of Bulk RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_colorsystem/">
        Color system
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../GPU_supported_registry_functions/">
        GPU Support
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">API documentation</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../agent/">agent</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          agent
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../alignment/">alignment</a>
<label for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
          alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../alignment/kb_api/">
        kb_api
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk/">bulk</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk2single/">bulk2single</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
          bulk2single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../datasets/">datasets</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_6">
<span class="md-nav__icon md-icon"></span>
          datasets
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pl/">pl</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
          pl
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/">pp</a>
<label for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
          pp
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/experimental/">experimental</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_8_2">
<span class="md-nav__icon md-icon"></span>
          experimental
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pp/pyg_knn_implementation/">
        pyg_knn_implementation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_9" type="checkbox"/>
<div class="md-nav__link md-nav__link--index md-nav__link--active">
<a href="./">single</a>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_9">
<span class="md-nav__icon md-icon"></span>
          single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_10" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../space/">space</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_10">
<span class="md-nav__icon md-icon"></span>
          space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_11" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../utils/">utils</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_11">
<span class="md-nav__icon md-icon"></span>
          utils
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Release_notes/">
        Release notes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Developer_guild/">
        Developer guild
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cosg">
    cosg
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy">
    lazy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_checkpoint">
    lazy_checkpoint
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.resume_from_checkpoint">
    resume_from_checkpoint
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.list_checkpoints">
    list_checkpoints
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cleanup_checkpoints">
    cleanup_checkpoints
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_qc">
    lazy_step_qc
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_preprocess">
    lazy_step_preprocess
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_scale">
    lazy_step_scale
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_pca">
    lazy_step_pca
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_cell_cycle">
    lazy_step_cell_cycle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_harmony">
    lazy_step_harmony
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_scvi">
    lazy_step_scvi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_select_best_method">
    lazy_step_select_best_method
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_mde">
    lazy_step_mde
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_clustering">
    lazy_step_clustering
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_final_embeddings">
    lazy_step_final_embeddings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.lazy_step_by_step_guide">
    lazy_step_by_step_guide
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.aucell">
    aucell
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA">
    pySCSA
  </a>
<nav aria-label="pySCSA" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA.get_model_tissue">
    get_model_tissue
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA.cell_anno">
    cell_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA.cell_anno_print">
    cell_anno_print
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA.cell_auto_anno">
    cell_auto_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySCSA.get_celltype_marker">
    get_celltype_marker
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.MetaTiME">
    MetaTiME
  </a>
<nav aria-label="MetaTiME" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.MetaTiME.overcluster">
    overcluster
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.MetaTiME.predictTiME">
    predictTiME
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.MetaTiME.plot">
    plot
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scanpy_lazy">
    scanpy_lazy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scanpy_cellanno_from_dict">
    scanpy_cellanno_from_dict
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.get_celltype_marker">
    get_celltype_marker
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gptcelltype">
    gptcelltype
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gpt4celltype">
    gpt4celltype
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.get_cluster_celltype">
    get_cluster_celltype
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gptcelltype_local">
    gptcelltype_local
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote">
    CellVote
  </a>
<nav aria-label="CellVote" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.popv_anno">
    popv_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.scsa_anno">
    scsa_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.gpt_anno">
    gpt_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.gbi_anno">
    gbi_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.scMulan_anno">
    scMulan_anno
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellVote.vote">
    vote
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper">
    CellOntologyMapper
  </a>
<nav aria-label="CellOntologyMapper" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.setup_llm_expansion">
    setup_llm_expansion
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.test_abbreviation_detection">
    test_abbreviation_detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.expand_abbreviations">
    expand_abbreviations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_cells_with_expansion">
    map_cells_with_expansion
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.show_expansion_summary">
    show_expansion_summary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.clear_abbreviation_cache">
    clear_abbreviation_cache
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.set_model">
    set_model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.set_local_model">
    set_local_model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.create_ontology_resources">
    create_ontology_resources
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.save_embeddings">
    save_embeddings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.load_embeddings">
    load_embeddings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.load_ontology_mappings">
    load_ontology_mappings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.check_ontology_status">
    check_ontology_status
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_cells">
    map_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_adata">
    map_adata
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.get_statistics">
    get_statistics
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids">
    print_mapping_summary_with_ids
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.print_mapping_summary">
    print_mapping_summary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.save_mapping_results">
    save_mapping_results
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.list_ontology_cells">
    list_ontology_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.search_ontology_cells">
    search_ontology_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.get_cell_info">
    get_cell_info
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.browse_ontology_by_category">
    browse_ontology_by_category
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.get_ontology_statistics">
    get_ontology_statistics
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.find_similar_cells">
    find_similar_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.download_model">
    download_model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource">
    load_cell_taxonomy_resource
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_cells_with_taxonomy">
    map_cells_with_taxonomy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.search_by_marker">
    search_by_marker
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_adata_with_taxonomy">
    map_adata_with_taxonomy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy">
    print_mapping_summary_taxonomy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy">
    find_similar_cells_taxonomy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.get_cell_info_taxonomy">
    get_cell_info_taxonomy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.CellOntologyMapper.map_adata_with_expansion">
    map_adata_with_expansion
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.download_cl">
    download_cl
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART">
    pyMOFAART
  </a>
<nav aria-label="pyMOFAART" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.get_factors">
    get_factors
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.get_r2">
    get_r2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_r2">
    plot_r2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.get_cor">
    get_cor
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_cor">
    plot_cor
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_factor">
    plot_factor
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_weight_gene_d1">
    plot_weight_gene_d1
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_weight_gene_d2">
    plot_weight_gene_d2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_weights_gene_factor">
    plot_weights_gene_factor
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_top_feature_dotplot">
    plot_top_feature_dotplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.plot_top_feature_heatmap">
    plot_top_feature_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFAART.get_top_feature">
    get_top_feature
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFA">
    pyMOFA
  </a>
<nav aria-label="pyMOFA" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFA.mofa_preprocess">
    mofa_preprocess
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyMOFA.mofa_run">
    mofa_run
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.GLUE_pair">
    GLUE_pair
  </a>
<nav aria-label="GLUE_pair" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.GLUE_pair.correlation">
    correlation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.GLUE_pair.find_neighbor_cell">
    find_neighbor_cell
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.GLUE_pair.pair_omic">
    pair_omic
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.factor_exact">
    factor_exact
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.factor_correlation">
    factor_correlation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.get_weights">
    get_weights
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.glue_pair">
    glue_pair
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.get_r2_from_hdf5">
    get_r2_from_hdf5
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA">
    pySIMBA
  </a>
<nav aria-label="pySIMBA" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.check_simba">
    check_simba
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.preprocess">
    preprocess
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.gen_graph">
    gen_graph
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.train">
    train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.load">
    load
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pySIMBA.batch_correction">
    batch_correction
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyTOSICA">
    pyTOSICA
  </a>
<nav aria-label="pyTOSICA" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyTOSICA.train">
    train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyTOSICA.save">
    save
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyTOSICA.load">
    load
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyTOSICA.predicted">
    predicted
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TFIDF_LSI">
    TFIDF_LSI
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input">
    Input
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Wrapper">
    Wrapper
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input_1">
    Input
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Integration">
    Integration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input_2">
    Input
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Batch">
    Batch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input_3">
    Input
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.convert_r2_to_matrix">
    convert_r2_to_matrix
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.factor_group_correlation_mdata">
    factor_group_correlation_mdata
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.plot_factor_group_associations">
    plot_factor_group_associations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.plot_factor_boxplots">
    plot_factor_boxplots
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.plot_factors_violin">
    plot_factors_violin
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.plot_weights">
    plot_weights
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer">
    TrajInfer
  </a>
<nav aria-label="TrajInfer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.set_terminal_cells">
    set_terminal_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.set_origin_cells">
    set_origin_cells
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.inference">
    inference
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.palantir_plot_pseudotime">
    palantir_plot_pseudotime
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.palantir_cal_branch">
    palantir_cal_branch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.palantir_cal_gene_trends">
    palantir_cal_gene_trends
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.TrajInfer.palantir_plot_gene_trends">
    palantir_plot_gene_trends
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.fle">
    fle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.diffmap">
    diffmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN">
    scLTNN
  </a>
<nav aria-label="scLTNN" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANNmodel_init">
    ANNmodel_init
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANNmodel_train">
    ANNmodel_train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANNmodel_predicted">
    ANNmodel_predicted
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANNmodel_save">
    ANNmodel_save
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANNmodel_load">
    ANNmodel_load
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_paga">
    cal_paga
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_model_time">
    cal_model_time
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_exp_gene_value">
    cal_exp_gene_value
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_dpt_pseudotime">
    cal_dpt_pseudotime
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.ANN">
    ANN
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_distrubute">
    cal_distrubute
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.distribute_fun">
    distribute_fun
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scLTNN.cal_scLTNN_time">
    cal_scLTNN_time
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.plot_origin_tesmination">
    plot_origin_tesmination
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.find_related_gene">
    find_related_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cytotrace2">
    cytotrace2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate">
    Fate
  </a>
<nav aria-label="Fate" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.model_init">
    model_init
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.atac_init">
    atac_init
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_related_peak">
    get_related_peak
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.ATR">
    ATR
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.model_fit">
    model_fit
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.kendalltau_filter">
    kendalltau_filter
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.low_density">
    low_density
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.lineage_score">
    lineage_score
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_coef">
    get_coef
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_r2">
    get_r2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_mse">
    get_mse
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_rmse">
    get_rmse
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.get_mae">
    get_mae
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.plot_filtering">
    plot_filtering
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.plot_fitting">
    plot_fitting
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.Fate.plot_color_fitting">
    plot_color_fitting
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends">
    gene_trends
  </a>
<nav aria-label="gene_trends" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.calculate">
    calculate
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_heatmap">
    get_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_kendalltau">
    get_kendalltau
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_linregress">
    get_linregress
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.cal_border_cell">
    cal_border_cell
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_border_gene">
    get_border_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_multi_border_gene">
    get_multi_border_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_special_border_gene">
    get_special_border_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_kernel_gene">
    get_kernel_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_multi_kernel_gene">
    get_multi_kernel_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.get_special_kernel_gene">
    get_special_kernel_gene
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.gene_trends.plot_trend">
    plot_trend
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.mellon_density">
    mellon_density
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd">
    scnocd
  </a>
<nav aria-label="scnocd" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.check_torch">
    check_torch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.matrix_transform">
    matrix_transform
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.matrix_normalize">
    matrix_normalize
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.GNN_configure">
    GNN_configure
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.GNN_preprocess">
    GNN_preprocess
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.get_nmi">
    get_nmi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.save">
    save
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.load">
    load
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.GNN_model">
    GNN_model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.GNN_result">
    GNN_result
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.GNN_plot">
    GNN_plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.calculate_nocd">
    calculate_nocd
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.cal_nocd">
    cal_nocd
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.scnocd.get_pair_dict">
    get_pair_dict
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyCEFCON">
    pyCEFCON
  </a>
<nav aria-label="pyCEFCON" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyCEFCON.preprocess">
    preprocess
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyCEFCON.train">
    train
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyCEFCON.predicted_driver_regulators">
    predicted_driver_regulators
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.pyCEFCON.predicted_RGM">
    predicted_RGM
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.convert_human_to_mouse_network">
    convert_human_to_mouse_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.load_human_prior_interaction_network">
    load_human_prior_interaction_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.mouse_hsc_nestorowa16">
    mouse_hsc_nestorowa16
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_network_cal">
    cpdb_network_cal
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_plot_network">
    cpdb_plot_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_plot_interaction">
    cpdb_plot_interaction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_interaction_filtered">
    cpdb_interaction_filtered
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_submeans_exacted">
    cpdb_submeans_exacted
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_exact_target">
    cpdb_exact_target
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cpdb_exact_source">
    cpdb_exact_source
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.cellphonedb_v5">
    cellphonedb_v5
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.single.run_cellphonedb_v5">
    run_cellphonedb_v5
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 style="display: none;">omicverse.single<a class="headerlink" href="#omicverse.single" title="Permanent link">¶</a></h1><p class="mkapi-object mkapi-page-source" id="omicverse.single">
<span class="mkapi-object-link">
<a href="../../../src/omicverse/single/#omicverse.single" title="Go to source">source</a>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">package</span>
<span class="mkapi-object-name"><a href="./#omicverse.single" title="omicverse.single">omicverse.single</a></span>
</p>
<div class="mkapi-document">
<p>Single-cell omics analysis utilities.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle this module provides comprehensive tools for single-cell rna-seq analysis including">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">This module provides comprehensive tools for single-cell RNA-seq analysis including</span>
</p>
<div class="mkapi-section-content">
<ul>
<li>Cell type annotation and automated identification</li>
<li>Trajectory inference and pseudotime analysis</li>
<li>Gene regulatory network analysis</li>
<li>Cell-cell communication analysis</li>
<li>Multi-modal integration (RNA + ATAC)</li>
<li>Drug response prediction</li>
<li>Pathway enrichment and functional analysis</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle key classes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Key classes</span>
</p>
<div class="mkapi-section-content">
<p>pyMOFA: Multi-Omics Factor Analysis
pyVIA: Velocity and pseudotime analysis 
pySIMBA: Single-cell integration and batch alignment
pyTOSICA: Trajectory inference and cell fate analysis
pyCEFCON: Cell-cell communication analysis
MetaCell: Metacell construction and analysis
pyDEG: Single-cell differential expression</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle annotation tools">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Annotation tools</span>
</p>
<div class="mkapi-section-content">
<p>pySCSA: Automated cell type annotation
MetaTiME: Tumor microenvironment annotation
gptcelltype: GPT-based cell type identification
CellVote: Consensus cell type annotation</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle trajectory analysis">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Trajectory analysis</span>
</p>
<div class="mkapi-section-content">
<p>TrajInfer: Trajectory inference framework
scLTNN: Lineage tracing with neural networks
cytotrace2: Developmental potential scoring</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Automated cell annotation</span>
<span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">pySCSA</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">tissue</span><span class="o">=</span><span class="s1">'lung'</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s1">'human'</span><span class="p">)</span>

<span class="c1"># Trajectory analysis</span>
<span class="n">via</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">pyVIA</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="n">via</span><span class="o">.</span><span class="n">run_via</span><span class="p">()</span>

<span class="c1"># Multi-omics integration</span>
<span class="n">mofa</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">pyMOFA</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="n">mofa</span><span class="o">.</span><span class="n">build_mofa</span><span class="p">()</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle classes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Classes</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a></span>
<span class="mkapi-dash">—</span>
Initialize the pySCSA class.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaTiME" title="omicverse.single.MetaTiME">MetaTiME</a></span>
<span class="mkapi-dash">—</span>
MetaTiME: Meta-components in Tumor immune MicroEnvironment</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a></span>
<span class="mkapi-dash">—</span>
🧬 Cell ontology mapping class using NLP</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a></span>
<span class="mkapi-dash">—</span>
Initialize the MOFAART class.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFA" title="omicverse.single.pyMOFA">pyMOFA</a></span>
<span class="mkapi-dash">—</span>
MOFA class.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.GLUE_pair" title="omicverse.single.GLUE_pair">GLUE_pair</a></span>
<span class="mkapi-dash">—</span>
Pair the cells between RNA and ATAC using result of GLUE.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a></span>
<span class="mkapi-dash">—</span>
Initialize SIMBA object for batch correction and multimodal analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a></span>
<span class="mkapi-dash">—</span>
Initialize a pyTOSICA object for cell type classification.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a></span>
<span class="mkapi-dash">—</span>
Trajectory inference class for single-cell data analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a></span>
<span class="mkapi-dash">—</span>
Cellfategenie model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a></span>
<span class="mkapi-dash">—</span>
Initialize the gene_trends analysis based on pseudotime</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a></span>
<span class="mkapi-dash">—</span>
Drug_Response class for drug response prediction.
The raw code could be found at https://github.com/ailabstw/scDrug</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a></span>
<span class="mkapi-dash">—</span>
Initialize MetaCell object for constructing metacells using SEACells.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DCT" title="omicverse.single.DCT">DCT</a></span>
<span class="mkapi-dash">—</span>
Init the differential cell type abundance analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DEG" title="omicverse.single.DEG">DEG</a></span>
<span class="mkapi-dash">—</span>
Init the differential expression gene analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMDIC3" title="omicverse.single.pyMDIC3">pyMDIC3</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.SCENIC" title="omicverse.single.SCENIC">SCENIC</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.AnnotationRef" title="omicverse.single.AnnotationRef">AnnotationRef</a></span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle functions">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Functions</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cosg" title="omicverse.single.cosg">cosg</a></span>
<span class="mkapi-dash">—</span>
Marker gene identification for single-cell sequencing data using COSG.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy" title="omicverse.single.lazy">lazy</a></span>
<span class="mkapi-dash">—</span>
This is a very interesting function. We can use this function to avoid many unnecessary steps.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_checkpoint" title="omicverse.single.lazy_checkpoint">lazy_checkpoint</a></span>
<span class="mkapi-dash">—</span>
Memory-efficient version of lazy function with checkpointing support.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.resume_from_checkpoint" title="omicverse.single.resume_from_checkpoint">resume_from_checkpoint</a></span>
<span class="mkapi-dash">—</span>
Resume processing from a specific checkpoint.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.list_checkpoints" title="omicverse.single.list_checkpoints">list_checkpoints</a></span>
<span class="mkapi-dash">—</span>
List available checkpoints in the directory.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cleanup_checkpoints" title="omicverse.single.cleanup_checkpoints">cleanup_checkpoints</a></span>
<span class="mkapi-dash">—</span>
Clean up intermediate checkpoint files to save disk space.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_qc" title="omicverse.single.lazy_step_qc">lazy_step_qc</a></span>
<span class="mkapi-dash">—</span>
Step 1: Quality control and doublet detection.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_preprocess" title="omicverse.single.lazy_step_preprocess">lazy_step_preprocess</a></span>
<span class="mkapi-dash">—</span>
Step 2: Normalization and highly variable gene selection.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_scale" title="omicverse.single.lazy_step_scale">lazy_step_scale</a></span>
<span class="mkapi-dash">—</span>
Step 3: Data scaling.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_pca" title="omicverse.single.lazy_step_pca">lazy_step_pca</a></span>
<span class="mkapi-dash">—</span>
Step 4: Principal Component Analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_cell_cycle" title="omicverse.single.lazy_step_cell_cycle">lazy_step_cell_cycle</a></span>
<span class="mkapi-dash">—</span>
Step 5: Cell cycle scoring.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_harmony" title="omicverse.single.lazy_step_harmony">lazy_step_harmony</a></span>
<span class="mkapi-dash">—</span>
Step 6: Harmony batch correction (memory intensive).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_scvi" title="omicverse.single.lazy_step_scvi">lazy_step_scvi</a></span>
<span class="mkapi-dash">—</span>
Step 6b: scVI batch correction (memory intensive, optional).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_select_best_method" title="omicverse.single.lazy_step_select_best_method">lazy_step_select_best_method</a></span>
<span class="mkapi-dash">—</span>
Step 7: Select best batch correction method.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_mde" title="omicverse.single.lazy_step_mde">lazy_step_mde</a></span>
<span class="mkapi-dash">—</span>
Step 8: MDE embedding computation (memory intensive).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_clustering" title="omicverse.single.lazy_step_clustering">lazy_step_clustering</a></span>
<span class="mkapi-dash">—</span>
Step 9: Automated clustering with SCCAF (memory intensive).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_final_embeddings" title="omicverse.single.lazy_step_final_embeddings">lazy_step_final_embeddings</a></span>
<span class="mkapi-dash">—</span>
Step 10: Final UMAP and tSNE embeddings.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.lazy_step_by_step_guide" title="omicverse.single.lazy_step_by_step_guide">lazy_step_by_step_guide</a></span>
<span class="mkapi-dash">—</span>
Print a guide for step-by-step processing.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.aucell" title="omicverse.single.aucell">aucell</a></span>
<span class="mkapi-dash">—</span>
Calculate gene signature enrichment scores using AUCell algorithm.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scanpy_lazy" title="omicverse.single.scanpy_lazy">scanpy_lazy</a></span>
<span class="mkapi-dash">—</span>
Scanpy lazy analysis pipeline.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scanpy_cellanno_from_dict" title="omicverse.single.scanpy_cellanno_from_dict">scanpy_cellanno_from_dict</a></span>
<span class="mkapi-dash">—</span>
Add cell type annotation from dict to anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.get_celltype_marker" title="omicverse.single.get_celltype_marker">get_celltype_marker</a></span>
<span class="mkapi-dash">—</span>
Get marker genes for each clusters.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gptcelltype" title="omicverse.single.gptcelltype">gptcelltype</a></span>
<span class="mkapi-dash">—</span>
Annotate cell types using AGI (Artificial General Intelligence) models.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gpt4celltype" title="omicverse.single.gpt4celltype">gpt4celltype</a></span>
<span class="mkapi-dash">—</span>
Enhanced cell type annotation using AGI models with improved processing.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.get_cluster_celltype" title="omicverse.single.get_cluster_celltype">get_cluster_celltype</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gptcelltype_local" title="omicverse.single.gptcelltype_local">gptcelltype_local</a></span>
<span class="mkapi-dash">—</span>
Annotation of cell types using a local LLM model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.download_cl" title="omicverse.single.download_cl">download_cl</a></span>
<span class="mkapi-dash">—</span>
📥 Download Cell Ontology file from multiple sources with automatic fallback</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.factor_exact" title="omicverse.single.factor_exact">factor_exact</a></span>
<span class="mkapi-dash">—</span>
Extract the factor information from hdf5 file.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.factor_correlation" title="omicverse.single.factor_correlation">factor_correlation</a></span>
<span class="mkapi-dash">—</span>
Calculate the correlation between factors and cluster.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.get_weights" title="omicverse.single.get_weights">get_weights</a></span>
<span class="mkapi-dash">—</span>
Get the weights of each feature in a specific factor.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.glue_pair" title="omicverse.single.glue_pair">glue_pair</a></span>
<span class="mkapi-dash">—</span>
Pair the cells between RNA and ATAC using result of GLUE.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.get_r2_from_hdf5" title="omicverse.single.get_r2_from_hdf5">get_r2_from_hdf5</a></span>
<span class="mkapi-dash">—</span>
Get the variance explained (R2) for each factor from hdf5 file directly.
Simplified version that only works with pre-computed R2 values.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TFIDF_LSI" title="omicverse.single.TFIDF_LSI">TFIDF_LSI</a></span>
<span class="mkapi-dash">—</span>
Computes LSI based on a TF-IDF transformation of the data. Putative dimensionality 
reduction for scATAC-seq data prior to MultiMAP. Adds an <code>.obsm['X_lsi']</code> field to 
the object it was ran on.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Wrapper" title="omicverse.single.Wrapper">Wrapper</a></span>
<span class="mkapi-dash">—</span>
A function that computes the paired PCAs between the datasets to integrate, calls MultiMAP
proper, and returns a  (parameters, connectivities, embedding) tuple. Embedding optional
depending on <code>embedding</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Integration" title="omicverse.single.Integration">Integration</a></span>
<span class="mkapi-dash">—</span>
Run MultiMAP to integrate a number of AnnData objects from various multi-omics experiments
into a single joint dimensionally reduced space. Returns a joint object with the resulting 
embedding stored in <code>.obsm['X_multimap']</code> (if instructed) and appropriate graphs in 
<code>.obsp</code>. The final object will be a concatenation of the individual ones provided on 
input, so in the interest of ease of exploration it is recommended to have non-scaled data 
in <code>.X</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Batch" title="omicverse.single.Batch">Batch</a></span>
<span class="mkapi-dash">—</span>
Run MultiMAP to correct batch effect within a single AnnData object. Loses the flexibility 
of individualised dimensionality reduction choices, but doesn't require a list of separate 
objects for each batch/dataset to integrate. Runs PCA on a per-batch/dataset basis prior 
to performing an analysis analogous to  <code>Integration()</code>. Adds appropriate <code>.obsp</code> graphs 
and <code>.obsm['X_multimap']</code> (if instructed) to the input.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.convert_r2_to_matrix" title="omicverse.single.convert_r2_to_matrix">convert_r2_to_matrix</a></span>
<span class="mkapi-dash">—</span>
Convert R2 DataFrame to a matrix format with factors as rows and views as columns.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.factor_group_correlation_mdata" title="omicverse.single.factor_group_correlation_mdata">factor_group_correlation_mdata</a></span>
<span class="mkapi-dash">—</span>
Calculate the correlation/association between MOFA factors and groups in MuData.
Handles unpaired data by analyzing each view separately.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_factor_group_associations" title="omicverse.single.plot_factor_group_associations">plot_factor_group_associations</a></span>
<span class="mkapi-dash">—</span>
Plot factor-group associations from factor_group_correlation_mdata results.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_factor_boxplots" title="omicverse.single.plot_factor_boxplots">plot_factor_boxplots</a></span>
<span class="mkapi-dash">—</span>
Create boxplots for top significant factor-group associations.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_factors_violin" title="omicverse.single.plot_factors_violin">plot_factors_violin</a></span>
<span class="mkapi-dash">—</span>
Plot factor values as violin plots or strip plots for MuData object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_weights" title="omicverse.single.plot_weights">plot_weights</a></span>
<span class="mkapi-dash">—</span>
Plot weights for MOFA factors.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.fle" title="omicverse.single.fle">fle</a></span>
<span class="mkapi-dash">—</span>
Construct the Force-directed (FLE) graph.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.diffmap" title="omicverse.single.diffmap">diffmap</a></span>
<span class="mkapi-dash">—</span>
Calculate Diffusion Map.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_origin_tesmination" title="omicverse.single.plot_origin_tesmination">plot_origin_tesmination</a></span>
<span class="mkapi-dash">—</span>
plot the origin and tesmination cell of scRNA-seq</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.find_related_gene" title="omicverse.single.find_related_gene">find_related_gene</a></span>
<span class="mkapi-dash">—</span>
Find out the gene with postivate relation of the amounts of cells
Arguments</p>
<hr/>
<p>adata
    the anndata performed LTNN analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cytotrace2" title="omicverse.single.cytotrace2">cytotrace2</a></span>
<span class="mkapi-dash">—</span>
CytoTRACE 2: Deep learning-based cell potency prediction.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.mellon_density" title="omicverse.single.mellon_density">mellon_density</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.convert_human_to_mouse_network" title="omicverse.single.convert_human_to_mouse_network">convert_human_to_mouse_network</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.load_human_prior_interaction_network" title="omicverse.single.load_human_prior_interaction_network">load_human_prior_interaction_network</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.mouse_hsc_nestorowa16" title="omicverse.single.mouse_hsc_nestorowa16">mouse_hsc_nestorowa16</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_network_cal" title="omicverse.single.cpdb_network_cal">cpdb_network_cal</a></span>
<span class="mkapi-dash">—</span>
Calculate a CPDB (Cell Phone Database) network using gene expression data and return a dictionary of results.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_plot_network" title="omicverse.single.cpdb_plot_network">cpdb_plot_network</a></span>
<span class="mkapi-dash">—</span>
Plot a network of interactions between cell types using gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_plot_interaction" title="omicverse.single.cpdb_plot_interaction">cpdb_plot_interaction</a></span>
<span class="mkapi-dash">—</span>
Plot CellPhoneDB cell-cell interactions between two cell types.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_interaction_filtered" title="omicverse.single.cpdb_interaction_filtered">cpdb_interaction_filtered</a></span>
<span class="mkapi-dash">—</span>
Returns a list of unique interaction groups from a CellPhoneDB analysis filtered by significance.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_submeans_exacted" title="omicverse.single.cpdb_submeans_exacted">cpdb_submeans_exacted</a></span>
<span class="mkapi-dash">—</span>
Extract subset of CellPhoneDB means DataFrame for specific cell type.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_exact_target" title="omicverse.single.cpdb_exact_target">cpdb_exact_target</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cpdb_exact_source" title="omicverse.single.cpdb_exact_source">cpdb_exact_source</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.cellphonedb_v5" title="omicverse.single.cellphonedb_v5">cellphonedb_v5</a></span>
<span class="mkapi-dash">—</span>
Run CellPhoneDB statistical analysis with proper file handling</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.run_cellphonedb_v5" title="omicverse.single.run_cellphonedb_v5">run_cellphonedb_v5</a></span>
<span class="mkapi-dash">—</span>
Run CellPhoneDB statistical analysis with automatic database download</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.geneset_aucell" title="omicverse.single.geneset_aucell">geneset_aucell</a></span>
<span class="mkapi-dash">—</span>
Calculate the AUC-ell score for a given gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_aucell" title="omicverse.single.pathway_aucell">pathway_aucell</a></span>
<span class="mkapi-dash">—</span>
Calculate the area under the curve (AUC) for a set of pathways in an AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_aucell_enrichment" title="omicverse.single.pathway_aucell_enrichment">pathway_aucell_enrichment</a></span>
<span class="mkapi-dash">—</span>
Enrich cell annotations with pathway activity scores using the AUC-ell method.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.geneset_aucell_tmp" title="omicverse.single.geneset_aucell_tmp">geneset_aucell_tmp</a></span>
<span class="mkapi-dash">—</span>
Calculate the AUC-ell score for a given gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_aucell_tmp" title="omicverse.single.pathway_aucell_tmp">pathway_aucell_tmp</a></span>
<span class="mkapi-dash">—</span>
Calculate the area under the curve (AUC) for a set of pathways in an AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_aucell_enrichment_tmp" title="omicverse.single.pathway_aucell_enrichment_tmp">pathway_aucell_enrichment_tmp</a></span>
<span class="mkapi-dash">—</span>
Enrich cell annotations with pathway activity scores using the AUC-ell method.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_enrichment" title="omicverse.single.pathway_enrichment">pathway_enrichment</a></span>
<span class="mkapi-dash">—</span>
Perform pathway enrichment analysis on gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pathway_enrichment_plot" title="omicverse.single.pathway_enrichment_plot">pathway_enrichment_plot</a></span>
<span class="mkapi-dash">—</span>
Visualize the pathway enrichment analysis results as a heatmap.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.autoResolution" title="omicverse.single.autoResolution">autoResolution</a></span>
<span class="mkapi-dash">—</span>
Automatically determine clustering resolution.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.writeGEP" title="omicverse.single.writeGEP">writeGEP</a></span>
<span class="mkapi-dash">—</span>
Write the gene expression profile to a file.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.atac_concat_get_index" title="omicverse.single.atac_concat_get_index">atac_concat_get_index</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.atac_concat_inner" title="omicverse.single.atac_concat_inner">atac_concat_inner</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.atac_concat_outer" title="omicverse.single.atac_concat_outer">atac_concat_outer</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.batch_correction" title="omicverse.single.batch_correction">batch_correction</a></span>
<span class="mkapi-dash">—</span>
Batch correction for single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.SCCAF_assessment" title="omicverse.single.SCCAF_assessment">SCCAF_assessment</a></span>
<span class="mkapi-dash">—</span>
Assessment of clustering reliability using self-projection.
It is the same as the self_projection function.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_roc" title="omicverse.single.plot_roc">plot_roc</a></span>
<span class="mkapi-dash">—</span>
y_prob, y_test, clf, plot=True, save=False, title ='', colors=None, cvsm=None, acc=None, fontsize=16):</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.SCCAF_optimize_all" title="omicverse.single.SCCAF_optimize_all">SCCAF_optimize_all</a></span>
<span class="mkapi-dash">—</span>
ad: <code>AnnData</code>
    The AnnData object of the expression profile.
min_acc: <code>float</code> optional (default: 0.9)
    The minimum self-projection accuracy to be optimized for.
    e.g., 0.9 means the clustering optimization (merging process)
    will not stop until the self-projection accuracy is above 90%.
R1norm_cutoff: <code>float</code> optional (default: 0.5)
    The start cutoff for R1norm of confusion matrix.
    e.g., 0.5 means use 0.5 as a cutoff to discretize the confusion matrix after R1norm.
    the discretized matrix is used to construct the connection graph for clustering optimization.
R2norm_cutoff: <code>float</code> optional (default: 0.05)
    The start cutoff for R2norm of confusion matrix.
R1norm_step: <code>float</code> optional (default: 0.01)
    The reduce step for minimum R1norm value.
    Each round of optimization calls the function <span class="mkapi-tooltip" title="omicverse.single._sccaf.SCCAF_optimize"><code>SCCAF_optimize</code></span>.
    The start of the next round of optimization is based on a new
    cutoff for the R1norm of the confusion matrix. This cutoff is
    determined by the minimum R1norm value in the previous round minus the R1norm_step value.
R2norm_step: <code>float</code> optional (default: 0.001)
    The reduce step for minimum R2norm value.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_metacells" title="omicverse.single.plot_metacells">plot_metacells</a></span>
<span class="mkapi-dash">—</span>
Plot metacells on an existing axis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.get_obs_value" title="omicverse.single.get_obs_value">get_obs_value</a></span>
<span class="mkapi-dash">—</span>
Transfer observation values from single-cell to metacell data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.generate_scRNA_report" title="omicverse.single.generate_scRNA_report">generate_scRNA_report</a></span>
<span class="mkapi-dash">—</span>
Generate MultiQC-style HTML report for single-cell RNA-seq analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.build_correlation_network_umap_layout" title="omicverse.single.build_correlation_network_umap_layout">build_correlation_network_umap_layout</a></span>
<span class="mkapi-dash">—</span>
UMAP layout + correlation network</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.add_tf_regulation" title="omicverse.single.add_tf_regulation">add_tf_regulation</a></span>
<span class="mkapi-dash">—</span>
Add TF-Gene regulation relationship to network</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.plot_grn" title="omicverse.single.plot_grn">plot_grn</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.velocity_embedding" title="omicverse.single.velocity_embedding">velocity_embedding</a></span>
<span class="mkapi-dash">—</span>
Projects the single cell velocities into any embedding.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cosg">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cosg" title="omicverse.single.cosg">cosg</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-equal">=</span><span class="mkapi-default">'CellTypes'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="omicverse.single._cosg.Literal">Literal</span>['all'], <span class="mkapi-tooltip" title="typing.Iterable">Iterable</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'all'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">mu</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">remove_lowly_expressed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expressed_pct</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes_user</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key_added</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">calculate_logfoldchanges</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reference</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'rest'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">copy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Marker gene identification for single-cell sequencing data using COSG.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix. Note: input parameters are similar to the parameters used for scanpy's rank_genes_groups() function.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span>
<span class="mkapi-dash">—</span>
The key of the cell groups in .obs. ('CellTypes')</p>
</li>
<li>
<p><span class="mkapi-item-name">groups</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="omicverse.single._cosg.Literal">Literal</span>['all'], <span class="mkapi-tooltip" title="typing.Iterable">Iterable</span>[str]]</span> <span class="mkapi-dash">—</span>
Subset of cell groups, e.g. ['g1', 'g2', 'g3'], to which comparison shall be restricted. ('all')</p>
</li>
<li>
<p><span class="mkapi-item-name">mu</span>
<span class="mkapi-dash">—</span>
The penalty restricting marker genes expressing in non-target cell groups. Larger value represents more strict restrictions. mu should be &gt;= 0. (1)</p>
</li>
<li>
<p><span class="mkapi-item-name">remove_lowly_expressed</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If True, genes that express a percentage of target cells smaller than a specific value (expressed_pct) are not considered as marker genes for the target cells. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">expressed_pct</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
When remove_lowly_expressed is set to True, genes that express a percentage of target cells smaller than a specific value (expressed_pct) are not considered as marker genes for the target cells. (0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_genes_user</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of genes that appear in the returned tables. (50)</p>
</li>
<li>
<p><span class="mkapi-item-name">key_added</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
The key in adata.uns information is saved to.</p>
</li>
<li>
<p><span class="mkapi-item-name">calculate_logfoldchanges</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Calculate logfoldchanges. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Use raw attribute of adata if present. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Key from adata.layers whose value will be used to perform tests on.</p>
</li>
<li>
<p><span class="mkapi-item-name">reference</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
If 'rest', compare each group to the union of the rest of the group. If a group identifier, compare with respect to this group. ('rest')</p>
</li>
<li>
<p><span class="mkapi-item-name">copy</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Return a copy instead of writing to adata. (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object with marker gene results stored in .uns['rank_genes_groups'] or specified key_added.</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span>
<span class="mkapi-dash">—</span>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc68k_reduced</span><span class="p">()</span>
<span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">cosg</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">key_added</span><span class="o">=</span><span class="s1">'cosg'</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">'bulk_labels'</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_groups</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">'cosg'</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy" title="omicverse.single.lazy">lazy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reforce_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">[]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">qc_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">preprocess_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pca_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">harmony_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scvi_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>This is a very interesting function. We can use this function to avoid many unnecessary steps.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle arguments">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">arguments</span>
</p>
<div class="mkapi-section-content">
<p>adata: the data to analysis
reforce_steps: we can reforce run lazy step, because some step have been run and will be skipped.
                ['qc','pca','preprocess','scaled','Harmony','scVI','eval_bench','eval_clusters']
sample_key: the key store in <code>adata.obs</code> to batch correction.</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_checkpoint">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_checkpoint" title="omicverse.single.lazy_checkpoint">lazy_checkpoint</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reforce_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">[]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">checkpoint_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'./lazy_checkpoints'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_intermediate</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">qc_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">preprocess_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pca_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">harmony_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scvi_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Memory-efficient version of lazy function with checkpointing support.</p>
<p>This function saves intermediate results at each step to avoid memory crashes
on large datasets. Each step is saved as an .h5ad file and can be resumed
if the process crashes.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
the data to analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span>
<span class="mkapi-dash">—</span>
'human' or 'mouse' for cell cycle scoring</p>
</li>
<li>
<p><span class="mkapi-item-name">reforce_steps</span>
<span class="mkapi-dash">—</span>
we can reforce run lazy step, because some step have been run and will be skipped.
['qc','pca','preprocess','scaled','Harmony','scVI','eval_bench','eval_clusters']</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
the key store in <code>adata.obs</code> to batch correction.</p>
</li>
<li>
<p><span class="mkapi-item-name">checkpoint_dir</span>
<span class="mkapi-dash">—</span>
directory to save intermediate results</p>
</li>
<li>
<p><span class="mkapi-item-name">save_intermediate</span>
<span class="mkapi-dash">—</span>
whether to save intermediate results at each step</p>
</li>
<li>
<p><span class="mkapi-item-name">qc_kwargs</span>
<span class="mkapi-dash">—</span>
arguments for qc step</p>
</li>
<li>
<p><span class="mkapi-item-name">preprocess_kwargs</span>
<span class="mkapi-dash">—</span>
arguments for preprocess step</p>
</li>
<li>
<p><span class="mkapi-item-name">pca_kwargs</span>
<span class="mkapi-dash">—</span>
arguments for pca step</p>
</li>
<li>
<p><span class="mkapi-item-name">harmony_kwargs</span>
<span class="mkapi-dash">—</span>
arguments for harmony step</p>
</li>
<li>
<p><span class="mkapi-item-name">scvi_kwargs</span>
<span class="mkapi-dash">—</span>
arguments for scVI step</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._lazy_checkpoint.lazy_checkpoint.adata">adata</span></span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.resume_from_checkpoint">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.resume_from_checkpoint" title="omicverse.single.resume_from_checkpoint">resume_from_checkpoint</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">checkpoint_dir</span><span class="mkapi-comma">, </span><span class="mkapi-arg">step_name</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Resume processing from a specific checkpoint.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">checkpoint_dir</span>
<span class="mkapi-dash">—</span>
directory containing checkpoints</p>
</li>
<li>
<p><span class="mkapi-item-name">step_name</span>
<span class="mkapi-dash">—</span>
name of the step to resume from
('qc', 'preprocess', 'scaled', 'pca', 'cell_cycle',
 'harmony', 'scvi', 'eval_bench', 'clustering', 'final_embeddings')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._lazy_checkpoint.resume_from_checkpoint.adata">adata</span></span> <span class="mkapi-dash">—</span>
AnnData object from the checkpoint</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">FileNotFoundError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.list_checkpoints">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.list_checkpoints" title="omicverse.single.list_checkpoints">list_checkpoints</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">checkpoint_dir</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>List available checkpoints in the directory.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">checkpoint_dir</span>
<span class="mkapi-dash">—</span>
directory containing checkpoints</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
available checkpoint files</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cleanup_checkpoints">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cleanup_checkpoints" title="omicverse.single.cleanup_checkpoints">cleanup_checkpoints</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">checkpoint_dir</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keep_final</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Clean up intermediate checkpoint files to save disk space.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">checkpoint_dir</span>
<span class="mkapi-dash">—</span>
directory containing checkpoints</p>
</li>
<li>
<p><span class="mkapi-item-name">keep_final</span>
<span class="mkapi-dash">—</span>
whether to keep the final result file</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_qc">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_qc" title="omicverse.single.lazy_step_qc">lazy_step_qc</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">qc_kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 1: Quality control and doublet detection.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span>
<span class="mkapi-dash">—</span>
'human' or 'mouse'</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
batch key for QC</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">**qc_kwargs</span>
<span class="mkapi-dash">—</span>
additional arguments for qc function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._lazy_step_by_step.lazy_step_qc.adata">adata</span></span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_preprocess">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_preprocess" title="omicverse.single.lazy_step_preprocess">lazy_step_preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">preprocess_kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 2: Normalization and highly variable gene selection.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">**preprocess_kwargs</span>
<span class="mkapi-dash">—</span>
additional arguments for preprocess function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._lazy_step_by_step.lazy_step_preprocess.adata">adata</span></span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_scale">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_scale" title="omicverse.single.lazy_step_scale">lazy_step_scale</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 3: Data scaling.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_pca">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_pca" title="omicverse.single.lazy_step_pca">lazy_step_pca</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">pca_kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 4: Principal Component Analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">**pca_kwargs</span>
<span class="mkapi-dash">—</span>
additional arguments for PCA</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_cell_cycle">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_cell_cycle" title="omicverse.single.lazy_step_cell_cycle">lazy_step_cell_cycle</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 5: Cell cycle scoring.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span>
<span class="mkapi-dash">—</span>
'human' or 'mouse'</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_harmony">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_harmony" title="omicverse.single.lazy_step_harmony">lazy_step_harmony</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">harmony_kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 6: Harmony batch correction (memory intensive).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
batch key for correction</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">**harmony_kwargs</span>
<span class="mkapi-dash">—</span>
additional arguments for harmony</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_scvi">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_scvi" title="omicverse.single.lazy_step_scvi">lazy_step_scvi</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">scvi_kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 6b: scVI batch correction (memory intensive, optional).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
batch key for correction</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">**scvi_kwargs</span>
<span class="mkapi-dash">—</span>
additional arguments for scVI</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_select_best_method">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_select_best_method" title="omicverse.single.lazy_step_select_best_method">lazy_step_select_best_method</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 7: Select best batch correction method.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_mde">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_mde" title="omicverse.single.lazy_step_mde">lazy_step_mde</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 8: MDE embedding computation (memory intensive).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_clustering">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_clustering" title="omicverse.single.lazy_step_clustering">lazy_step_clustering</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_iterations</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 9: Automated clustering with SCCAF (memory intensive).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_iterations</span>
<span class="mkapi-dash">—</span>
maximum SCCAF iterations</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_final_embeddings">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_final_embeddings" title="omicverse.single.lazy_step_final_embeddings">lazy_step_final_embeddings</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Step 10: Final UMAP and tSNE embeddings.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
path to save the result (optional)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
processed AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.lazy_step_by_step_guide">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.lazy_step_by_step_guide" title="omicverse.single.lazy_step_by_step_guide">lazy_step_by_step_guide</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Print a guide for step-by-step processing.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.aucell">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.aucell" title="omicverse.single.aucell">aucell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">exp_mtx</span><span class="mkapi-comma">, </span><span class="mkapi-arg">signatures</span><span class="mkapi-comma">, </span><span class="mkapi-arg">auc_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">noweights</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normalize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_workers</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="multiprocessing.cpu_count">cpu_count</span>()</span><span class="mkapi-comma">, </span><span class="mkapi-arg">index</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">columns</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate gene signature enrichment scores using AUCell algorithm.</p>
<p>AUCell quantifies gene set enrichment by calculating the Area Under the Curve (AUC)
of gene rankings for each cell, providing a robust measure of pathway activity.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">exp_mtx</span>
<span class="mkapi-dash">—</span>
Expression matrix (n_cells x n_genes) - DataFrame or sparse matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">signatures</span>
<span class="mkapi-dash">—</span>
Gene signatures or regulons for enrichment analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">auc_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Fraction of ranked genes to consider for AUC calculation (default: 0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">noweights</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to ignore gene weights in signatures (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">normalize</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to normalize AUC values to maximum of 1.0 per signature (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Random seed for reproducible gene ranking (default: None)</p>
</li>
<li>
<p><span class="mkapi-item-name">num_workers</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of CPU cores for parallel processing (default: all cores)</p>
</li>
<li>
<p><span class="mkapi-item-name">index</span>
<span class="mkapi-dash">—</span>
Custom row index for output DataFrame (default: None)</p>
</li>
<li>
<p><span class="mkapi-item-name">columns</span>
<span class="mkapi-dash">—</span>
Custom column names for output DataFrame (default: None)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
AUC enrichment scores with cells as rows and signatures as columns</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">foldchange</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'temp/rna_anno.txt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">outfmt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'txt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">Gensymbol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'All'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'cellmarker'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'normal'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">norefdb</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cellrange</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">noprint</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">list_tissue</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissuename</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">speciename</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize the pySCSA class.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object of scRNA-seq after preprocessing</p>
</li>
<li>
<p><span class="mkapi-item-name">foldchange</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Fold change threshold for marker filtering. (1.5)</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
P-value threshold for marker filtering. (0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">output</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Output file for marker annotation. ('temp/rna_anno.txt')</p>
</li>
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to the Database for annotation. If not provided, the model will be downloaded from the internet. ('')</p>
</li>
<li>
<p><span class="mkapi-item-name">outfmt</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Output format for marker annotation. ('txt')</p>
</li>
<li>
<p><span class="mkapi-item-name">Gensymbol</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Using gene symbol ID instead of ensembl ID in input file for calculation. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Species for annotation. Only used for cellmarker database. ('Human')</p>
</li>
<li>
<p><span class="mkapi-item-name">weight</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Weight threshold for marker filtering from cellranger v1.0 results. (100)</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Tissue for annotation. you can use <span class="mkapi-tooltip" title="omicverse.single._anno.pySCSA.get_model_tissue"><code>get_model_tissue</code></span> to see the available tissues. ('All')</p>
</li>
<li>
<p><span class="mkapi-item-name">target</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Target to annotation class in Database. ('cellmarker')</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Cell type for annotation. ('normal')</p>
</li>
<li>
<p><span class="mkapi-item-name">norefdb</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Only using user-defined marker database for annotation. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">cellrange</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Cell sub_type for annotation. (if you input T cell, it will only provide T helper cell, T cytotoxic cell, T regulatory cell, etc.) (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">noprint</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Do not print any detail results. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">list_tissue</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
List all available tissues in the database. (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA.get_model_tissue" title="omicverse.single.pySCSA.get_model_tissue">get_model_tissue</a></span>
<span class="mkapi-dash">—</span>
List all available tissues in the database.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA.cell_anno" title="omicverse.single.pySCSA.cell_anno">cell_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate cell type for each cluster.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA.cell_anno_print" title="omicverse.single.pySCSA.cell_anno_print">cell_anno_print</a></span>
<span class="mkapi-dash">—</span>
Print the annotation result.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA.cell_auto_anno" title="omicverse.single.pySCSA.cell_auto_anno">cell_auto_anno</a></span>
<span class="mkapi-dash">—</span>
Add cell type annotation to anndata.obs['scsa_celltype'].</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySCSA.get_celltype_marker" title="omicverse.single.pySCSA.get_celltype_marker">get_celltype_marker</a></span>
<span class="mkapi-dash">—</span>
Get marker genes for each clusters.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA.get_model_tissue">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA.get_model_tissue" title="omicverse.single.pySCSA.get_model_tissue">get_model_tissue</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">species</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Human'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>List all available tissues in the database.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Species for annotation. Only used for cellmarker database. ('Human')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA.cell_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA.cell_anno" title="omicverse.single.pySCSA.cell_anno">cell_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">clustertype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'all'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rank_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Annotate cell type for each cluster.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">clustertype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering name used in scanpy. ('leiden')</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Only deal with one cluster of marker genes. ('all')</p>
</li>
<li>
<p><span class="mkapi-item-name">rank_rep</span>
<span class="mkapi-dash">—</span>
Whether to repeat ranking. (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._anno.pySCSA.cell_anno.result">result</span></span> <span class="mkapi-dash">—</span>
Annotation result as DataFrame</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA.cell_anno_print">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA.cell_anno_print" title="omicverse.single.pySCSA.cell_anno_print">cell_anno_print</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Print the annotation result.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA.cell_auto_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA.cell_auto_anno" title="omicverse.single.pySCSA.cell_auto_anno">cell_auto_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustertype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scsa_celltype'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Add cell type annotation to anndata.obs['scsa_celltype'].</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
anndata object</p>
</li>
<li>
<p><span class="mkapi-item-name">clustertype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering name used in scanpy. ('leiden')</p>
</li>
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
Key to store cell type annotation. ('scsa_celltype')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySCSA.get_celltype_marker">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySCSA" title="omicverse.single.pySCSA">pySCSA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySCSA.get_celltype_marker" title="omicverse.single.pySCSA.get_celltype_marker">get_celltype_marker</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustertype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log2fc_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scores_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scores'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rank</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">unique</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">global_unique</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">dict</span></span>
</p>
<div class="mkapi-document">
<p>Get marker genes for each clusters.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
anndata object</p>
</li>
<li>
<p><span class="mkapi-item-name">clustertype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering name used in scanpy. (leiden)</p>
</li>
<li>
<p><span class="mkapi-item-name">log2fc_min</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Minimum log2 fold change of marker genes. (2)</p>
</li>
<li>
<p><span class="mkapi-item-name">pval_cutoff</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Maximum p value of marker genes. (0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">rank</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to rank genes by wilcoxon test. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">scores_type</span>
<span class="mkapi-dash">—</span>
The type of scores. can be selected from <code>scores</code> and <code>logfoldchanges</code></p>
</li>
<li>
<p><span class="mkapi-item-name">unique</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to remove duplicates within each cell type. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">global_unique</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to remove duplicates across all cell types. (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">cellmarker</span> <span class="mkapi-dash">—</span>
A dictionary of marker genes for each clusters.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaTiME">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.MetaTiME" title="omicverse.single.MetaTiME">MetaTiME</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">mode</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'table'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>MetaTiME: Meta-components in Tumor immune MicroEnvironment</p>
<p>Github: https://github.com/yi-zhang/MetaTiME/</p>
<p>Initialize MetaTiME model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
anndata object</p>
</li>
<li>
<p><span class="mkapi-item-name">mode</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
choose from ['mecnamedict', 'table', 'meciddict']
load manual assigned name for easy understanding of assigned names
from file: MeC_anno_name.tsv under mecDIR.
Required columns: <code>['MeC_id', 'Annotation', 'UseForCellStateAnno']</code> 
Required seperator: tab
Annotation column NA will be filtered.
If you want to use your own annotation, please follow the format of MeC_anno_name.tsv</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaTiME.overcluster" title="omicverse.single.MetaTiME.overcluster">overcluster</a></span>
<span class="mkapi-dash">—</span>
Overcluster single cell data to get cluster level cell state annotation</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaTiME.predictTiME" title="omicverse.single.MetaTiME.predictTiME">predictTiME</a></span>
<span class="mkapi-dash">—</span>
Predict TiME celtype for each cell</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaTiME.plot" title="omicverse.single.MetaTiME.plot">plot</a></span>
<span class="mkapi-dash">—</span>
Plot annotated cells with  non-overlapping fonts.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaTiME.overcluster">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaTiME" title="omicverse.single.MetaTiME">MetaTiME</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaTiME.overcluster" title="omicverse.single.MetaTiME.overcluster">overcluster</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">resolution</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustercol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'overcluster'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Overcluster single cell data to get cluster level cell state annotation</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">resolution</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
resolution for leiden clustering</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
random state for leiden clustering</p>
</li>
<li>
<p><span class="mkapi-item-name">clustercol</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
column name for cluster level cell state annotation</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaTiME.predictTiME">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaTiME" title="omicverse.single.MetaTiME">MetaTiME</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaTiME.predictTiME" title="omicverse.single.MetaTiME.predictTiME">predictTiME</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">save_obs_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'MetaTiME'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Predict TiME celtype for each cell</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">save_obs_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
column name for cell type annotation in adata.obs</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaTiME.plot">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaTiME" title="omicverse.single.MetaTiME">MetaTiME</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaTiME.plot" title="omicverse.single.MetaTiME.plot">plot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'MetaTiME'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cell</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(6, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">80</span><span class="mkapi-comma">, </span><span class="mkapi-arg">frameon</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot annotated cells with  non-overlapping fonts.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
basis for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
column name for cell type annotation in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
fontsize for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cell</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
minimum number of cells for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
title for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
figure size for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">dpi</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
dpi for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">frameon</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
frameon for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_loc</span>
<span class="mkapi-dash">—</span>
legend_loc for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
palette for plotting</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._anno.MetaTiME.plot.fig">fig</span></span> <span class="mkapi-dash">—</span>
figure object
ax: axis object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scanpy_lazy">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.scanpy_lazy" title="omicverse.single.scanpy_lazy">scanpy_lazy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cells</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">drop_doublet</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes_by_counts</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pct_counts_mt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_sum</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10000.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_mean</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.0125</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_mean</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_disp</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_value</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_comps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">svd_solver</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'auto'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">112</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span></span>
</p>
<div class="mkapi-document">
<p>Scanpy lazy analysis pipeline.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">min_genes</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The min number of genes. (200)</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cells</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The min number of cells. (3)</p>
</li>
<li>
<p><span class="mkapi-item-name">drop_doublet</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to drop doublet. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_genes_by_counts</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The max number of genes. (4300)</p>
</li>
<li>
<p><span class="mkapi-item-name">pct_counts_mt</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The max proportion of mito-genes. (25)</p>
</li>
<li>
<p><span class="mkapi-item-name">target_sum</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The max counts of total_counts. (1e4)</p>
</li>
<li>
<p><span class="mkapi-item-name">min_mean</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The min mean of genes. (0.0125)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_mean</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The max mean of genes. (3)</p>
</li>
<li>
<p><span class="mkapi-item-name">min_disp</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The min dispersion of genes. (0.5)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_value</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The max value of genes. (10)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_comps</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of components. (100)</p>
</li>
<li>
<p><span class="mkapi-item-name">svd_solver</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The solver of svd. ('auto')</p>
</li>
<li>
<p><span class="mkapi-item-name">n_neighbors</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of neighbors. (15)</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The random state. (112)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_pcs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of pcs. (50)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._anno.scanpy_lazy.adata">adata</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scanpy_cellanno_from_dict">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.scanpy_cellanno_from_dict" title="omicverse.single.scanpy_cellanno_from_dict">scanpy_cellanno_from_dict</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">anno_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">anno_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'major'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustertype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Add cell type annotation from dict to anndata object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object of scRNA-seq after preprocessing</p>
</li>
<li>
<p><span class="mkapi-item-name">anno_dict</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Dict of cell type annotation. key is the cluster name, value is the cell type name.like <code>{'0':'B cell','1':'T cell'}</code></p>
</li>
<li>
<p><span class="mkapi-item-name">anno_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The name of annotation. ('major')</p>
</li>
<li>
<p><span class="mkapi-item-name">clustertype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering name used in scanpy. ('leiden')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.get_celltype_marker">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.get_celltype_marker" title="omicverse.single.get_celltype_marker">get_celltype_marker</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustertype</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log2fc_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scores_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scores'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rank</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'rank_genes_groups'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'wilcoxon'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">foldchange</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">topgenenumber</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">unique</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">global_unique</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">dict</span></span>
</p>
<div class="mkapi-document">
<p>Get marker genes for each clusters.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
anndata object</p>
</li>
<li>
<p><span class="mkapi-item-name">clustertype</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering name used in scanpy. (leiden)</p>
</li>
<li>
<p><span class="mkapi-item-name">log2fc_min</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Minimum log2 fold change of marker genes. (2)</p>
</li>
<li>
<p><span class="mkapi-item-name">pval_cutoff</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Maximum p value of marker genes. (0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">rank</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to rank genes by wilcoxon test. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">scores_type</span>
<span class="mkapi-dash">—</span>
The type of scores. can be selected from <code>scores</code> and <code>logfoldchanges</code></p>
</li>
<li>
<p><span class="mkapi-item-name">unique</span>
<span class="mkapi-dash">—</span>
Whether to remove duplicates within each cell type. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">global_unique</span>
<span class="mkapi-dash">—</span>
Whether to remove duplicates across all cell types. (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._anno.get_celltype_marker.cellmarker">cellmarker</span></span> <span class="mkapi-dash">—</span>
A dictionary of marker genes for each clusters.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gptcelltype">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.gptcelltype" title="omicverse.single.gptcelltype">gptcelltype</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissuename</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">speciename</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-equal">=</span><span class="mkapi-default">'qwen'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'qwen-plus'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">topgenenumber</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base_url</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate cell types using AGI (Artificial General Intelligence) models.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">input</span>
<span class="mkapi-dash">—</span>
Dictionary with clusters as keys and gene markers as values, or DataFrame with cluster information</p>
</li>
<li>
<p><span class="mkapi-item-name">tissuename</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Tissue name for context (default: None)</p>
</li>
<li>
<p><span class="mkapi-item-name">speciename</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Species name for annotation context (default: 'human')</p>
</li>
<li>
<p><span class="mkapi-item-name">provider</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
AI model provider - choose from 'openai', 'kimi', 'qwen' (default: 'qwen')</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Specific model name to use (default: 'qwen-plus')</p>
</li>
<li>
<p><span class="mkapi-item-name">topgenenumber</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of top genes to use for annotation (default: 10)</p>
</li>
<li>
<p><span class="mkapi-item-name">base_url</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Custom API base URL (default: None)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict or str</span> <span class="mkapi-dash">—</span>
Cell type annotations for each cluster, or prompt string if API key not found</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gpt4celltype">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.gpt4celltype" title="omicverse.single.gpt4celltype">gpt4celltype</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input_data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissuename</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">speciename</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-equal">=</span><span class="mkapi-default">'qwen'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'qwen-plus'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">topgenenumber</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base_url</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Enhanced cell type annotation using AGI models with improved processing.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">input_data</span>
<span class="mkapi-dash">—</span>
Dictionary with clusters as keys and gene markers as values, or DataFrame with cluster information</p>
</li>
<li>
<p><span class="mkapi-item-name">tissuename</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Tissue name for context (default: None)</p>
</li>
<li>
<p><span class="mkapi-item-name">speciename</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Species name for annotation context (default: 'human')</p>
</li>
<li>
<p><span class="mkapi-item-name">provider</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
AI model provider - choose from 'openai', 'kimi', 'qwen' (default: 'qwen')</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Specific model name to use (default: 'qwen-plus')</p>
</li>
<li>
<p><span class="mkapi-item-name">topgenenumber</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of top genes to use for annotation (default: 10)</p>
</li>
<li>
<p><span class="mkapi-item-name">base_url</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Custom API base URL (default: None)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict or str</span> <span class="mkapi-dash">—</span>
Cell type annotations for each cluster, or prompt string if API key not found</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.get_cluster_celltype">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.get_cluster_celltype" title="omicverse.single.get_cluster_celltype">get_cluster_celltype</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cluster_celltypes</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_markers</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-comma">, </span><span class="mkapi-arg">organization</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base_url</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">timeout</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_retries</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_backoff</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">RuntimeError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gptcelltype_local">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.gptcelltype_local" title="omicverse.single.gptcelltype_local">gptcelltype_local</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissuename</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">speciename</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Qwen/Qwen2-7B-Instruct'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">topgenenumber</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotation of cell types using a local LLM model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">input</span>
<span class="mkapi-dash">—</span>
dict, input dictionary with clusters as keys and gene markers as values.             e.g. {'cluster1': ['gene1', 'gene2'], 'cluster2': ['gene3']}</p>
</li>
<li>
<p><span class="mkapi-item-name">tissuename</span>
<span class="mkapi-dash">—</span>
str, tissue name.</p>
</li>
<li>
<p><span class="mkapi-item-name">speciename</span>
<span class="mkapi-dash">—</span>
str, species name. Default: 'human'.</p>
</li>
<li>
<p><span class="mkapi-item-name">model_name</span>
<span class="mkapi-dash">—</span>
str, the name or path of the local model to be used.</p>
</li>
<li>
<p><span class="mkapi-item-name">topgenenumber</span>
<span class="mkapi-dash">—</span>
int, the number of top genes to consider for each cluster. Default: 10.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.popv_anno" title="omicverse.single.CellVote.popv_anno">popv_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate cells using PopV.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.scsa_anno" title="omicverse.single.CellVote.scsa_anno">scsa_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate cells using the SCSA pipeline.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.gpt_anno" title="omicverse.single.CellVote.gpt_anno">gpt_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate cells using GPT based approach.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.gbi_anno" title="omicverse.single.CellVote.gbi_anno">gbi_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate clusters using GPTBioInsightor.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.scMulan_anno" title="omicverse.single.CellVote.scMulan_anno">scMulan_anno</a></span>
<span class="mkapi-dash">—</span>
Annotate cells with the scMulan large language model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellVote.vote" title="omicverse.single.CellVote.vote">vote</a></span>
<span class="mkapi-dash">—</span>
Vote for the best cell type annotation from multiple annotation methods.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.popv_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.popv_anno" title="omicverse.single.CellVote.popv_anno">popv_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ref_adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ref_labels_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ref_batch_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">query_batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cl_obo_folder</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'tmp'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">prediction_mode</span><span class="mkapi-equal">=</span><span class="mkapi-default">'fast'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">methods</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">methods_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate cells using PopV.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ref_adata</span>
<span class="mkapi-dash">—</span>
Reference :class:<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData"><code>anndata.AnnData</code></span> object.</p>
</li>
<li>
<p><span class="mkapi-item-name">ref_labels_key</span>
<span class="mkapi-dash">—</span>
Column in <code>ref_adata.obs</code> with cell-type labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">ref_batch_key</span>
<span class="mkapi-dash">—</span>
Column in <code>ref_adata.obs</code> with batch labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">query_batch_key</span>
<span class="mkapi-dash">—</span>
Batch key in query data. Defaults to <code>None</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">cl_obo_folder</span>
<span class="mkapi-dash">—</span>
Path to ontology resources or <code>None</code> to disable ontology.</p>
</li>
<li>
<p><span class="mkapi-item-name">save_path</span>
<span class="mkapi-dash">—</span>
Directory to store intermediate models and predictions.</p>
</li>
<li>
<p><span class="mkapi-item-name">prediction_mode</span>
<span class="mkapi-dash">—</span>
Mode to use in PopV preprocessing. See :class:<code>popv.preprocessing.Process_Query</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">methods</span>
<span class="mkapi-dash">—</span>
Single algorithm name or list of algorithm names to run. <code>None</code> selects
a default set of models based on <code>prediction_mode</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">methods_kwargs</span>
<span class="mkapi-dash">—</span>
Dictionary of algorithm specific keyword arguments.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.scsa_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.scsa_anno" title="omicverse.single.CellVote.scsa_anno">scsa_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate cells using the SCSA pipeline.</p>
<p>This is a convenience wrapper around :class:<code>pySCSA</code> that runs the
annotation and stores the result back into <code>adata</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">pandas.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
The table of annotation results produced by <code>pySCSA.cell_anno</code>.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.gpt_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.gpt_anno" title="omicverse.single.CellVote.gpt_anno">gpt_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate cells using GPT based approach.</p>
<p>The function extracts marker genes for each cluster and sends them to
:func:<code>gptcelltype</code> for annotation. The resulting cell types are added
to <code>adata.obs['gpt_celltype']</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Mapping of cluster id to predicted cell type.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.gbi_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.gbi_anno" title="omicverse.single.CellVote.gbi_anno">gbi_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate clusters using GPTBioInsightor.</p>
<p>The method sends cluster marker genes to
:func:<code>gptbioinsightor.get_celltype</code> and stores the predicted cell types
with highest score in <code>adata.obs['gbi_celltype']</code>.</p>
<p>Parameters are equivalent to those in
:func:<code>gptbioinsightor.get_celltype</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Score dictionary returned by GPTBioInsightor.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.scMulan_anno">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.scMulan_anno" title="omicverse.single.CellVote.scMulan_anno">scMulan_anno</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Annotate cells with the scMulan large language model.</p>
<p>This is a thin wrapper around :mod:<code>omicverse.external.scMulan</code> that
performs gene symbol unification, runs the pretrained model and stores
predictions back into <code>self.adata</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">class:<code>anndata.&lt;span class="mkapi-tooltip" title="anndata._core.anndata.AnnData"&gt;AnnData&lt;/span&gt;</code></span> <span class="mkapi-dash">—</span>
The annotated AnnData object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellVote.vote">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellVote" title="omicverse.single.CellVote">CellVote</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellVote.vote" title="omicverse.single.CellVote.vote">vote</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">clusters_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_markers</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_keys</span><span class="mkapi-equal">=</span><span class="mkapi-default">[]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'gpt-3.5-turbo'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base_url</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">organization</span><span class="mkapi-equal">=</span><span class="mkapi-default">'stomach'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-equal">=</span><span class="mkapi-default">'openai'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">result_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'CellVote_celltype'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Vote for the best cell type annotation from multiple annotation methods.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">clusters_key</span>
<span class="mkapi-dash">—</span>
Clusters key for annotation such as leiden or louvain. Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_markers</span>
<span class="mkapi-dash">—</span>
Dictionary of cluster markers obtained from get_celltype_marker. Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_keys</span>
<span class="mkapi-dash">—</span>
List of celltype annotation columns in adata.obs. Default: [].</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span>
<span class="mkapi-dash">—</span>
LLM model used to identify best matched cells in clusters. Default: 'gpt-3.5-turbo'.</p>
</li>
<li>
<p><span class="mkapi-item-name">base_url</span>
<span class="mkapi-dash">—</span>
LLM API base URL. Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span>
<span class="mkapi-dash">—</span>
Species of scRNA-seq data. Default: 'human'.</p>
</li>
<li>
<p><span class="mkapi-item-name">organization</span>
<span class="mkapi-dash">—</span>
Organization/tissue type of scRNA-seq data. Default: 'stomach'.</p>
</li>
<li>
<p><span class="mkapi-item-name">provider</span>
<span class="mkapi-dash">—</span>
API provider when base_url is None. Default: 'openai'.</p>
</li>
<li>
<p><span class="mkapi-item-name">result_key</span>
<span class="mkapi-dash">—</span>
Column name to store results in adata.obs. Default: 'CellVote_celltype'.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Mapping of cluster IDs to voted cell types.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Initialize CellVote</span>
<span class="n">vote_obj</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">CellVote</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="c1"># Get cluster markers</span>
<span class="n">markers</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">single</span><span class="o">.</span><span class="n">get_celltype_marker</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">clustertype</span><span class="o">=</span><span class="s1">'leiden'</span><span class="p">)</span>
<span class="c1"># Vote with multiple annotation methods</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vote_obj</span><span class="o">.</span><span class="n">vote</span><span class="p">(</span><span class="s1">'leiden'</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span>
                       <span class="n">celltype_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'scsa_annotation'</span><span class="p">,</span> <span class="s1">'scMulan_anno'</span><span class="p">])</span>
<span class="c1"># Result stored in adata.obs['CellVote_celltype']</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">'CellVote_celltype'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cl_obo_file</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embeddings_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'all-mpnet-base-v2'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">local_model_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Cell ontology mapping class using NLP</p>
<p>🚀 Initialize CellOntologyMapper</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cl_obo_file</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📄 Cell Ontology OBO file path</p>
</li>
<li>
<p><span class="mkapi-item-name">embeddings_path</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
💾 Pre-computed embeddings file path</p>
</li>
<li>
<p><span class="mkapi-item-name">model_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🤖 Sentence Transformer model name</p>
</li>
<li>
<p><span class="mkapi-item-name">local_model_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📁 Local directory to save downloaded models (avoid default cache)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.setup_llm_expansion" title="omicverse.single.CellOntologyMapper.setup_llm_expansion">setup_llm_expansion</a></span>
<span class="mkapi-dash">—</span>
🤖 Setup LLM API for abbreviation expansion</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.test_abbreviation_detection" title="omicverse.single.CellOntologyMapper.test_abbreviation_detection">test_abbreviation_detection</a></span>
<span class="mkapi-dash">—</span>
🧪 Test abbreviation detection with various examples</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.expand_abbreviations" title="omicverse.single.CellOntologyMapper.expand_abbreviations">expand_abbreviations</a></span>
<span class="mkapi-dash">—</span>
🔄 Expand cell type abbreviations</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells_with_expansion" title="omicverse.single.CellOntologyMapper.map_cells_with_expansion">map_cells_with_expansion</a></span>
<span class="mkapi-dash">—</span>
🔄 First expand abbreviations, then perform ontology mapping with optional LLM selection</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.show_expansion_summary" title="omicverse.single.CellOntologyMapper.show_expansion_summary">show_expansion_summary</a></span>
<span class="mkapi-dash">—</span>
📊 Show abbreviation expansion summary</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.clear_abbreviation_cache" title="omicverse.single.CellOntologyMapper.clear_abbreviation_cache">clear_abbreviation_cache</a></span>
<span class="mkapi-dash">—</span>
🗑️  Clear abbreviation cache</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.set_model" title="omicverse.single.CellOntologyMapper.set_model">set_model</a></span>
<span class="mkapi-dash">—</span>
🎯 Set model name and local save directory</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.set_local_model" title="omicverse.single.CellOntologyMapper.set_local_model">set_local_model</a></span>
<span class="mkapi-dash">—</span>
🏠 Set local model path</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.create_ontology_resources" title="omicverse.single.CellOntologyMapper.create_ontology_resources">create_ontology_resources</a></span>
<span class="mkapi-dash">—</span>
🔨 Create ontology resources from OBO file</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.save_embeddings" title="omicverse.single.CellOntologyMapper.save_embeddings">save_embeddings</a></span>
<span class="mkapi-dash">—</span>
💾 Save embeddings to file</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.load_embeddings" title="omicverse.single.CellOntologyMapper.load_embeddings">load_embeddings</a></span>
<span class="mkapi-dash">—</span>
📥 Load embeddings from file</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.load_ontology_mappings" title="omicverse.single.CellOntologyMapper.load_ontology_mappings">load_ontology_mappings</a></span>
<span class="mkapi-dash">—</span>
📋 Load ontology ID mappings from cl_popv.json file</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.check_ontology_status" title="omicverse.single.CellOntologyMapper.check_ontology_status">check_ontology_status</a></span>
<span class="mkapi-dash">—</span>
🔍 Check ontology data status and provide diagnostic information</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells" title="omicverse.single.CellOntologyMapper.map_cells">map_cells</a></span>
<span class="mkapi-dash">—</span>
🎯 Map cell names to ontology with optional LLM-enhanced selection</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata" title="omicverse.single.CellOntologyMapper.map_adata">map_adata</a></span>
<span class="mkapi-dash">—</span>
🧬 Map cell names in AnnData object to ontology</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.get_statistics" title="omicverse.single.CellOntologyMapper.get_statistics">get_statistics</a></span>
<span class="mkapi-dash">—</span>
📊 Get mapping statistics</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids" title="omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids">print_mapping_summary_with_ids</a></span>
<span class="mkapi-dash">—</span>
📋 Print mapping summary with ontology IDs</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary" title="omicverse.single.CellOntologyMapper.print_mapping_summary">print_mapping_summary</a></span>
<span class="mkapi-dash">—</span>
📋 Print mapping summary</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.save_mapping_results" title="omicverse.single.CellOntologyMapper.save_mapping_results">save_mapping_results</a></span>
<span class="mkapi-dash">—</span>
💾 Save mapping results to file</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.list_ontology_cells" title="omicverse.single.CellOntologyMapper.list_ontology_cells">list_ontology_cells</a></span>
<span class="mkapi-dash">—</span>
📋 List all cell types in the ontology</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.search_ontology_cells" title="omicverse.single.CellOntologyMapper.search_ontology_cells">search_ontology_cells</a></span>
<span class="mkapi-dash">—</span>
🔍 Search cell types containing specific keywords in the ontology</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.get_cell_info" title="omicverse.single.CellOntologyMapper.get_cell_info">get_cell_info</a></span>
<span class="mkapi-dash">—</span>
ℹ️  Get detailed information for specific cell type</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.browse_ontology_by_category" title="omicverse.single.CellOntologyMapper.browse_ontology_by_category">browse_ontology_by_category</a></span>
<span class="mkapi-dash">—</span>
📂 Browse ontology cell types by category</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.get_ontology_statistics" title="omicverse.single.CellOntologyMapper.get_ontology_statistics">get_ontology_statistics</a></span>
<span class="mkapi-dash">—</span>
📊 Get ontology statistics</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.find_similar_cells" title="omicverse.single.CellOntologyMapper.find_similar_cells">find_similar_cells</a></span>
<span class="mkapi-dash">—</span>
🔍 Find ontology cell types most similar to given cell name</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.download_model" title="omicverse.single.CellOntologyMapper.download_model">download_model</a></span>
<span class="mkapi-dash">—</span>
📥 Manually download and load the model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource" title="omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource">load_cell_taxonomy_resource</a></span>
<span class="mkapi-dash">—</span>
📊 Load Cell Taxonomy resource as additional ontology</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells_with_taxonomy" title="omicverse.single.CellOntologyMapper.map_cells_with_taxonomy">map_cells_with_taxonomy</a></span>
<span class="mkapi-dash">—</span>
🔄 Enhanced cell mapping using both ontology and taxonomy</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.search_by_marker" title="omicverse.single.CellOntologyMapper.search_by_marker">search_by_marker</a></span>
<span class="mkapi-dash">—</span>
🎯 Search cell types by gene markers using taxonomy resource</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata_with_taxonomy" title="omicverse.single.CellOntologyMapper.map_adata_with_taxonomy">map_adata_with_taxonomy</a></span>
<span class="mkapi-dash">—</span>
🧬 Apply taxonomy-enhanced mapping to AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy" title="omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy">print_mapping_summary_taxonomy</a></span>
<span class="mkapi-dash">—</span>
📋 Print comprehensive mapping summary with taxonomy information</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy" title="omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy">find_similar_cells_taxonomy</a></span>
<span class="mkapi-dash">—</span>
🧬 Find taxonomy cell types most similar to given cell name</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.get_cell_info_taxonomy" title="omicverse.single.CellOntologyMapper.get_cell_info_taxonomy">get_cell_info_taxonomy</a></span>
<span class="mkapi-dash">—</span>
🧬 Get detailed taxonomy information for specific cell type</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata_with_expansion" title="omicverse.single.CellOntologyMapper.map_adata_with_expansion">map_adata_with_expansion</a></span>
<span class="mkapi-dash">—</span>
🧬 Perform ontology mapping with abbreviation expansion on AnnData</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.setup_llm_expansion">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.setup_llm_expansion" title="omicverse.single.CellOntologyMapper.setup_llm_expansion">setup_llm_expansion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">api_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'openai'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'gpt-3.5-turbo'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base_url</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cache_file</span><span class="mkapi-equal">=</span><span class="mkapi-default">'abbreviation_cache.json'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">extra_params</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🤖 Setup LLM API for abbreviation expansion</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">api_type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🔌 API type: "openai", "anthropic", "ollama", "qwen", "ernie", "glm", "spark", "doubao", "custom_openai"</p>
</li>
<li>
<p><span class="mkapi-item-name">api_key</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔐 API key</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🧠 Model name</p>
</li>
<li>
<p><span class="mkapi-item-name">base_url</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🌐 Custom API base URL (required for custom_openai and some domestic models)</p>
</li>
<li>
<p><span class="mkapi-item-name">cache_file</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
💽 Cache file path</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Tissue context information, e.g. "immune system", "brain", "liver" or list of tissues</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🐭 Species, default "human", can also be "mouse", "rat", etc.</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Study context, e.g. "cancer", "development", "aging", "disease", etc.</p>
</li>
<li>
<p><span class="mkapi-item-name">extra_params</span> : 
<span class="mkapi-item-type">dict, optional</span> <span class="mkapi-dash">—</span>
🔧 Additional parameters for specific APIs</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.test_abbreviation_detection">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.test_abbreviation_detection" title="omicverse.single.CellOntologyMapper.test_abbreviation_detection">test_abbreviation_detection</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">test_cases</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧪 Test abbreviation detection with various examples</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">test_cases</span> : 
<span class="mkapi-item-type">dict, optional</span> <span class="mkapi-dash">—</span>
📝 Custom test cases {cell_name: expected_result}</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.expand_abbreviations">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.expand_abbreviations" title="omicverse.single.CellOntologyMapper.expand_abbreviations">expand_abbreviations</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">force_expand</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_cache</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔄 Expand cell type abbreviations</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_names</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📝 List of cell names</p>
</li>
<li>
<p><span class="mkapi-item-name">force_expand</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🔒 Whether to force expand all names (not just abbreviations)</p>
</li>
<li>
<p><span class="mkapi-item-name">save_cache</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
💾 Whether to save to cache</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Temporary override tissue context information</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Temporary override species information</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Temporary override study context information</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">expanded_names</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Mapping from original names to expanded names</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_cells_with_expansion">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells_with_expansion" title="omicverse.single.CellOntologyMapper.map_cells_with_expansion">map_cells_with_expansion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expand_abbreviations</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_llm_selection</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_candidates_count</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔄 First expand abbreviations, then perform ontology mapping with optional LLM selection</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_names</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📝 List of cell names to map</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">expand_abbreviations</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🔄 Whether to enable abbreviation expansion</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Tissue context information</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Species information</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Study context information</p>
</li>
<li>
<p><span class="mkapi-item-name">use_llm_selection</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🤖 Whether to use LLM for selecting from top candidates (when LLM is available)</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_candidates_count</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Number of top candidates to send to LLM for selection</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Mapping results (including original and expanded name information + LLM selection)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.show_expansion_summary">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.show_expansion_summary" title="omicverse.single.CellOntologyMapper.show_expansion_summary">show_expansion_summary</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📊 Show abbreviation expansion summary</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.clear_abbreviation_cache">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.clear_abbreviation_cache" title="omicverse.single.CellOntologyMapper.clear_abbreviation_cache">clear_abbreviation_cache</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🗑️  Clear abbreviation cache</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.set_model">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.set_model" title="omicverse.single.CellOntologyMapper.set_model">set_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">local_model_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🎯 Set model name and local save directory</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🤖 Model name (e.g., 'all-mpnet-base-v2', 'sentence-transformers/all-MiniLM-L6-v2')</p>
</li>
<li>
<p><span class="mkapi-item-name">local_model_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📁 Local directory to save the model (avoid default cache)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.set_local_model">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.set_local_model" title="omicverse.single.CellOntologyMapper.set_local_model">set_local_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🏠 Set local model path</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📁 Local model directory path</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.create_ontology_resources">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.create_ontology_resources" title="omicverse.single.CellOntologyMapper.create_ontology_resources">create_ontology_resources</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cl_obo_file</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_embeddings</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔨 Create ontology resources from OBO file</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cl_obo_file</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📄 Cell Ontology OBO file path</p>
</li>
<li>
<p><span class="mkapi-item-name">save_embeddings</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
💾 Whether to save embeddings to file</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.save_embeddings">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.save_embeddings" title="omicverse.single.CellOntologyMapper.save_embeddings">save_embeddings</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>💾 Save embeddings to file</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.load_embeddings">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.load_embeddings" title="omicverse.single.CellOntologyMapper.load_embeddings">load_embeddings</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">embeddings_path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📥 Load embeddings from file</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.load_ontology_mappings">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.load_ontology_mappings" title="omicverse.single.CellOntologyMapper.load_ontology_mappings">load_ontology_mappings</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">popv_json_path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📋 Load ontology ID mappings from cl_popv.json file</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">popv_json_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📄 Path to cl_popv.json file</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">success</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
✓ True if loaded successfully</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.check_ontology_status">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.check_ontology_status" title="omicverse.single.CellOntologyMapper.check_ontology_status">check_ontology_status</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔍 Check ontology data status and provide diagnostic information</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">status</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📊 Status information</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells" title="omicverse.single.CellOntologyMapper.map_cells">map_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_llm_selection</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_candidates_count</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🎯 Map cell names to ontology with optional LLM-enhanced selection</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_names</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📝 List of cell names to map</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">use_llm_selection</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🤖 Whether to use LLM for selecting from top candidates (when LLM is available)</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_candidates_count</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Number of top candidates to send to LLM for selection</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Mapping results (now includes ontology IDs and LLM selection info)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_adata">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata" title="omicverse.single.CellOntologyMapper.map_adata">map_adata</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_name_col</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">new_col_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cell_ontology'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Map cell names in AnnData object to ontology</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
📊 Single-cell data object</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_name_col</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📝 Column name containing cell names, use index if None</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">new_col_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🏷️  New column name</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Mapping results</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.get_statistics">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.get_statistics" title="omicverse.single.CellOntologyMapper.get_statistics">get_statistics</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📊 Get mapping statistics</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids" title="omicverse.single.CellOntologyMapper.print_mapping_summary_with_ids">print_mapping_summary_with_ids</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_n</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📋 Print mapping summary with ontology IDs</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.print_mapping_summary">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary" title="omicverse.single.CellOntologyMapper.print_mapping_summary">print_mapping_summary</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_n</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📋 Print mapping summary</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.save_mapping_results">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.save_mapping_results" title="omicverse.single.CellOntologyMapper.save_mapping_results">save_mapping_results</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_file</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>💾 Save mapping results to file</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.list_ontology_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.list_ontology_cells" title="omicverse.single.CellOntologyMapper.list_ontology_cells">list_ontology_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">max_display</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_all</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📋 List all cell types in the ontology</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">max_display</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Maximum number to display</p>
</li>
<li>
<p><span class="mkapi-item-name">return_all</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
📝 Whether to return complete list</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_types</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📋 List of cell types</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.search_ontology_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.search_ontology_cells" title="omicverse.single.CellOntologyMapper.search_ontology_cells">search_ontology_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">keyword</span><span class="mkapi-comma">, </span><span class="mkapi-arg">case_sensitive</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_results</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔍 Search cell types containing specific keywords in the ontology</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">keyword</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🔤 Search keyword</p>
</li>
<li>
<p><span class="mkapi-item-name">case_sensitive</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
📝 Whether case sensitive</p>
</li>
<li>
<p><span class="mkapi-item-name">max_results</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Maximum number of results to return</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">matches</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📋 List of matching cell types</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.get_cell_info">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.get_cell_info" title="omicverse.single.CellOntologyMapper.get_cell_info">get_cell_info</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_name</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>ℹ️  Get detailed information for specific cell type</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📝 Cell type name</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">info</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
ℹ️  Cell information dictionary</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.browse_ontology_by_category">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.browse_ontology_by_category" title="omicverse.single.CellOntologyMapper.browse_ontology_by_category">browse_ontology_by_category</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">categories</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_per_category</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📂 Browse ontology cell types by category</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">categories</span> : 
<span class="mkapi-item-type">list, optional</span> <span class="mkapi-dash">—</span>
📝 List of category keywords to view</p>
</li>
<li>
<p><span class="mkapi-item-name">max_per_category</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Maximum number to display per category</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.get_ontology_statistics">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.get_ontology_statistics" title="omicverse.single.CellOntologyMapper.get_ontology_statistics">get_ontology_statistics</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📊 Get ontology statistics</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.find_similar_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.find_similar_cells" title="omicverse.single.CellOntologyMapper.find_similar_cells">find_similar_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_k</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔍 Find ontology cell types most similar to given cell name</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📝 Input cell name</p>
</li>
<li>
<p><span class="mkapi-item-name">top_k</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Return top k most similar results</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">similar_cells</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📋 Similar cell types and their similarities</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.download_model">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.download_model" title="omicverse.single.CellOntologyMapper.download_model">download_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📥 Manually download and load the model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
✓ True if successful, False otherwise</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource" title="omicverse.single.CellOntologyMapper.load_cell_taxonomy_resource">load_cell_taxonomy_resource</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">taxonomy_file</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species_filter</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📊 Load Cell Taxonomy resource as additional ontology</p>
<p>This method treats Cell Taxonomy as an additional ontology source,
reusing the same NLP embedding and matching mechanisms as Cell Ontology.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">taxonomy_file</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📄 Path to Cell_Taxonomy_resource.txt file</p>
</li>
<li>
<p><span class="mkapi-item-name">species_filter</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🐭 Filter by species (e.g., "Homo sapiens", "Mus musculus")</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">success</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
✓ True if loaded successfully</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_cells_with_taxonomy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_cells_with_taxonomy" title="omicverse.single.CellOntologyMapper.map_cells_with_taxonomy">map_cells_with_taxonomy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expand_abbreviations</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_taxonomy</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_llm_selection</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_candidates_count</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🔄 Enhanced cell mapping using both ontology and taxonomy</p>
<p>This method combines Cell Ontology and Cell Taxonomy using the same NLP approach,
providing comprehensive mapping results with additional marker gene information.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_names</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📝 List of cell names to map</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">expand_abbreviations</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🔄 Whether to enable abbreviation expansion</p>
</li>
<li>
<p><span class="mkapi-item-name">use_taxonomy</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
📊 Whether to include taxonomy resource in mapping</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Species information for taxonomy filtering</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Tissue context information</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Study context information</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Combined mapping results from ontology and taxonomy</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.search_by_marker">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.search_by_marker" title="omicverse.single.CellOntologyMapper.search_by_marker">search_by_marker</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">markers</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_k</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🎯 Search cell types by gene markers using taxonomy resource</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">markers</span> : 
<span class="mkapi-item-type">str or list</span> <span class="mkapi-dash">—</span>
🧬 Gene marker(s) to search for</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Species to filter by</p>
</li>
<li>
<p><span class="mkapi-item-name">top_k</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Maximum number of results to return</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">matches</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📊 List of matching cell types with detailed information</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_adata_with_taxonomy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata_with_taxonomy" title="omicverse.single.CellOntologyMapper.map_adata_with_taxonomy">map_adata_with_taxonomy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_name_col</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">new_col_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cell_ontology'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expand_abbreviations</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_taxonomy</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Apply taxonomy-enhanced mapping to AnnData object</p>
<p>This method applies the unified ontology + taxonomy mapping to AnnData,
providing comprehensive cell type annotation with gene marker information.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
📊 Single-cell data object</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_name_col</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📝 Column name containing cell names, use index if None</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">new_col_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🏷️  Base name for new columns</p>
</li>
<li>
<p><span class="mkapi-item-name">expand_abbreviations</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🔄 Whether to enable LLM abbreviation expansion</p>
</li>
<li>
<p><span class="mkapi-item-name">use_taxonomy</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
📊 Whether to include taxonomy resource enhancement</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Species information for taxonomy filtering</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Tissue context information</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Study context information</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Enhanced mapping results with both ontology and taxonomy information</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy" title="omicverse.single.CellOntologyMapper.print_mapping_summary_taxonomy">print_mapping_summary_taxonomy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mapping_results</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_n</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📋 Print comprehensive mapping summary with taxonomy information</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy" title="omicverse.single.CellOntologyMapper.find_similar_cells_taxonomy">find_similar_cells_taxonomy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_k</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Find taxonomy cell types most similar to given cell name</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📝 Input cell name</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Filter by species (e.g., "Homo sapiens", "Mus musculus")</p>
</li>
<li>
<p><span class="mkapi-item-name">top_k</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
📊 Return top k most similar results</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">similar_cells</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📋 Similar cell types with similarities and taxonomy info</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.get_cell_info_taxonomy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.get_cell_info_taxonomy" title="omicverse.single.CellOntologyMapper.get_cell_info_taxonomy">get_cell_info_taxonomy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Get detailed taxonomy information for specific cell type</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
📝 Cell type name</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Filter by species (e.g., "Homo sapiens", "Mus musculus")</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">info_list</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
📋 List of taxonomy information dictionaries</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.CellOntologyMapper.map_adata_with_expansion">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.CellOntologyMapper" title="omicverse.single.CellOntologyMapper">CellOntologyMapper</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.CellOntologyMapper.map_adata_with_expansion" title="omicverse.single.CellOntologyMapper.map_adata_with_expansion">map_adata_with_expansion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_name_col</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">new_col_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cell_ontology'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expand_abbreviations</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tissue_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">study_context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_llm_selection</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_candidates_count</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>🧬 Perform ontology mapping with abbreviation expansion on AnnData</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
📊 Single-cell data object</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_name_col</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
📝 Column name containing cell names</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
📊 Similarity threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">new_col_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
🏷️  New column name</p>
</li>
<li>
<p><span class="mkapi-item-name">expand_abbreviations</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
🔄 Whether to enable abbreviation expansion</p>
</li>
<li>
<p><span class="mkapi-item-name">tissue_context</span> : 
<span class="mkapi-item-type">str or list, optional</span> <span class="mkapi-dash">—</span>
🧬 Tissue context information, e.g. "immune system", "brain", "liver"</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🐭 Species information, e.g. "human", "mouse", "rat"</p>
</li>
<li>
<p><span class="mkapi-item-name">study_context</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
🔬 Study context information, e.g. "cancer", "development", "aging"</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mapping_results</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
📋 Mapping results</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.download_cl">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.download_cl" title="omicverse.single.download_cl">download_cl</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">output_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'new_ontology'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">filename</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cl.json'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>📥 Download Cell Ontology file from multiple sources with automatic fallback</p>
<p>This is a standalone function that downloads cl.json from multiple sources:
1. Official OBO Library (direct JSON)
2. OSS Mirror for Chinese users (ZIP format)
3. Google Drive backup (ZIP format)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">output_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Directory to save the file (default: "new_ontology")</p>
</li>
<li>
<p><span class="mkapi-item-name">filename</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Output filename (default: "cl.json")</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">success</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
True if download successful, False otherwise</p>
</li>
<li>
<p><span class="mkapi-item-name">file_path</span> : 
<span class="mkapi-item-type">str or None</span> <span class="mkapi-dash">—</span>
Path to downloaded file if successful</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">success</span><span class="p">,</span> <span class="n">file_path</span> <span class="o">=</span> <span class="n">download_cl</span><span class="p">()</span>
<span class="k">if</span> <span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Downloaded to: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">success</span><span class="p">,</span> <span class="n">file_path</span> <span class="o">=</span> <span class="n">download_cl</span><span class="p">(</span><span class="s2">"my_data"</span><span class="p">,</span> <span class="s2">"cell_ontology.json"</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize the MOFAART class.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The path of MOFA model.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.get_factors" title="omicverse.single.pyMOFAART.get_factors">get_factors</a></span>
<span class="mkapi-dash">—</span>
Get the factors of MOFA to anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.get_r2" title="omicverse.single.pyMOFAART.get_r2">get_r2</a></span>
<span class="mkapi-dash">—</span>
Get the varience of each factor</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_r2" title="omicverse.single.pyMOFAART.plot_r2">plot_r2</a></span>
<span class="mkapi-dash">—</span>
plot the varience of each factor.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.get_cor" title="omicverse.single.pyMOFAART.get_cor">get_cor</a></span>
<span class="mkapi-dash">—</span>
get the correlation of each factor with cluster type in anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_cor" title="omicverse.single.pyMOFAART.plot_cor">plot_cor</a></span>
<span class="mkapi-dash">—</span>
Plot the correlation of each factor with cluster type in anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_factor" title="omicverse.single.pyMOFAART.plot_factor">plot_factor</a></span>
<span class="mkapi-dash">—</span>
Plot the factor of MOFA in anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_weight_gene_d1" title="omicverse.single.pyMOFAART.plot_weight_gene_d1">plot_weight_gene_d1</a></span>
<span class="mkapi-dash">—</span>
Plot the weight of gene in each factor of MOFA in anndata object in dimension 1.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_weight_gene_d2" title="omicverse.single.pyMOFAART.plot_weight_gene_d2">plot_weight_gene_d2</a></span>
<span class="mkapi-dash">—</span>
Plot the weight of gene in each factor of MOFA in anndata object in dimension 2.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_weights_gene_factor" title="omicverse.single.pyMOFAART.plot_weights_gene_factor">plot_weights_gene_factor</a></span>
<span class="mkapi-dash">—</span>
Plot the weights of each gene in the factor</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_top_feature_dotplot" title="omicverse.single.pyMOFAART.plot_top_feature_dotplot">plot_top_feature_dotplot</a></span>
<span class="mkapi-dash">—</span>
Plot the top features of each factor in dotplot</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.plot_top_feature_heatmap" title="omicverse.single.pyMOFAART.plot_top_feature_heatmap">plot_top_feature_heatmap</a></span>
<span class="mkapi-dash">—</span>
Plot the top features of each factor in dotplot</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFAART.get_top_feature" title="omicverse.single.pyMOFAART.get_top_feature">get_top_feature</a></span>
<span class="mkapi-dash">—</span>
Get the top features of each factor</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.get_factors">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.get_factors" title="omicverse.single.pyMOFAART.get_factors">get_factors</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the factors of MOFA to anndata object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The anndata object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.get_r2">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.get_r2" title="omicverse.single.pyMOFAART.get_r2">get_r2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the varience of each factor</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.pyMOFAART.r2">r2</span></span> <span class="mkapi-dash">—</span>
the varience of each factor</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_r2">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_r2" title="omicverse.single.pyMOFAART.plot_r2">plot_r2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(2, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Greens'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>plot the varience of each factor.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The color map.</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The size of ticks.</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The size of labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure of varience.
ax: The axes of varience.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.get_cor">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.get_cor" title="omicverse.single.pyMOFAART.get_cor">get_cor</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor_list</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>get the correlation of each factor with cluster type in anndata object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The cluster type.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor_list</span>
<span class="mkapi-dash">—</span>
The list of factors.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.pyMOFAART.get_cor.plot_data1">plot_data1</span></span> <span class="mkapi-dash">—</span>
The correlation of each factor with cluster type.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_cor">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_cor" title="omicverse.single.pyMOFAART.plot_cor">plot_cor</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor_list</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(6, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Purples'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Correlation'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot the correlation of each factor with cluster type in anndata object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The anndata object in MOFA pre trained.</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The cluster type in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor_list</span>
<span class="mkapi-dash">—</span>
The list of factors.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The color map.</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of ticks.</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The title of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure of correlation.
ax: The axes of correlation.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_factor">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_factor" title="omicverse.single.pyMOFAART.plot_factor">plot_factor</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot the factor of MOFA in anndata object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The anndata object.</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The cluster type in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The title of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor1</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The first factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor2</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The second factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
The color map.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure of factor.
ax: The axes of factor.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_weight_gene_d1">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_weight_gene_d1" title="omicverse.single.pyMOFAART.plot_weight_gene_d1">plot_weight_gene_d1</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_gene_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weith_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot the weight of gene in each factor of MOFA in anndata object in dimension 1.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The view of MOFA.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor1</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The first factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor2</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The second factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">colors_dict</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
The color dict of up, down and normal. default is {'normal':'#c2c2c2','up':'#a51616','down':'#0d6a3b'}</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_gene_num</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of genes to plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The title of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">title_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of title.</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of ticks.</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">weith_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The threshold of weight.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure of weight.
ax: The axes of weight.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_weight_gene_d2">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_weight_gene_d2" title="omicverse.single.pyMOFAART.plot_weight_gene_d2">plot_weight_gene_d2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_gene_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weith_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot the weight of gene in each factor of MOFA in anndata object in dimension 2.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The view of MOFA.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor1</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The first factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor2</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The second factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">colors_dict</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
The color dict. default is {'up-up':'#a51616','up-down':'#e25d5d','down-up':'#1a6e1a','down-down':'#5de25d','normal':'#c2c2c2'}</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_gene_num</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of genes to plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The title of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">title_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of title.</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of ticks.</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">weith_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The threshold of weight.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of figure.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure of weight.
ax: The axes of weight.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_weights_gene_factor">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_weights_gene_factor" title="omicverse.single.pyMOFAART.plot_weights_gene_factor">plot_weights_gene_factor</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#a51616'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_gene_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ascending</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot the weights of each gene in the factor</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the view of the factor</p>
</li>
<li>
<p><span class="mkapi-item-name">factor</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the factor number</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color of the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, the size of the figure</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_gene_num</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of genes to plot</p>
</li>
<li>
<p><span class="mkapi-item-name">ascending</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, whether to sort the genes by weights</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the fontsize of the labels</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the fontsize of the ticks</p>
</li>
<li>
<p><span class="mkapi-item-name">title_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the fontsize of the title</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
str, the title of the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, whether to save the plot.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure object.
ax: The axis object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_top_feature_dotplot">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_top_feature_dotplot" title="omicverse.single.pyMOFAART.plot_top_feature_dotplot">plot_top_feature_dotplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bwr'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Plot the top features of each factor in dotplot</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the view of the factor</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color map of the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">n_genes</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of genes to plot</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">axes</span> <span class="mkapi-dash">—</span>
the list of the figure</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.plot_top_feature_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.plot_top_feature_heatmap" title="omicverse.single.pyMOFAART.plot_top_feature_heatmap">plot_top_feature_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bwr'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Plot the top features of each factor in dotplot</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the view of the factor</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color map of the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">n_genes</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of genes to plot</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">axes</span> <span class="mkapi-dash">—</span>
the list of the figure</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFAART.get_top_feature">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFAART" title="omicverse.single.pyMOFAART">pyMOFAART</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFAART.get_top_feature" title="omicverse.single.pyMOFAART.get_top_feature">get_top_feature</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log2fc_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">dict</span></span>
</p>
<div class="mkapi-document">
<p>Get the top features of each factor</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the view of the factor</p>
</li>
<li>
<p><span class="mkapi-item-name">log2fc_min</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
float, the minimum log2fc of the feature</p>
</li>
<li>
<p><span class="mkapi-item-name">pval_cutoff</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the maximum pval of the feature</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.pyMOFAART.get_top_feature.top_feature">top_feature</span></span> <span class="mkapi-dash">—</span>
dict, the top features of each factor</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFA">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFA" title="omicverse.single.pyMOFA">pyMOFA</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">omics</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-comma">, </span><span class="mkapi-arg">omics_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>MOFA class.</p>
<p>Initialize the MOFA class.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">omics</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
The list of omics data.</p>
</li>
<li>
<p><span class="mkapi-item-name">omics_name</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
The list of omics name.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFA.mofa_preprocess" title="omicverse.single.pyMOFA.mofa_preprocess">mofa_preprocess</a></span>
<span class="mkapi-dash">—</span>
Preprocess the data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMOFA.mofa_run" title="omicverse.single.pyMOFA.mofa_run">mofa_run</a></span>
<span class="mkapi-dash">—</span>
Train the MOFA model.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFA.mofa_preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFA" title="omicverse.single.pyMOFA">pyMOFA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFA.mofa_preprocess" title="omicverse.single.pyMOFA.mofa_preprocess">mofa_preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Preprocess the data.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMOFA.mofa_run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMOFA" title="omicverse.single.pyMOFA">pyMOFA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMOFA.mofa_run" title="omicverse.single.pyMOFA.mofa_run">mofa_run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">outfile</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'res.hdf5'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">iter</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">convergence_mode</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'fast'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spikeslab_weights</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">startELBO</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">freqELBO</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dropR2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gpu_mode</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gpu_device</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">112</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_views</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">center_groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Train the MOFA model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">outfile</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The path of output file.</p>
</li>
<li>
<p><span class="mkapi-item-name">factors</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of factors.</p>
</li>
<li>
<p><span class="mkapi-item-name">iter</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of iterations.</p>
</li>
<li>
<p><span class="mkapi-item-name">convergence_mode</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The mode of convergence.</p>
</li>
<li>
<p><span class="mkapi-item-name">spikeslab_weights</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use spikeslab weights.</p>
</li>
<li>
<p><span class="mkapi-item-name">startELBO</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The start of ELBO.</p>
</li>
<li>
<p><span class="mkapi-item-name">freqELBO</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The frequency of ELBO.</p>
</li>
<li>
<p><span class="mkapi-item-name">dropR2</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The drop of R2.</p>
</li>
<li>
<p><span class="mkapi-item-name">gpu_mode</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use gpu mode.</p>
</li>
<li>
<p><span class="mkapi-item-name">verbose</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to print the information.</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The seed of random number.</p>
</li>
<li>
<p><span class="mkapi-item-name">scale_groups</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to scale groups.</p>
</li>
<li>
<p><span class="mkapi-item-name">scale_views</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to scale views.</p>
</li>
<li>
<p><span class="mkapi-item-name">center_groups</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to center groups.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.GLUE_pair">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.GLUE_pair" title="omicverse.single.GLUE_pair">GLUE_pair</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">rna</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">atac</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Pair the cells between RNA and ATAC using result of GLUE.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">rna</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData of RNA-seq.</p>
</li>
<li>
<p><span class="mkapi-item-name">atac</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData of ATAC-seq.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.GLUE_pair.correlation" title="omicverse.single.GLUE_pair.correlation">correlation</a></span>
<span class="mkapi-dash">—</span>
Perform Pearson Correlation analysis in the layer of GLUE.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.GLUE_pair.find_neighbor_cell" title="omicverse.single.GLUE_pair.find_neighbor_cell">find_neighbor_cell</a></span>
<span class="mkapi-dash">—</span>
Find the neighbor cells between two omics using pearson correlation.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.GLUE_pair.pair_omic" title="omicverse.single.GLUE_pair.pair_omic">pair_omic</a></span>
<span class="mkapi-dash">—</span>
Pair the omics using the result of find_neighbor_cell.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.GLUE_pair.correlation">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.GLUE_pair" title="omicverse.single.GLUE_pair">GLUE_pair</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.GLUE_pair.correlation" title="omicverse.single.GLUE_pair.correlation">correlation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Perform Pearson Correlation analysis in the layer of GLUE.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
Updates self.rna_pd and self.atac_pd attributes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.GLUE_pair.find_neighbor_cell">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.GLUE_pair" title="omicverse.single.GLUE_pair">GLUE_pair</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.GLUE_pair.find_neighbor_cell" title="omicverse.single.GLUE_pair.find_neighbor_cell">find_neighbor_cell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">depth</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.9</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Find the neighbor cells between two omics using pearson correlation.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">depth</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The depth of the search for the nearest neighbor. (10)</p>
</li>
<li>
<p><span class="mkapi-item-name">cor</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Correlation threshold for pairing. (0.9)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.GLUE_pair.find_neighbor_cell.result">result</span></span> <span class="mkapi-dash">—</span>
The pair result as DataFrame</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.GLUE_pair.pair_omic">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.GLUE_pair" title="omicverse.single.GLUE_pair">GLUE_pair</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.GLUE_pair.pair_omic" title="omicverse.single.GLUE_pair.pair_omic">pair_omic</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">omic1</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">omic2</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span>, <span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Pair the omics using the result of find_neighbor_cell.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">omic1</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData of first omic.</p>
</li>
<li>
<p><span class="mkapi-item-name">omic2</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData of second omic.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.GLUE_pair.pair_omic.rna1">rna1</span></span> <span class="mkapi-dash">—</span>
The paired AnnData of first omic.
atac1: The paired AnnData of second omic.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.factor_exact">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.factor_exact" title="omicverse.single.factor_exact">factor_exact</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">hdf5_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span></span>
</p>
<div class="mkapi-document">
<p>Extract the factor information from hdf5 file.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name">hdf5_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The path of hdf5 file.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
The AnnData object with factor information.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.factor_correlation">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.factor_correlation" title="omicverse.single.factor_correlation">factor_correlation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor_list</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-comma">, </span><span class="mkapi-arg">p_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">500</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate the correlation between factors and cluster.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
The AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The name of cluster.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor_list</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
The list of factors.</p>
</li>
<li>
<p><span class="mkapi-item-name">p_threshold</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The threshold of p-value.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.factor_correlation.cell_pd">cell_pd</span></span> <span class="mkapi-dash">—</span>
The correlation between factors and cluster.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.get_weights">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.get_weights" title="omicverse.single.get_weights">get_weights</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">hdf5_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the weights of each feature in a specific factor.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">hdf5_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
the path of hdf5 file.</p>
</li>
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
the name of view.</p>
</li>
<li>
<p><span class="mkapi-item-name">factor</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
the number of factor.</p>
</li>
<li>
<p><span class="mkapi-item-name">scale</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
whether to scale the weights.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.get_weights.res">res</span></span> <span class="mkapi-dash">—</span>
the weights of each feature in a specific factor.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.glue_pair">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.glue_pair" title="omicverse.single.glue_pair">glue_pair</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">rna</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">atac</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">depth</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Pair the cells between RNA and ATAC using result of GLUE.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">rna</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
the AnnData of RNA-seq.</p>
</li>
<li>
<p><span class="mkapi-item-name">atac</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
the AnnData of ATAC-seq.</p>
</li>
<li>
<p><span class="mkapi-item-name">depth</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
the depth of the search for the nearest neighbor.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.get_r2_from_hdf5">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.get_r2_from_hdf5" title="omicverse.single.get_r2_from_hdf5">get_r2_from_hdf5</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">hdf5_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the variance explained (R2) for each factor from hdf5 file directly.
Simplified version that only works with pre-computed R2 values.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">hdf5_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
the path of hdf5 file.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">r2_df</span> <span class="mkapi-dash">—</span>
DataFrame with R2 values for each factor and view.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">workdir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'simba_result'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize SIMBA object for batch correction and multimodal analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">workdir</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Working directory for saving results (default: "simba_result")</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.check_simba" title="omicverse.single.pySIMBA.check_simba">check_simba</a></span>
<span class="mkapi-dash">—</span>
Check if SIMBA package has been installed.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.preprocess" title="omicverse.single.pySIMBA.preprocess">preprocess</a></span>
<span class="mkapi-dash">—</span>
Preprocess the AnnData object for SIMBA analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.gen_graph" title="omicverse.single.pySIMBA.gen_graph">gen_graph</a></span>
<span class="mkapi-dash">—</span>
Generate the graph structure for batch correction.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.train" title="omicverse.single.pySIMBA.train">train</a></span>
<span class="mkapi-dash">—</span>
Train the SIMBA model for batch correction.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.load" title="omicverse.single.pySIMBA.load">load</a></span>
<span class="mkapi-dash">—</span>
Load a pre-trained SIMBA model for batch correction.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pySIMBA.batch_correction" title="omicverse.single.pySIMBA.batch_correction">batch_correction</a></span>
<span class="mkapi-dash">—</span>
Perform batch correction using the trained SIMBA model.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.check_simba">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.check_simba" title="omicverse.single.pySIMBA.check_simba">check_simba</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if SIMBA package has been installed.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ImportError</span>
<span class="mkapi-dash">—</span>
If SIMBA package is not installed</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.preprocess" title="omicverse.single.pySIMBA.preprocess">preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'batch'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_n_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'lib_size'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_top_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_bins</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Preprocess the AnnData object for SIMBA analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">batch_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key of batch information in adata.obs (default: 'batch')</p>
</li>
<li>
<p><span class="mkapi-item-name">min_n_cells</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Minimum number of cells for a gene to be considered (default: 3)</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Method for normalization (default: 'lib_size')</p>
</li>
<li>
<p><span class="mkapi-item-name">n_top_genes</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of top variable genes to keep (default: 3000)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_bins</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of bins for discretization (default: 5)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.gen_graph">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.gen_graph" title="omicverse.single.pySIMBA.gen_graph">gen_graph</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_components</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">k</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">copy</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dirname</span><span class="mkapi-equal">=</span><span class="mkapi-default">'graph0'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate the graph structure for batch correction.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">n_components</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of components for dimensionality reduction (default: 15)</p>
</li>
<li>
<p><span class="mkapi-item-name">k</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of neighbors for graph construction (default: 15)</p>
</li>
<li>
<p><span class="mkapi-item-name">copy</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to copy the adata object (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">dirname</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Directory name for saving graph results (default: 'graph0')</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.train" title="omicverse.single.pySIMBA.train">train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">num_workers</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">auto_wd</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_wd</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output</span><span class="mkapi-equal">=</span><span class="mkapi-default">'model'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Train the SIMBA model for batch correction.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">num_workers</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of workers for parallel training (default: 12)</p>
</li>
<li>
<p><span class="mkapi-item-name">auto_wd</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use automatic weight decay (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">save_wd</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to save weight decay parameters (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">output</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Output directory for saving the trained model (default: 'model')</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.load">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.load" title="omicverse.single.pySIMBA.load">load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load a pre-trained SIMBA model for batch correction.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to the model directory (default: None)
If None, loads from default location</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pySIMBA.batch_correction">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pySIMBA" title="omicverse.single.pySIMBA">pySIMBA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pySIMBA.batch_correction" title="omicverse.single.pySIMBA.batch_correction">batch_correction</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">use_precomputed</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Perform batch correction using the trained SIMBA model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">use_precomputed</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use precomputed embeddings (default: False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">AnnData</span> <span class="mkapi-dash">—</span>
Batch-corrected AnnData object with X_simba embedding</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyTOSICA">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">project_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gmt_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">mask_ratio</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.015</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_g</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_gs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_unannotated</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embed_dim</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">48</span><span class="mkapi-comma">, </span><span class="mkapi-arg">depth</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_heads</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">device</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'cuda:0'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize a pyTOSICA object for cell type classification.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">project_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to save the results and model files</p>
</li>
<li>
<p><span class="mkapi-item-name">gmt_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Gene set name or path - choose from 'human_gobp', 'human_immune', 'human_reactome', 'human_tf', 'mouse_gobp', 'mouse_reactome', 'mouse_tf' (default: None)</p>
</li>
<li>
<p><span class="mkapi-item-name">label_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Column name of the label to predict in adata.obs (default: 'Celltype')</p>
</li>
<li>
<p><span class="mkapi-item-name">mask_ratio</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Ratio of connections reserved when no mask is available (default: 0.015)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_g</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum number of genes per pathway (default: 300)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_gs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum number of pathways/tokens (default: 300)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_unannotated</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of unannotated/fully-connected tokens to add (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">embed_dim</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Dimension of pathway/token embedding (default: 48)</p>
</li>
<li>
<p><span class="mkapi-item-name">depth</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of transformer layers (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">num_heads</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of attention heads (default: 4)</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Batch size for training (default: 8)</p>
</li>
<li>
<p><span class="mkapi-item-name">device</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Device for computation (default: 'cuda:0')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyTOSICA.train" title="omicverse.single.pyTOSICA.train">train</a></span>
<span class="mkapi-dash">—</span>
Train the TOSICA model for cell type classification.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyTOSICA.save" title="omicverse.single.pyTOSICA.save">save</a></span>
<span class="mkapi-dash">—</span>
Save the trained TOSICA model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyTOSICA.load" title="omicverse.single.pyTOSICA.load">load</a></span>
<span class="mkapi-dash">—</span>
Load a pre-trained TOSICA model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyTOSICA.predicted" title="omicverse.single.pyTOSICA.predicted">predicted</a></span>
<span class="mkapi-dash">—</span>
Predict cell types for new single-cell data.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyTOSICA.train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyTOSICA.train" title="omicverse.single.pyTOSICA.train">train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pre_weights</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lr</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">epochs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lrf</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.01</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Train the TOSICA model for cell type classification.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pre_weights</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to pre-trained weights (default: '')</p>
</li>
<li>
<p><span class="mkapi-item-name">lr</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Learning rate for optimization (default: 0.001)</p>
</li>
<li>
<p><span class="mkapi-item-name">epochs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of training epochs (default: 10)</p>
</li>
<li>
<p><span class="mkapi-item-name">lrf</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Learning rate factor for cosine annealing (default: 0.01)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="torch">torch</span>.<span class="mkapi-tooltip" title="torch.nn">nn</span>.<span class="mkapi-tooltip" title="torch.nn.modules.module.Module">Module</span></span> <span class="mkapi-dash">—</span>
The trained TOSICA model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyTOSICA.save">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyTOSICA.save" title="omicverse.single.pyTOSICA.save">save</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">save_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Save the trained TOSICA model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">save_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to save the model (default: None)
If None, saves to project_path/model-best.pth</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyTOSICA.load">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyTOSICA.load" title="omicverse.single.pyTOSICA.load">load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">load_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load a pre-trained TOSICA model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">load_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to the model file (default: None)
If None, loads from project_path/model-best.pth</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyTOSICA.predicted">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyTOSICA" title="omicverse.single.pyTOSICA">pyTOSICA</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyTOSICA.predicted" title="omicverse.single.pyTOSICA.predicted">predicted</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pre_adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">laten</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_step</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Predict cell types for new single-cell data.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pre_adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing new data for prediction</p>
</li>
<li>
<p><span class="mkapi-item-name">laten</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to return latent representation instead of pathway attention (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_step</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of steps for batch processing (default: 10000)</p>
</li>
<li>
<p><span class="mkapi-item-name">cutoff</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Confidence cutoff for predictions (default: 0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Batch size for prediction (default: 50)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">AnnData</span> <span class="mkapi-dash">—</span>
New AnnData object with predicted cell types and confidence scores</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TFIDF_LSI">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.TFIDF_LSI" title="omicverse.single.TFIDF_LSI">TFIDF_LSI</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_comps</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">binarize</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Computes LSI based on a TF-IDF transformation of the data. Putative dimensionality 
reduction for scATAC-seq data prior to MultiMAP. Adds an <code>.obsm['X_lsi']</code> field to 
the object it was ran on.</p>
<h2 id="input">Input<a class="headerlink" href="#input" title="Permanent link">¶</a></h2>
<p>adata : <code>AnnData</code>
        The object to run TFIDF + LSI on. Will use <code>.X</code> as the input data.
n_comps : <code>int</code>
        The number of components to generate. Default: 50
binarize : <code>bool</code>
        Whether to binarize the data prior to the computation. Often done during scATAC-seq 
        processing. Default: True
random_state : <code>int</code>
        The seed to use for randon number generation. Default: 0</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Wrapper">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Wrapper" title="omicverse.single.Wrapper">Wrapper</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">flagged</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_reps</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embedding</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>A function that computes the paired PCAs between the datasets to integrate, calls MultiMAP
proper, and returns a  (parameters, connectivities, embedding) tuple. Embedding optional
depending on <code>embedding</code>.</p>
<h2 id="input_1">Input<a class="headerlink" href="#input_1" title="Permanent link">¶</a></h2>
<p>flagged : list of <code>AnnData</code>
        Preprocessed objects to integrate. Need to have the single-dataset DRs computed at 
        this stage. Need to have <code>.obs['multimap_index']</code> defined, incrementing integers
        matching the object's index in the list. Both <code>Integrate()</code> and <code>Batch()</code> make 
        these.</p>
<p>All other arguments as described in <code>MultiMAP.Integration()</code>.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Integration">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Integration" title="omicverse.single.Integration">Integration</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adatas</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_reps</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embedding</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run MultiMAP to integrate a number of AnnData objects from various multi-omics experiments
into a single joint dimensionally reduced space. Returns a joint object with the resulting 
embedding stored in <code>.obsm['X_multimap']</code> (if instructed) and appropriate graphs in 
<code>.obsp</code>. The final object will be a concatenation of the individual ones provided on 
input, so in the interest of ease of exploration it is recommended to have non-scaled data 
in <code>.X</code>.</p>
<h2 id="input_2">Input<a class="headerlink" href="#input_2" title="Permanent link">¶</a></h2>
<p>adatas : list of <code>AnnData</code>
        The objects to integrate. The <code>.var</code> spaces will be intersected across subsets of 
        the objects to compute shared PCAs, so make sure that you have ample features in 
        common between the objects. <code>.X</code> data will be used for computation.
use_reps : list of <code>str</code>
        The <code>.obsm</code> fields for each of the corresponding <code>adatas</code> to use as the 
        dimensionality reduction to represent the full feature space of the object. Needs 
        to be precomputed and present in the object at the time of calling the function.
scale : <code>bool</code>, optional (default: <code>True</code>)
        Whether to scale the data to N(0,1) on a per-dataset basis prior to computing the 
        cross-dataset PCAs. Improves integration.
embedding : <code>bool</code>, optional (default: <code>True</code>)
        Whether to compute the MultiMAP embedding. If <code>False</code>, will just return the graph,
        which can be used to compute a regular UMAP. This can produce a manifold quicker,
        but at the cost of accuracy.
n_neighbors : <code>int</code> or <code>None</code>, optional (default: <code>None</code>)
        The number of neighbours for each node (data point) in the MultiGraph. If <code>None</code>, 
        defaults to 15 times the number of input datasets.
n_components : <code>int</code> (default: 2)
        The number of dimensions of the MultiMAP embedding.
seed : <code>int</code> (default: 0)
        RNG seed.
strengths: <code>list</code> of <code>float</code> or <code>None</code> (default: <code>None</code>)
        The relative contribution of each dataset to the layout of the embedding. The 
        higher the strength the higher the weighting of its cross entropy in the layout loss. 
        If provided, needs to be a list with one 0-1 value per dataset; if <code>None</code>, defaults 
        to 0.5 for each dataset.
cardinality : <code>float</code> or <code>None</code>, optional (default: <code>None</code>)
        The target sum of the connectivities of each neighbourhood in the MultiGraph. If 
        <code>None</code>, defaults to <code>log2(n_neighbors)</code>.</p>
<p>The following parameter definitions are sourced from UMAP 0.5.1:</p>
<p>n_epochs : int (optional, default None)
        The number of training epochs to be used in optimizing the
        low dimensional embedding. Larger values result in more accurate
        embeddings. If None is specified a value will be selected based on
        the size of the input dataset (200 for large datasets, 500 for small).
init : string (optional, default 'spectral')
        How to initialize the low dimensional embedding. Options are:
                * 'spectral': use a spectral embedding of the fuzzy 1-skeleton
                * 'random': assign initial embedding positions at random.
                * A numpy array of initial embedding positions.
min_dist : float (optional, default 0.1)
        The effective minimum distance between embedded points. Smaller values
        will result in a more clustered/clumped embedding where nearby points
        on the manifold are drawn closer together, while larger values will
        result on a more even dispersal of points. The value should be set
        relative to the <code>spread</code> value, which determines the scale at which
        embedded points will be spread out.
spread : float (optional, default 1.0)
        The effective scale of embedded points. In combination with <code>min_dist</code>
        this determines how clustered/clumped the embedded points are.
set_op_mix_ratio : float (optional, default 1.0)
        Interpolate between (fuzzy) union and intersection as the set operation
        used to combine local fuzzy simplicial sets to obtain a global fuzzy
        simplicial sets. Both fuzzy set operations use the product t-norm.
        The value of this parameter should be between 0.0 and 1.0; a value of
        1.0 will use a pure fuzzy union, while 0.0 will use a pure fuzzy
        intersection.
local_connectivity : int (optional, default 1)
        The local connectivity required -- i.e. the number of nearest
        neighbors that should be assumed to be connected at a local level.
        The higher this value the more connected the manifold becomes
        locally. In practice this should be not more than the local intrinsic
        dimension of the manifold.
a : float (optional, default None)
        More specific parameters controlling the embedding. If None these
        values are set automatically as determined by <code>min_dist</code> and
        <code>spread</code>.
b : float (optional, default None)
        More specific parameters controlling the embedding. If None these
        values are set automatically as determined by <code>min_dist</code> and
        <code>spread</code>.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Batch">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Batch" title="omicverse.single.Batch">Batch</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'batch'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embedding</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dimred_func</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run MultiMAP to correct batch effect within a single AnnData object. Loses the flexibility 
of individualised dimensionality reduction choices, but doesn't require a list of separate 
objects for each batch/dataset to integrate. Runs PCA on a per-batch/dataset basis prior 
to performing an analysis analogous to  <code>Integration()</code>. Adds appropriate <code>.obsp</code> graphs 
and <code>.obsm['X_multimap']</code> (if instructed) to the input.</p>
<h2 id="input_3">Input<a class="headerlink" href="#input_3" title="Permanent link">¶</a></h2>
<p>adata : <code>AnnData</code>
        The object to process. <code>.X</code> data will be used in the computation.
batch_key : <code>str</code>, optional (default: "batch")
        The <code>.obs</code> column of the input object with the categorical variable defining the 
        batch/dataset grouping to integrate on.
scale : <code>bool</code>, optional (default: <code>True</code>)
        Whether to scale the data to N(0,1) on a per-dataset basis prior to computing the 
        cross-dataset PCAs. Improves integration.
embedding : <code>bool</code>, optional (default: <code>True</code>)
        Whether to compute the MultiMAP embedding. If <code>False</code>, will just return the graph,
        which can be used to compute a regular UMAP. This can produce a manifold quicker,
        but at the cost of accuracy.
dimred_func : function or <code>None</code>, optional (default: <code>None</code>)
        The function to use to compute dimensionality reduction on a per-dataset basis. Must 
        accept an <code>AnnData</code> on input and modify it by inserting its dimensionality reduction 
        into <code>.obsm</code>. If <code>None</code>, <code>scanpy.tl.pca()</code> will be used.
rep_name : <code>str</code>, optional (default: "X_pca")
        The <code>.obsm</code> field that the dimensionality reduction function stores its output under.</p>
<p>All other arguments as described in <code>Integration()</code>.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.convert_r2_to_matrix">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.convert_r2_to_matrix" title="omicverse.single.convert_r2_to_matrix">convert_r2_to_matrix</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">r2_df</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Convert R2 DataFrame to a matrix format with factors as rows and views as columns.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">r2_df</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame with columns ['Factor', 'View', 'Group', 'R2'].</p>
</li>
<li>
<p><span class="mkapi-item-name">group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
specific group to show (if None and multiple groups exist, will average across groups).</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._mofa.convert_r2_to_matrix.matrix_df">matrix_df</span></span> <span class="mkapi-dash">—</span>
DataFrame with factors as rows and views as columns.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.factor_group_correlation_mdata">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.factor_group_correlation_mdata" title="omicverse.single.factor_group_correlation_mdata">factor_group_correlation_mdata</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mdata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group_col</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Group'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor_prefix</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Factor'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">p_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'ttest'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log_transform</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_group_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate the correlation/association between MOFA factors and groups in MuData.
Handles unpaired data by analyzing each view separately.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mdata</span>
<span class="mkapi-dash">—</span>
MuData object with MOFA factors in obsm['X_mofa'].
group_col: Column name for group information.
factor_prefix: Prefix for factor names (default: 'Factor').
view: Specific view to analyze ('metab', 'micro', etc.). If None, analyze all views.
p_threshold: P-value threshold for significance.
method: Statistical test method ('ttest', 'anova', 'kruskal').
log_transform: Whether to apply log transformation to p-values.
min_group_size: Minimum group size for analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
results_df: DataFrame with factor-group associations for each view.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_factor_group_associations">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_factor_group_associations" title="omicverse.single.plot_factor_group_associations">plot_factor_group_associations</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">results_df</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_n</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(12, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'factor_group_associations.png'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Plot factor-group associations from factor_group_correlation_mdata results.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">results_df</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Results DataFrame from factor_group_correlation_mdata.
top_n: Number of top associations to plot.
figsize: Figure size.
save: Whether to save the plot.
save_path: Path to save the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig, axes: Matplotlib figure and axes objects.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_factor_boxplots">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_factor_boxplots" title="omicverse.single.plot_factor_boxplots">plot_factor_boxplots</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mdata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">results_df</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_n</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">6</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group_col</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Group'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factor_prefix</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Factor'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(15, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'factor_boxplots.png'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Create boxplots for top significant factor-group associations.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mdata</span>
<span class="mkapi-dash">—</span>
MuData object.
results_df: Results DataFrame from factor_group_correlation_mdata.
top_n: Number of top factors to plot.
group_col: Group column name.
factor_prefix: Factor name prefix.
figsize: Figure size.
save: Whether to save the plot.
save_path: Path to save the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig, axes: Matplotlib figure and axes objects.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_factors_violin">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_factors_violin" title="omicverse.single.plot_factors_violin">plot_factors_violin</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mdata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Group'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">violins</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dots</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zero_line</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zero_linewidth</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_prop</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">violins_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sharex</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sharey</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(6, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot factor values as violin plots or strip plots for MuData object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mdata</span>
<span class="mkapi-dash">—</span>
MuData object with MOFA factors in obsm['X_mofa'].</p>
</li>
<li>
<p><span class="mkapi-item-name">factors</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of factor indices to plot (all factors by default).</p>
</li>
<li>
<p><span class="mkapi-item-name">group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Column name in adata.obs for grouping (default is 'Group').</p>
</li>
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Specific view to analyze ('metab', 'micro', etc.). If None, use all samples.</p>
</li>
<li>
<p><span class="mkapi-item-name">violins</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show violin plots.</p>
</li>
<li>
<p><span class="mkapi-item-name">dots</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show individual dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">zero_line</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show horizontal line at y=0.</p>
</li>
<li>
<p><span class="mkapi-item-name">linewidth</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Line width for dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">zero_linewidth</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Line width for zero line.</p>
</li>
<li>
<p><span class="mkapi-item-name">size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Size of dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">legend</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show legend.</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_prop</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Properties for legend.</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Opacity of dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">violins_alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Opacity of violins.</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of columns in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">sharex</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to share x-axis across subplots.</p>
</li>
<li>
<p><span class="mkapi-item-name">sharey</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to share y-axis across subplots.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
Figure size.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to seaborn plotting functions.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure object.
ax: The axis object.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_weights">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_weights" title="omicverse.single.plot_weights">plot_weights</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mdata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">view</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">factors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_features</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">w_scaled</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">w_abs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'black'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_offset</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_offset</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">jitter</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'black'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zero_line</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zero_line_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sharex</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sharey</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">feature_label</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(10, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.figure">figure</span>.<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Plot weights for MOFA factors.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mdata</span>
<span class="mkapi-dash">—</span>
MuData object with weights stored in varm['mofa_weights'].</p>
</li>
<li>
<p><span class="mkapi-item-name">view</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the modality/view.</p>
</li>
<li>
<p><span class="mkapi-item-name">factors</span>
<span class="mkapi-dash">—</span>
List of factors to plot (all by default).</p>
</li>
<li>
<p><span class="mkapi-item-name">n_features</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of features with largest weights to label.</p>
</li>
<li>
<p><span class="mkapi-item-name">w_scaled</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to scale weights to unit variance.</p>
</li>
<li>
<p><span class="mkapi-item-name">w_abs</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to plot absolute weight values.</p>
</li>
<li>
<p><span class="mkapi-item-name">size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Dot size.</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Color for labeled dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">label_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Font size of feature labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">x_offset</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Offset for feature labels from left/right side.</p>
</li>
<li>
<p><span class="mkapi-item-name">y_offset</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Parameter to repel feature labels along y axis.</p>
</li>
<li>
<p><span class="mkapi-item-name">jitter</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Whether to jitter dots per factors.</p>
</li>
<li>
<p><span class="mkapi-item-name">line_width</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Width of lines connecting labels with dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">line_color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Color of lines connecting labels with dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">line_alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Alpha level for lines connecting labels with dots.</p>
</li>
<li>
<p><span class="mkapi-item-name">zero_line</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to plot dotted line at zero.</p>
</li>
<li>
<p><span class="mkapi-item-name">zero_line_width</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Width of zero line.</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of columns in grid of multiple plots.</p>
</li>
<li>
<p><span class="mkapi-item-name">sharex</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use same X axis across panels.</p>
</li>
<li>
<p><span class="mkapi-item-name">sharey</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use same Y axis across panels.</p>
</li>
<li>
<p><span class="mkapi-item-name">feature_label</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Column name in var containing feature labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to seaborn plotting functions.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
The figure object.
ax: The axis object.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_comps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'clusters'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Trajectory inference class for single-cell data analysis.</p>
<p>This class provides methods for inferring developmental trajectories using
various algorithms including Palantir, diffusion maps, and Slingshot.</p>
<p>Initialize trajectory inference object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Embedding key in adata.obsm for visualization (default: 'X_umap')</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Representation key in adata.obsm for trajectory computation (default: 'X_pca')</p>
</li>
<li>
<p><span class="mkapi-item-name">n_comps</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of components to use from representation (default: 50)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_neighbors</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of neighbors for graph construction (default: 15)</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs containing cluster annotations (default: 'clusters')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.set_terminal_cells" title="omicverse.single.TrajInfer.set_terminal_cells">set_terminal_cells</a></span>
<span class="mkapi-dash">—</span>
Set terminal cell types for trajectory inference.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.set_origin_cells" title="omicverse.single.TrajInfer.set_origin_cells">set_origin_cells</a></span>
<span class="mkapi-dash">—</span>
Set origin cell type for trajectory inference.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.inference" title="omicverse.single.TrajInfer.inference">inference</a></span>
<span class="mkapi-dash">—</span>
Perform trajectory inference using specified method.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.palantir_plot_pseudotime" title="omicverse.single.TrajInfer.palantir_plot_pseudotime">palantir_plot_pseudotime</a></span>
<span class="mkapi-dash">—</span>
Plot Palantir pseudotime results.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.palantir_cal_branch" title="omicverse.single.TrajInfer.palantir_cal_branch">palantir_cal_branch</a></span>
<span class="mkapi-dash">—</span>
Calculate and plot branch selection for Palantir results.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.palantir_cal_gene_trends" title="omicverse.single.TrajInfer.palantir_cal_gene_trends">palantir_cal_gene_trends</a></span>
<span class="mkapi-dash">—</span>
Calculate gene expression trends along Palantir trajectories.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.TrajInfer.palantir_plot_gene_trends" title="omicverse.single.TrajInfer.palantir_plot_gene_trends">palantir_plot_gene_trends</a></span>
<span class="mkapi-dash">—</span>
Plot gene expression trends along Palantir trajectories.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.set_terminal_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.set_terminal_cells" title="omicverse.single.TrajInfer.set_terminal_cells">set_terminal_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">terminal</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Set terminal cell types for trajectory inference.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">terminal</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of terminal cell type names</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.set_origin_cells">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.set_origin_cells" title="omicverse.single.TrajInfer.set_origin_cells">set_origin_cells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">origin</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Set origin cell type for trajectory inference.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">origin</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the origin cell type</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.inference">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.inference" title="omicverse.single.TrajInfer.inference">inference</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'palantir'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Perform trajectory inference using specified method.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Trajectory inference method - 'palantir', 'diffusion_map', or 'slingshot' (default: 'palantir')
**kwargs: Additional arguments passed to the chosen method</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Depends on method: Palantir results object, None, or sets internal attributes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.palantir_plot_pseudotime">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.palantir_plot_pseudotime" title="omicverse.single.TrajInfer.palantir_plot_pseudotime">palantir_plot_pseudotime</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot Palantir pseudotime results.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to plot_palantir_results</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.palantir_cal_branch">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.palantir_cal_branch" title="omicverse.single.TrajInfer.palantir_cal_branch">palantir_cal_branch</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate and plot branch selection for Palantir results.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to select_branch_cells</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.palantir_cal_gene_trends">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.palantir_cal_gene_trends" title="omicverse.single.TrajInfer.palantir_cal_gene_trends">palantir_cal_gene_trends</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">layers</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'MAGIC_imputed_data'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate gene expression trends along Palantir trajectories.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">layers</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key for expression data layer (default: "MAGIC_imputed_data")</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Gene trends object containing trajectory-associated expression patterns</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.TrajInfer.palantir_plot_gene_trends">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.TrajInfer" title="omicverse.single.TrajInfer">TrajInfer</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.TrajInfer.palantir_plot_gene_trends" title="omicverse.single.TrajInfer.palantir_plot_gene_trends">palantir_plot_gene_trends</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">genes</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot gene expression trends along Palantir trajectories.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">genes</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of gene names to plot</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Matplotlib figure object containing gene trend plots</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.fle">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.fle" title="omicverse.single.fle">fle</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">file_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'diffmap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep_ncomps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">K</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">full_speed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_change_per_node</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_steps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">is3d</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">memory</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">out_basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'fle'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fa2_scaling_ratio</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fa2_gravity</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fa2_edge_weight_influence</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_gpu</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">optimized_threading</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">compile_cython</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Construct the Force-directed (FLE) graph.</p>
<p>This implementation uses our custom ForceAtlas2 implementation, which is a multilthreaded version
of the original ForceAtlas2 algorithm.</p>
<p>See [Jacomy14]_ for details on FLE.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><code>pegasusio.MultimodalData</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix with rows for cells and columns for genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">file_name</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>None</code></span> <span class="mkapi-dash">—</span>
Temporary file to store the coordinates as the input to forceatlas2. If <code>None</code>, use <code>tempfile.mkstemp</code> to generate file name.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_jobs</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>-1</code></span> <span class="mkapi-dash">—</span>
Number of threads to use. If <code>-1</code>, use all physical CPU cores.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"diffmap"</code></span> <span class="mkapi-dash">—</span>
Representation of data used for the calculation. By default, use Diffusion Map coordinates. If <code>None</code>, use the count matrix <code>data.X</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep_ncomps</span> : 
<span class="mkapi-item-type"><code>int</code>, optional (default: None)</span> <span class="mkapi-dash">—</span>
Number of components to be used in <span class="mkapi-tooltip" title="omicverse.single._traj.fle.rep"><code>rep</code></span>. If rep_ncomps == None, use all components; otherwise, use the minimum of rep_ncomps and rep's dimensions.</p>
</li>
<li>
<p><span class="mkapi-item-name">K</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>50</code></span> <span class="mkapi-dash">—</span>
Number of nearest neighbors to be considered during the computation.</p>
</li>
<li>
<p><span class="mkapi-item-name">full_speed</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>False</code></span> <span class="mkapi-dash">—</span>
* If <code>True</code>, use multiple threads in constructing <code>hnsw</code> index. However, the kNN results are not reproducible.
* Otherwise, use only one thread to make sure results are reproducible.</p>
</li>
<li>
<p><span class="mkapi-item-name">target_change_per_node</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>2.0</code></span> <span class="mkapi-dash">—</span>
Target change per node to stop ForceAtlas2.</p>
</li>
<li>
<p><span class="mkapi-item-name">target_steps</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>5000</code></span> <span class="mkapi-dash">—</span>
Maximum number of iterations before stopping the ForceAtlas2 algorithm.</p>
</li>
<li>
<p><span class="mkapi-item-name">is3d</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>False</code></span> <span class="mkapi-dash">—</span>
If <code>True</code>, calculate 3D force-directed layout.</p>
</li>
<li>
<p><span class="mkapi-item-name">memory</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>8</code></span> <span class="mkapi-dash">—</span>
Memory size in GB for the Java FA2 component. By default, use 8GB memory.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>0</code></span> <span class="mkapi-dash">—</span>
Random seed set for reproducing results.</p>
</li>
<li>
<p><span class="mkapi-item-name">out_basis</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"fle"</code></span> <span class="mkapi-dash">—</span>
Key name for calculated FLE coordinates to store.</p>
</li>
<li>
<p><span class="mkapi-item-name">fa2_scaling_ratio</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>2.0</code></span> <span class="mkapi-dash">—</span>
Scaling ratio parameter for ForceAtlas2.</p>
</li>
<li>
<p><span class="mkapi-item-name">fa2_gravity</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>1.0</code></span> <span class="mkapi-dash">—</span>
Gravity parameter for ForceAtlas2.</p>
</li>
<li>
<p><span class="mkapi-item-name">fa2_edge_weight_influence</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>1.0</code></span> <span class="mkapi-dash">—</span>
Edge weight influence parameter for ForceAtlas2.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_gpu</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>False</code></span> <span class="mkapi-dash">—</span>
Whether to use GPU acceleration for force calculations. Requires PyTorch to be installed.</p>
</li>
<li>
<p><span class="mkapi-item-name">optimized_threading</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>True</code></span> <span class="mkapi-dash">—</span>
Whether to use optimized threading algorithm for better parallel performance.</p>
</li>
<li>
<p><span class="mkapi-item-name">compile_cython</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>True</code></span> <span class="mkapi-dash">—</span>
Whether to try compiling fa2util module with Cython for 10-100x speedup.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><code>None</code></span></p>
</li>
<li>
<p><span class="mkapi-item-name">Update <code>data.obsm</code></span>
<span class="mkapi-dash">—</span>
* <code>data.obsm['X_' + out_basis]</code>: FLE coordinates of the data.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">fle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.diffmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.diffmap" title="omicverse.single.diffmap">diffmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_components</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">solver</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'eigsh'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_t</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Calculate Diffusion Map.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><code>pegasusio.MultimodalData</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix with rows for cells and columns for genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_components</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>100</code></span> <span class="mkapi-dash">—</span>
Number of diffusion components to calculate.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"pca"</code></span> <span class="mkapi-dash">—</span>
Embedding Representation of data used for calculating the Diffusion Map. By default, use PCA coordinates.</p>
</li>
<li>
<p><span class="mkapi-item-name">solver</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"eigsh"</code></span> <span class="mkapi-dash">—</span>
Solver for eigen decomposition:
    * <code>"eigsh"</code>: default setting. Use <em>scipy</em> <code>eigsh &lt;https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.eigsh.html&gt;</code><em> as the solver to find eigenvalus and eigenvectors using the Implicitly Restarted Lanczos Method.
    * <code>"randomized"</code>: Use <em>scikit-learn</em> <code>randomized_svd &lt;https://scikit-learn.org/stable/modules/generated/sklearn.utils.extmath.randomized_svd.html&gt;</code></em> as the solver to calculate a truncated randomized SVD.</p>
</li>
<li>
<p><span class="mkapi-item-name">max_t</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>5000</code></span> <span class="mkapi-dash">—</span>
pegasus tries to determine the best t to sum up to between <code>[1, max_t]</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_jobs</span> : 
<span class="mkapi-item-type"><code>int</code>, optional (default: -1)</span> <span class="mkapi-dash">—</span>
Number of threads to use. -1 refers to using all physical CPU cores.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>0</code></span> <span class="mkapi-dash">—</span>
Random seed set for reproducing results.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><code>None</code></span></p>
</li>
<li>
<p><span class="mkapi-item-name">Update <code>data.obsm</code></span>
<span class="mkapi-dash">—</span>
* <code>data.obsm["X_diffmap"]</code>: Diffusion Map matrix of the data.</p>
</li>
<li>
<p><span class="mkapi-item-name">Update <code>data.uns</code></span>
<span class="mkapi-dash">—</span>
* <code>data.uns["diffmap_evals"]</code>: Eigenvalues corresponding to Diffusion Map matrix.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">diffmap</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">input_dim</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cpu</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cuda:0'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANNmodel_init" title="omicverse.single.scLTNN.ANNmodel_init">ANNmodel_init</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANNmodel_train" title="omicverse.single.scLTNN.ANNmodel_train">ANNmodel_train</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANNmodel_predicted" title="omicverse.single.scLTNN.ANNmodel_predicted">ANNmodel_predicted</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANNmodel_save" title="omicverse.single.scLTNN.ANNmodel_save">ANNmodel_save</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANNmodel_load" title="omicverse.single.scLTNN.ANNmodel_load">ANNmodel_load</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_paga" title="omicverse.single.scLTNN.cal_paga">cal_paga</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_model_time" title="omicverse.single.scLTNN.cal_model_time">cal_model_time</a></span>
<span class="mkapi-dash">—</span>
predict the latent time by primriary ANN model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_exp_gene_value" title="omicverse.single.scLTNN.cal_exp_gene_value">cal_exp_gene_value</a></span>
<span class="mkapi-dash">—</span>
Calculated the gene with the same trend in the expression gene amount of cell</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_dpt_pseudotime" title="omicverse.single.scLTNN.cal_dpt_pseudotime">cal_dpt_pseudotime</a></span>
<span class="mkapi-dash">—</span>
calculate the diffusion pseudotime of anndata by start node selected automatically</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.ANN" title="omicverse.single.scLTNN.ANN">ANN</a></span>
<span class="mkapi-dash">—</span>
regression of latent time by start and end node using ANN model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_distrubute" title="omicverse.single.scLTNN.cal_distrubute">cal_distrubute</a></span>
<span class="mkapi-dash">—</span>
calculate the distribution of ANN time and diffusion pseudotime</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.distribute_fun" title="omicverse.single.scLTNN.distribute_fun">distribute_fun</a></span>
<span class="mkapi-dash">—</span>
calculate the distribution of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scLTNN.cal_scLTNN_time" title="omicverse.single.scLTNN.cal_scLTNN_time">cal_scLTNN_time</a></span>
<span class="mkapi-dash">—</span>
calcualte the scLTNN time of anndata</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANNmodel_init">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANNmodel_init" title="omicverse.single.scLTNN.ANNmodel_init">ANNmodel_init</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pseudotime</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANNmodel_train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANNmodel_train" title="omicverse.single.scLTNN.ANNmodel_train">ANNmodel_train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_epochs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANNmodel_predicted">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANNmodel_predicted" title="omicverse.single.scLTNN.ANNmodel_predicted">ANNmodel_predicted</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">x</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANNmodel_save">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANNmodel_save" title="omicverse.single.scLTNN.ANNmodel_save">ANNmodel_save</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">save_path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANNmodel_load">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANNmodel_load" title="omicverse.single.scLTNN.ANNmodel_load">ANNmodel_load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">load_path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_paga">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_paga" title="omicverse.single.scLTNN.cal_paga">cal_paga</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">resolution</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.0</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_model_time">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_model_time" title="omicverse.single.scLTNN.cal_model_time">cal_model_time</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>predict the latent time by primriary ANN model</p>
<p>Arguments:</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_exp_gene_value">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_exp_gene_value" title="omicverse.single.scLTNN.cal_exp_gene_value">cal_exp_gene_value</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mode</span><span class="mkapi-equal">=</span><span class="mkapi-default">'exp'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rev</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculated the gene with the same trend in the expression gene amount of cell</p>
<p>Arguments: </p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_dpt_pseudotime">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_dpt_pseudotime" title="omicverse.single.scLTNN.cal_dpt_pseudotime">cal_dpt_pseudotime</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">leiden_range_start</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">leiden_range_end</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">leiden_range_mid</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rev</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>calculate the diffusion pseudotime of anndata by start node selected automatically</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">leiden_range_start</span>
<span class="mkapi-dash">—</span>
the range of start node</p>
</li>
<li>
<p><span class="mkapi-item-name">leiden_range_end</span>
<span class="mkapi-dash">—</span>
the range of end node</p>
</li>
<li>
<p><span class="mkapi-item-name">leiden_range_mid</span>
<span class="mkapi-dash">—</span>
the range of middle node</p>
</li>
<li>
<p><span class="mkapi-item-name">rev</span>
<span class="mkapi-dash">—</span>
test function to use the end node</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.ANN">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.ANN" title="omicverse.single.scLTNN.ANN">ANN</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_epochs</span><span class="mkapi-equal">=</span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">mode</span><span class="mkapi-equal">=</span><span class="mkapi-default">'p_time'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>regression of latent time by start and end node using ANN model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">batch_size</span>
<span class="mkapi-dash">—</span>
the batch_size of ANN model</p>
</li>
<li>
<p><span class="mkapi-item-name">epochs</span>
<span class="mkapi-dash">—</span>
the epochs of ANN model</p>
</li>
<li>
<p><span class="mkapi-item-name">verbose</span>
<span class="mkapi-dash">—</span>
the visualization of ANN model summary</p>
</li>
<li>
<p><span class="mkapi-item-name">mode</span>
<span class="mkapi-dash">—</span>
the calculation mode of ANN model, if we want to use the diffusion time to regression the ANN model, we can set the model 'dpt_time'</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_distrubute">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_distrubute" title="omicverse.single.scLTNN.cal_distrubute">cal_distrubute</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>calculate the distribution of ANN time and diffusion pseudotime</p>
<p>Arguments:</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.distribute_fun">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.distribute_fun" title="omicverse.single.scLTNN.distribute_fun">distribute_fun</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mode</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x2</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>calculate the distribution of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mode</span>
<span class="mkapi-dash">—</span>
Norm: the normal module of scLTNN distribution
Best_all: the best distribution to use in scLTNN time calcultion
Best_dweibull: the best distribution of ANN model time to use in  scLTNN time calcultion</p>
</li>
<li>
<p><span class="mkapi-item-name">x1</span>
<span class="mkapi-dash">—</span>
the dpt_pseudotime of adata</p>
</li>
<li>
<p><span class="mkapi-item-name">x2</span>
<span class="mkapi-dash">—</span>
the p_ANN_time of adata</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">x</span> <span class="mkapi-dash">—</span>
the composition of x1 and x2 by special distribution</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scLTNN.cal_scLTNN_time">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scLTNN" title="omicverse.single.scLTNN">scLTNN</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scLTNN.cal_scLTNN_time" title="omicverse.single.scLTNN.cal_scLTNN_time">cal_scLTNN_time</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mode</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Norm'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>calcualte the scLTNN time of anndata</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mode</span>
<span class="mkapi-dash">—</span>
'Norm': the normal module of scLTNN distribution
'Best_all' the best distribution to use in scLTNN time calcultion
'Best_dweibull': the best distribution of ANN model time to use in  scLTNN time calcultion</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_origin_tesmination">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_origin_tesmination" title="omicverse.single.plot_origin_tesmination">plot_origin_tesmination</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">origin</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tesmination</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>plot the origin and tesmination cell of scRNA-seq</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
the anndata performed LTNN analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">origin</span>
<span class="mkapi-dash">—</span>
the origin cell list/numpy.nparray</p>
</li>
<li>
<p><span class="mkapi-item-name">tesmination</span>
<span class="mkapi-dash">—</span>
the tesmination cell list/numpy.nparray</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax</span> <span class="mkapi-dash">—</span>
the axex subplot of heatmap</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.find_related_gene">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.find_related_gene" title="omicverse.single.find_related_gene">find_related_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Find out the gene with postivate relation of the amounts of cells
Arguments</p>
<hr/>
<p>adata
    the anndata performed LTNN analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._ltnn.find_related_gene.res_pd">res_pd</span></span> <span class="mkapi-dash">—</span>
the pandas of correlation with genes and the amounts of cells</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cytotrace2">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cytotrace2" title="omicverse.single.cytotrace2">cytotrace2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_model_dir</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mouse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">10000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">smooth_batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">1000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">disable_parallelization</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_cores</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_pcs</span><span class="mkapi-equal">=</span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">14</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cytotrace2_results'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>CytoTRACE 2: Deep learning-based cell potency prediction.</p>
<p>This function predicts cellular potency states using a deep learning model,
providing scores for developmental potential and differentiation status.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell RNA-seq data</p>
</li>
<li>
<p><span class="mkapi-item-name">use_model_dir</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to directory containing pre-trained model files</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Species of input data - 'mouse' or 'human' (default: 'mouse')</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of cells to process per batch (default: 10000)</p>
</li>
<li>
<p><span class="mkapi-item-name">smooth_batch_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Batch size for smoothing operations (default: 1000)</p>
</li>
<li>
<p><span class="mkapi-item-name">disable_parallelization</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to disable parallel processing (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_cores</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum CPU cores for parallel processing (default: None for all cores)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_pcs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum number of principal components to use (default: 200)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Random seed for reproducibility (default: 14)</p>
</li>
<li>
<p><span class="mkapi-item-name">output_dir</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Directory to save results (default: 'cytotrace2_results')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame containing CytoTRACE2 scores, potency categories, and relative scores</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">pseudotime</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Cellfategenie model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">pseudotime</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of pseudotime in adata.obs</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.model_init" title="omicverse.single.Fate.model_init">model_init</a></span>
<span class="mkapi-dash">—</span>
Initialize the model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.atac_init" title="omicverse.single.Fate.atac_init">atac_init</a></span>
<span class="mkapi-dash">—</span>
Initialize the atac model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_related_peak" title="omicverse.single.Fate.get_related_peak">get_related_peak</a></span>
<span class="mkapi-dash">—</span>
Get the related peak of gene</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.ATR" title="omicverse.single.Fate.ATR">ATR</a></span>
<span class="mkapi-dash">—</span>
Adaptive Threshold Regression</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.model_fit" title="omicverse.single.Fate.model_fit">model_fit</a></span>
<span class="mkapi-dash">—</span>
Fit the model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.kendalltau_filter" title="omicverse.single.Fate.kendalltau_filter">kendalltau_filter</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.low_density" title="omicverse.single.Fate.low_density">low_density</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.lineage_score" title="omicverse.single.Fate.lineage_score">lineage_score</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_coef" title="omicverse.single.Fate.get_coef">get_coef</a></span>
<span class="mkapi-dash">—</span>
Get the coef of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_r2" title="omicverse.single.Fate.get_r2">get_r2</a></span>
<span class="mkapi-dash">—</span>
Get the r2 of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_mse" title="omicverse.single.Fate.get_mse">get_mse</a></span>
<span class="mkapi-dash">—</span>
Get the mse of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_rmse" title="omicverse.single.Fate.get_rmse">get_rmse</a></span>
<span class="mkapi-dash">—</span>
Get the rmse of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.get_mae" title="omicverse.single.Fate.get_mae">get_mae</a></span>
<span class="mkapi-dash">—</span>
Get the mae of model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.plot_filtering" title="omicverse.single.Fate.plot_filtering">plot_filtering</a></span>
<span class="mkapi-dash">—</span>
Plot the filtering result</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.plot_fitting" title="omicverse.single.Fate.plot_fitting">plot_fitting</a></span>
<span class="mkapi-dash">—</span>
Plot the fitting result</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Fate.plot_color_fitting" title="omicverse.single.Fate.plot_color_fitting">plot_color_fitting</a></span>
<span class="mkapi-dash">—</span>
Plot the colorful of clusters fitting result</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.model_init">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.model_init" title="omicverse.single.Fate.model_init">model_init</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">test_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">112</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_data_augmentation</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_strategy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'jitter_pseudotime_noise'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_intensity</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Initialize the model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">test_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the proportion of test set</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, random seed</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the regularization strength of Ridge regression</p>
</li>
<li>
<p><span class="mkapi-item-name">use_data_augmentation</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, 是否使用数据增强策略</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_strategy</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, 数据增强策略的名称，例如 'jitter_pseudotime_noise', 'gene_expression_noise', 'both', 'none'</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_intensity</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, 数据增强的强度参数，例如噪声的标准差，抖动的范围</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.Fate.model_init.res_pd_ievt">res_pd_ievt</span></span> <span class="mkapi-dash">—</span>
pd.DataFrame, the result of ridge model</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.atac_init">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.atac_init" title="omicverse.single.Fate.atac_init">atac_init</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">columns</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'neargene'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Initialize the atac model</p>
<p>if you want to use atac data to fit the model, you should use this function first</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">columns</span>
<span class="mkapi-dash">—</span>
list, the columns of atac data</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_name</span>
<span class="mkapi-dash">—</span>
str, the column name of gene name in adata.var</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_related_peak">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_related_peak" title="omicverse.single.Fate.get_related_peak">get_related_peak</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">peak</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the related peak of gene</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">peak</span>
<span class="mkapi-dash">—</span>
str, the peak name</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.ATR">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.ATR" title="omicverse.single.Fate.ATR">ATR</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">test_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">112</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">stop</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">flux</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">related</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_data_augmentation</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_strategy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'jitter_pseudotime_noise'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_intensity</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Adaptive Threshold Regression</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">test_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the proportion of test set</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, random seed</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the regularization strength of Ridge regression</p>
</li>
<li>
<p><span class="mkapi-item-name">stop</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the maximum number of iterations</p>
</li>
<li>
<p><span class="mkapi-item-name">flux</span>
<span class="mkapi-dash">—</span>
float, the flux of r2</p>
</li>
<li>
<p><span class="mkapi-item-name">related</span>
<span class="mkapi-dash">—</span>
bool, whether to use the related peak if you use atac data</p>
</li>
<li>
<p><span class="mkapi-item-name">use_data_augmentation</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, 是否使用数据增强策略</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_strategy</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, 数据增强策略的名称，例如 'jitter_pseudotime_noise', 'gene_expression_noise', 'both', 'none'</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_intensity</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, 数据增强的强度参数，例如噪声的标准差，抖动的范围</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.Fate.ATR.res_pd">res_pd</span></span> <span class="mkapi-dash">—</span>
pd.DataFrame, the result of ridge model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.model_fit">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.model_fit" title="omicverse.single.Fate.model_fit">model_fit</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">test_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">112</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">related</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_data_augmentation</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_strategy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'jitter_pseudotime_noise'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">augmentation_intensity</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Fit the model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">test_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the proportion of test set</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, random seed</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the regularization strength of Ridge regression</p>
</li>
<li>
<p><span class="mkapi-item-name">related</span>
<span class="mkapi-dash">—</span>
bool, whether to use the related peak if you use atac data</p>
</li>
<li>
<p><span class="mkapi-item-name">use_data_augmentation</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, 是否使用数据增强策略</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_strategy</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, 数据增强策略的名称，例如 'jitter_pseudotime_noise', 'gene_expression_noise', 'both', 'none'</p>
</li>
<li>
<p><span class="mkapi-item-name">augmentation_intensity</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, 数据增强的强度参数，例如噪声的标准差，抖动的范围</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.Fate.model_fit.res_pd_ievt">res_pd_ievt</span></span> <span class="mkapi-dash">—</span>
pd.DataFrame, the result of ridge model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.kendalltau_filter">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.kendalltau_filter" title="omicverse.single.Fate.kendalltau_filter">kendalltau_filter</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.low_density">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.low_density" title="omicverse.single.Fate.low_density">low_density</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_components</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">knn</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pca_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">kernel_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_Kernel'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sim_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_Similarity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eigval_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_EigenValues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eigvec_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_EigenVectors'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.lineage_score">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.lineage_score" title="omicverse.single.Fate.lineage_score">lineage_score</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lineage</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_mask</span><span class="mkapi-equal">=</span><span class="mkapi-default">'specification'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">density_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'mellon_log_density_lowd'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">localvar_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'local_variability'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expression_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'MAGIC_imputed_data'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">distances_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'distances'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_coef">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_coef" title="omicverse.single.Fate.get_coef">get_coef</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the coef of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of coef, 'raw' or 'filter'</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">coef</span> <span class="mkapi-dash">—</span>
pd.DataFrame, the coef of model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_r2">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_r2" title="omicverse.single.Fate.get_r2">get_r2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">float</span></span>
</p>
<div class="mkapi-document">
<p>Get the r2 of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of r2, 'raw' or 'filter'</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">r2</span> <span class="mkapi-dash">—</span>
float, the r2 of model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_mse">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_mse" title="omicverse.single.Fate.get_mse">get_mse</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the mse of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of mse, 'raw' or 'filter'</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">mse</span> <span class="mkapi-dash">—</span>
float, the mse of model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_rmse">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_rmse" title="omicverse.single.Fate.get_rmse">get_rmse</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the rmse of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of rmse, 'raw' or 'filter'</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">rmse</span> <span class="mkapi-dash">—</span>
float, the rmse of model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.get_mae">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.get_mae" title="omicverse.single.Fate.get_mae">get_mae</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Get the mae of model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of mae, 'raw' or 'filter'</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">mae</span> <span class="mkapi-dash">—</span>
float, the mae of model</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.plot_filtering">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.plot_filtering" title="omicverse.single.Fate.plot_filtering">plot_filtering</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#5ca8dc'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.8</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Plot the filtering result</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, the size of figure</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color of scatter</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the size of text</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the transparency of scatter</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.pyplot.figure, the figure of filtering result
ax: matplotlib.pyplot.axis, the axis of filtering result</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.plot_fitting">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.plot_fitting" title="omicverse.single.Fate.plot_fitting">plot_fitting</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#0d6a3b'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Plot the fitting result</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of fitting result, 'raw' or 'filter'</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, the size of figure</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color of scatter</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the size of text</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.pyplot.figure, the figure of fitting result
ax: matplotlib.pyplot.axis, the axis of fitting result</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Fate.plot_color_fitting">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Fate" title="omicverse.single.Fate">Fate</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Fate.plot_color_fitting" title="omicverse.single.Fate.plot_color_fitting">plot_color_fitting</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'raw'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'clusters'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#6BBBA0'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">[0.2, 0.1, 0]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">omics</span><span class="mkapi-equal">=</span><span class="mkapi-default">'RNA'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Plot the colorful of clusters fitting result</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the type of fitting result, 'raw' or 'filter'</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the key of cluster of color</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, the size of figure</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color of scatter</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the size of text</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_loc</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
list, the location of r2,mae,mse</p>
</li>
<li>
<p><span class="mkapi-item-name">omics</span>
<span class="mkapi-dash">—</span>
str, the type of omics</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.pyplot.figure, the figure of fitting result
ax: matplotlib.pyplot.axis, the axis of fitting result</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pseudotime</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_names</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize the gene_trends analysis based on pseudotime</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">pseudotime</span>
<span class="mkapi-dash">—</span>
str, the column name of pseudotime in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">var_names</span>
<span class="mkapi-dash">—</span>
list, the list of gene name to calculate</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.calculate" title="omicverse.single.gene_trends.calculate">calculate</a></span>
<span class="mkapi-dash">—</span>
Calculate the trends of gene with pseudotime</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_heatmap" title="omicverse.single.gene_trends.get_heatmap">get_heatmap</a></span>
<span class="mkapi-dash">—</span>
Get the data of heatmap of trends</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_kendalltau" title="omicverse.single.gene_trends.get_kendalltau">get_kendalltau</a></span>
<span class="mkapi-dash">—</span>
Get the kendalltau of trends</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_linregress" title="omicverse.single.gene_trends.get_linregress">get_linregress</a></span>
<span class="mkapi-dash">—</span>
Get the linregress of trends</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.cal_border_cell" title="omicverse.single.gene_trends.cal_border_cell">cal_border_cell</a></span>
<span class="mkapi-dash">—</span>
Calculate the border cell of each cluster</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_border_gene" title="omicverse.single.gene_trends.get_border_gene">get_border_gene</a></span>
<span class="mkapi-dash">—</span>
Get the border gene between two clusters</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_multi_border_gene" title="omicverse.single.gene_trends.get_multi_border_gene">get_multi_border_gene</a></span>
<span class="mkapi-dash">—</span>
Get the border gene between two clusters for all clusters</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_special_border_gene" title="omicverse.single.gene_trends.get_special_border_gene">get_special_border_gene</a></span>
<span class="mkapi-dash">—</span>
Get the special border gene between two clusters</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_kernel_gene" title="omicverse.single.gene_trends.get_kernel_gene">get_kernel_gene</a></span>
<span class="mkapi-dash">—</span>
Get the kernel gene of cluster</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_multi_kernel_gene" title="omicverse.single.gene_trends.get_multi_kernel_gene">get_multi_kernel_gene</a></span>
<span class="mkapi-dash">—</span>
Get the kernel gene of cluster for all clusters</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.get_special_kernel_gene" title="omicverse.single.gene_trends.get_special_kernel_gene">get_special_kernel_gene</a></span>
<span class="mkapi-dash">—</span>
Get the special kernel gene of cluster</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.gene_trends.plot_trend" title="omicverse.single.gene_trends.plot_trend">plot_trend</a></span>
<span class="mkapi-dash">—</span>
Plot the trends of gene with pseudotime</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.calculate">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.calculate" title="omicverse.single.gene_trends.calculate">calculate</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_convolve</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the trends of gene with pseudotime</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">n_convolve</span>
<span class="mkapi-dash">—</span>
int, the number of convolve to smooth the trends</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_heatmap" title="omicverse.single.gene_trends.get_heatmap">get_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the data of heatmap of trends</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_kendalltau">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_kendalltau" title="omicverse.single.gene_trends.get_kendalltau">get_kendalltau</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the kendalltau of trends</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_linregress">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_linregress" title="omicverse.single.gene_trends.get_linregress">get_linregress</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the linregress of trends</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.cal_border_cell">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.cal_border_cell" title="omicverse.single.gene_trends.cal_border_cell">cal_border_cell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">pseudotime</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the border cell of each cluster</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">pseudotime</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of pseudotime in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the threshold of border cell</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_border_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_border_gene" title="omicverse.single.gene_trends.get_border_gene">get_border_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the border gene between two clusters</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster1</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster1</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster2</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster2</p>
</li>
<li>
<p><span class="mkapi-item-name">num_gene</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of border gene</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float, the threshold of border gene</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.gene_trends.get_border_gene.border_gene">border_gene</span></span> <span class="mkapi-dash">—</span>
list, the list of border gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_multi_border_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_multi_border_gene" title="omicverse.single.gene_trends.get_multi_border_gene">get_multi_border_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the border gene between two clusters for all clusters</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">num_gene</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of border gene</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float, the threshold of border gene</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.gene_trends.get_multi_border_gene.border_gene_dict">border_gene_dict</span></span> <span class="mkapi-dash">—</span>
dict, the dict of border gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_special_border_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_special_border_gene" title="omicverse.single.gene_trends.get_special_border_gene">get_special_border_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the special border gene between two clusters</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster1</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster1</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster2</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster2</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">border_gene</span> <span class="mkapi-dash">—</span>
list, the list of border gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_kernel_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_kernel_gene" title="omicverse.single.gene_trends.get_kernel_gene">get_kernel_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the kernel gene of cluster</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster</p>
</li>
<li>
<p><span class="mkapi-item-name">num_gene</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of kernel gene</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float, the threshold of kernel gene</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">kernel_gene</span> <span class="mkapi-dash">—</span>
list, the list of kernel gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_multi_kernel_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_multi_kernel_gene" title="omicverse.single.gene_trends.get_multi_kernel_gene">get_multi_kernel_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the kernel gene of cluster for all clusters</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">num_gene</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of kernel gene</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float, the threshold of kernel gene</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cellfategenie.gene_trends.get_multi_kernel_gene.kernel_gene_dict">kernel_gene_dict</span></span> <span class="mkapi-dash">—</span>
dict, the dict of kernel gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.get_special_kernel_gene">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.get_special_kernel_gene" title="omicverse.single.gene_trends.get_special_kernel_gene">get_special_kernel_gene</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the special kernel gene of cluster</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the column name of cluster in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the name of cluster</p>
</li>
<li>
<p><span class="mkapi-item-name">num_gene</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the number of kernel gene</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">kernel_gene</span> <span class="mkapi-dash">—</span>
list, the list of kernel gene</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.gene_trends.plot_trend">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.gene_trends" title="omicverse.single.gene_trends">gene_trends</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.gene_trends.plot_trend" title="omicverse.single.gene_trends.plot_trend">plot_trend</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#a51616'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'pseudotime'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Genes'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot the trends of gene with pseudotime</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, the size of figure</p>
</li>
<li>
<p><span class="mkapi-item-name">max_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, the threshold of max value</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the color of scatter</p>
</li>
<li>
<p><span class="mkapi-item-name">xlabel</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the label of x axis</p>
</li>
<li>
<p><span class="mkapi-item-name">ylabel</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, the label of y axis</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, the size of text</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.pyplot.figure, the figure of trends
ax: matplotlib.pyplot.axis, the axis of trends</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.mellon_density">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.mellon_density" title="omicverse.single.mellon_density">mellon_density</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_components</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">knn</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pca_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">kernel_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_Kernel'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sim_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_Similarity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eigval_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_EigenValues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eigvec_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'DM_EigenVectors'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">neighbor_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gpu</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.check_torch" title="omicverse.single.scnocd.check_torch">check_torch</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.matrix_transform" title="omicverse.single.scnocd.matrix_transform">matrix_transform</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.matrix_normalize" title="omicverse.single.scnocd.matrix_normalize">matrix_normalize</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.GNN_configure" title="omicverse.single.scnocd.GNN_configure">GNN_configure</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.GNN_preprocess" title="omicverse.single.scnocd.GNN_preprocess">GNN_preprocess</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.get_nmi" title="omicverse.single.scnocd.get_nmi">get_nmi</a></span>
<span class="mkapi-dash">—</span>
Compute Overlapping NMI of the communities predicted by the GNN.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.save" title="omicverse.single.scnocd.save">save</a></span>
<span class="mkapi-dash">—</span>
Saves the trained GNN model and necessary metadata.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.load" title="omicverse.single.scnocd.load">load</a></span>
<span class="mkapi-dash">—</span>
Loads the trained GNN model and restores necessary metadata.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.GNN_model" title="omicverse.single.scnocd.GNN_model">GNN_model</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.GNN_result" title="omicverse.single.scnocd.GNN_result">GNN_result</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.GNN_plot" title="omicverse.single.scnocd.GNN_plot">GNN_plot</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.calculate_nocd" title="omicverse.single.scnocd.calculate_nocd">calculate_nocd</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.cal_nocd" title="omicverse.single.scnocd.cal_nocd">cal_nocd</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scnocd.get_pair_dict" title="omicverse.single.scnocd.get_pair_dict">get_pair_dict</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.check_torch">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.check_torch" title="omicverse.single.scnocd.check_torch">check_torch</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.matrix_transform">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.matrix_transform" title="omicverse.single.scnocd.matrix_transform">matrix_transform</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">clustertype</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle try">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">try</span>
</p>
<div class="mkapi-section-content">
<div class="highlight"><pre><span></span><code>self.adata.obsp['connectivities']
</code></pre></div>
<p>except NameError:
    var_exists = False
    print('......You need to calculate the neighbor by sc.pp.neighbors')
    return None
else:
    var_exists = True</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle try">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">try</span>
</p>
<div class="mkapi-section-content">
<div class="highlight"><pre><span></span><code>self.adata.obs[clustertype]
</code></pre></div>
<p>except NameError:
    var_exists = False
    print('......You need to calculate the leiden by sc.tl.leiden or other clustertype')
    return None
else:
    var_exists = True</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.matrix_normalize">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.matrix_normalize" title="omicverse.single.scnocd.matrix_normalize">matrix_normalize</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cuda</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.GNN_configure">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.GNN_configure" title="omicverse.single.scnocd.GNN_configure">GNN_configure</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">hidden_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weight_decay</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dropout</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_norm</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lr</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_epochs</span><span class="mkapi-equal">=</span><span class="mkapi-default">500</span><span class="mkapi-comma">, </span><span class="mkapi-arg">display_step</span><span class="mkapi-equal">=</span><span class="mkapi-default">25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">balance_loss</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">stochastic_loss</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">20000</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.GNN_preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.GNN_preprocess" title="omicverse.single.scnocd.GNN_preprocess">GNN_preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">num_workers</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.get_nmi">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.get_nmi" title="omicverse.single.scnocd.get_nmi">get_nmi</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">thresh</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute Overlapping NMI of the communities predicted by the GNN.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.save">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.save" title="omicverse.single.scnocd.save">save</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">gnn_save_dir</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'save_model'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gnn_save_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'gnn'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Saves the trained GNN model and necessary metadata.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">gnn_save_dir</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
the directory to save the trained GNN model. Default is 'save_model'.</p>
</li>
<li>
<p><span class="mkapi-item-name">gnn_save_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
the name of the saved GNN model. Default is 'gnn'.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.load">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.load" title="omicverse.single.scnocd.load">load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">gnn_load_dir</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Loads the trained GNN model and restores necessary metadata.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">gnn_load_dir</span>
<span class="mkapi-dash">—</span>
the directory to load the trained GNN model.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.GNN_model">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.GNN_model" title="omicverse.single.scnocd.GNN_model">GNN_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.GNN_result">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.GNN_result" title="omicverse.single.scnocd.GNN_result">GNN_result</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">thresh</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.GNN_plot">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.GNN_plot" title="omicverse.single.scnocd.GNN_plot">GNN_plot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">[10, 10]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">markersize</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.calculate_nocd">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.calculate_nocd" title="omicverse.single.scnocd.calculate_nocd">calculate_nocd</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.cal_nocd">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.cal_nocd" title="omicverse.single.scnocd.cal_nocd">cal_nocd</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scnocd.get_pair_dict">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scnocd" title="omicverse.single.scnocd">scnocd</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scnocd.get_pair_dict" title="omicverse.single.scnocd.get_pair_dict">get_pair_dict</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyCEFCON">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input_expData</span><span class="mkapi-comma">, </span><span class="mkapi-arg">input_priorNet</span><span class="mkapi-comma">, </span><span class="mkapi-arg">input_genesDE</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">additional_edges_pct</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cuda</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">2023</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hidden_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">64</span><span class="mkapi-comma">, </span><span class="mkapi-arg">heads</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">attention</span><span class="mkapi-equal">=</span><span class="mkapi-default">'COS'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">miu</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">epochs</span><span class="mkapi-equal">=</span><span class="mkapi-default">350</span><span class="mkapi-comma">, </span><span class="mkapi-arg">repeats</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_threshold_param</span><span class="mkapi-equal">=</span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">remove_self_loops</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">topK_drivers</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">solver</span><span class="mkapi-equal">=</span><span class="mkapi-default">'GUROBI'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">input_expData</span> : 
<span class="mkapi-item-type">str or <span class="mkapi-tooltip" title="scanpy">sc</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span> or <span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
input gene expression data. It can be the path to a csv file, an AnnData object, or a pandas dataframe. If the input is an AnnData object, the lineage name must be contained in AnnData.uns['lineages'], and the lineage information (can be the pseudotime, where non-NA data denotes cells in the lineage) must be contained in AnnData.obs. If no lineage information is detected, all cell expressions will be regarded as one lineage, which will be named 'all' by default.</p>
</li>
<li>
<p><span class="mkapi-item-name">input_priorNet</span> : 
<span class="mkapi-item-type">str or <span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
input prior gene interaction network. It can be the path to a csv file or a pandas dataframe</p>
</li>
<li>
<p><span class="mkapi-item-name">input_genesDE</span> : 
<span class="mkapi-item-type">str or <span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
input gene differential expression score. It can be the path to a csv file or a pandas dataframe</p>
</li>
<li>
<p><span class="mkapi-item-name">additional_edges_pct</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
proportion of high co-expression interactions to be added (default: 0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">cuda</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
an integer greater than -1 indicates the GPU device number and -1 indicates the CPU device</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
random seed (set to -1 means no random seed is assigned)</p>
</li>
<li>
<p><span class="mkapi-item-name">hidden_dim</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
hidden dimension of the GNN encoder (default: 128)</p>
</li>
<li>
<p><span class="mkapi-item-name">output_dim</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
output dimension of the GNN encoder (default: 64)</p>
</li>
<li>
<p><span class="mkapi-item-name">heads</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
number of heads for the multi-head attention (default: 4)</p>
</li>
<li>
<p><span class="mkapi-item-name">attention</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
type of attention scoring function ('COS', 'SD', 'AD') (default: 'COS')</p>
</li>
<li>
<p><span class="mkapi-item-name">miu</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
parameter (0~1) for considering the importance of attention coefficients of the first GNN layer (default: 0.5)</p>
</li>
<li>
<p><span class="mkapi-item-name">epochs</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
number of epochs for one repeat (default: 350)</p>
</li>
<li>
<p><span class="mkapi-item-name">repeats</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
number of repeats (default: 5)</p>
</li>
<li>
<p><span class="mkapi-item-name">edge_threshold_param</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
threshold for selecting top-weighted edges (larger values mean more edges). This parameter corresponds to the average degree of the constructed GRN (default: 8)</p>
</li>
<li>
<p><span class="mkapi-item-name">remove_self_loops</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
whether to remove all self-loops (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">topK_drivers</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
number of top-ranked candidate driver genes according to their influence scores (default: 100)</p>
</li>
<li>
<p><span class="mkapi-item-name">solver</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Solver ('GUROBI', 'SCIP') for solving the integer linear programming problems (for identifying drive regulators) (default: 'GUROBI')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyCEFCON.preprocess" title="omicverse.single.pyCEFCON.preprocess">preprocess</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyCEFCON.train" title="omicverse.single.pyCEFCON.train">train</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyCEFCON.predicted_driver_regulators" title="omicverse.single.pyCEFCON.predicted_driver_regulators">predicted_driver_regulators</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyCEFCON.predicted_RGM" title="omicverse.single.pyCEFCON.predicted_RGM">predicted_RGM</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyCEFCON.preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyCEFCON.preprocess" title="omicverse.single.pyCEFCON.preprocess">preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyCEFCON.train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyCEFCON.train" title="omicverse.single.pyCEFCON.train">train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyCEFCON.predicted_driver_regulators">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyCEFCON.predicted_driver_regulators" title="omicverse.single.pyCEFCON.predicted_driver_regulators">predicted_driver_regulators</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyCEFCON.predicted_RGM">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyCEFCON" title="omicverse.single.pyCEFCON">pyCEFCON</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyCEFCON.predicted_RGM" title="omicverse.single.pyCEFCON.predicted_RGM">predicted_RGM</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.convert_human_to_mouse_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.convert_human_to_mouse_network" title="omicverse.single.convert_human_to_mouse_network">convert_human_to_mouse_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">net</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">server_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'asia'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.load_human_prior_interaction_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.load_human_prior_interaction_network" title="omicverse.single.load_human_prior_interaction_network">load_human_prior_interaction_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">dataset</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'nichenet'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">only_directed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">force_download</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.mouse_hsc_nestorowa16">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.mouse_hsc_nestorowa16" title="omicverse.single.mouse_hsc_nestorowa16">mouse_hsc_nestorowa16</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">fpath</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'./data_cache/mouse_hsc_nestorowa16_v0.h5ad'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">version</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'v0'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_network_cal">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_network_cal" title="omicverse.single.cpdb_network_cal">cpdb_network_cal</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvals</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">dict</span></span>
</p>
<div class="mkapi-document">
<p>Calculate a CPDB (Cell Phone Database) network using gene expression data and return a dictionary of results.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
An AnnData object containing gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">pvals</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
A list or array of p-values for each gene in the expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The name of the cell type key in adata.obs.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._cpdb.cpdb_network_cal.cpdb_dict">cpdb_dict</span></span> <span class="mkapi-dash">—</span>
A dictionary of results generated by <code>kpy.plot_cpdb_heatmap()</code> from the <code>ktplotspy</code> library.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_plot_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_plot_network" title="omicverse.single.cpdb_plot_network">cpdb_plot_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">interaction_edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edgeswidth_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodesize_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(5, 5)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(1, 0.2)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_graph</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="networkx">nx</span>.<span class="mkapi-tooltip" title="networkx.classes.graph.Graph">Graph</span></span></span>
</p>
<div class="mkapi-document">
<p>Plot a network of interactions between cell types using gene expression data.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
An AnnData object containing gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">interaction_edges</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
A DataFrame containing the edges of the network, including the source, target, and count of interactions.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The name of the cell type key in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">nodecolor_dict</span>
<span class="mkapi-dash">—</span>
A dictionary mapping cell type names to node colors. If not provided, uses the colors specified in adata.uns.</p>
</li>
<li>
<p><span class="mkapi-item-name">edgeswidth_scale</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The scaling factor for edge width. Default is 10.</p>
</li>
<li>
<p><span class="mkapi-item-name">nodesize_scale</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The scaling factor for node size. Default is 1.</p>
</li>
<li>
<p><span class="mkapi-item-name">pos_scale</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The scaling factor for node positions. Default is 1.</p>
</li>
<li>
<p><span class="mkapi-item-name">pos_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The size of the node positions. Default is 10.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The size of the plot. Default is (5,5).</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The title of the plot. Default is ''.</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_ncol</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The number of columns in the legend. Default is 3.</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_bbox</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
The location of the legend. Default is (1,0.2).</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
The font size of the legend. Default is 10.</p>
</li>
<li>
<p><span class="mkapi-item-name">return_graph</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If True, returns the network graph. Default is False.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax or <span class="mkapi-tooltip" title="omicverse.single._cpdb.cpdb_plot_network.G">G</span></span> <span class="mkapi-dash">—</span>
The plot if <code>return_graph</code> is False, otherwise the network graph.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_plot_interaction">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_plot_interaction" title="omicverse.single.cpdb_plot_interaction">cpdb_plot_interaction</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvals</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keep_significant_only</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">highlight_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.75</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'viridis'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ytickslabel_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xtickslabel_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes">_axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span></span></span>
</p>
<div class="mkapi-document">
<p>Plot CellPhoneDB cell-cell interactions between two cell types.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type1</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of first cell type</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type2</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of second cell type</p>
</li>
<li>
<p><span class="mkapi-item-name">means</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame containing interaction means from CellPhoneDB</p>
</li>
<li>
<p><span class="mkapi-item-name">pvals</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame containing p-values from CellPhoneDB</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs containing cell type information</p>
</li>
<li>
<p><span class="mkapi-item-name">genes</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of genes to include in plot (default: None for all genes)</p>
</li>
<li>
<p><span class="mkapi-item-name">keep_significant_only</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show only significant interactions (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
Figure size (default: (4,8))</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Plot title (default: '')</p>
</li>
<li>
<p><span class="mkapi-item-name">max_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum dot size (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">highlight_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Size for highlighted interactions (default: 0.75)</p>
</li>
<li>
<p><span class="mkapi-item-name">standard_scale</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to standard scale the data (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the colormap to use (default: 'viridis')</p>
</li>
<li>
<p><span class="mkapi-item-name">ytickslabel_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Font size of the y-axis tick labels (default: 8)</p>
</li>
<li>
<p><span class="mkapi-item-name">xtickslabel_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Font size of the x-axis tick labels (default: 8)</p>
</li>
<li>
<p><span class="mkapi-item-name">title_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Font size of the title (default: 10)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="matplotlib">matplotlib</span>.<span class="mkapi-tooltip" title="matplotlib.axes">axes</span>.<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span></span> <span class="mkapi-dash">—</span>
Axes object containing the interaction plot</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_interaction_filtered">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_interaction_filtered" title="omicverse.single.cpdb_interaction_filtered">cpdb_interaction_filtered</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type1</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type2</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvals</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keep_significant_only</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0, 0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">highlight_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.75</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'viridis'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns a list of unique interaction groups from a CellPhoneDB analysis filtered by significance.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix containing normalized gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type1</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The cell type name for the first interacting partner.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type2</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The cell type name for the second interacting partner.</p>
</li>
<li>
<p><span class="mkapi-item-name">means</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Dataframe containing the means of gene expression for each interaction.</p>
</li>
<li>
<p><span class="mkapi-item-name">pvals</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Dataframe containing the p-values for each interaction.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The column name in the <code>adata.obs</code> dataframe containing cell type annotations.</p>
</li>
<li>
<p><span class="mkapi-item-name">genes</span>
<span class="mkapi-dash">—</span>
List of gene names to filter on. If None, no filtering is applied.</p>
</li>
<li>
<p><span class="mkapi-item-name">keep_significant_only</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to filter on significant interactions only (i.e. interactions with FDR &lt; 0.05).</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
Figure size. Width and height of the figure in inches.</p>
</li>
<li>
<p><span class="mkapi-item-name">max_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum size of the markers in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">highlight_size</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Size of the markers for the highlighted interaction.</p>
</li>
<li>
<p><span class="mkapi-item-name">standard_scale</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to standard scale the data.</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the colormap to use.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">genes</span> <span class="mkapi-dash">—</span>
List of unique interaction groups from a CellPhoneDB analysis filtered by significance.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_submeans_exacted">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_submeans_exacted" title="omicverse.single.cpdb_submeans_exacted">cpdb_submeans_exacted</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">means</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_names</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'ligand'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Extract subset of CellPhoneDB means DataFrame for specific cell type.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">means</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame containing interaction means from CellPhoneDB</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_names</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the cell type to extract</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Whether to extract as 'ligand' or 'receptor' (default: 'ligand')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Subset of means DataFrame for specified cell type and role</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_exact_target">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_exact_target" title="omicverse.single.cpdb_exact_target">cpdb_exact_target</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">means</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cpdb_exact_source">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cpdb_exact_source" title="omicverse.single.cpdb_exact_source">cpdb_exact_source</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">means</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.cellphonedb_v5">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.cellphonedb_v5" title="omicverse.single.cellphonedb_v5">cellphonedb_v5</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cell_fraction</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.005</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cpdb_file_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">iterations</span><span class="mkapi-equal">=</span><span class="mkapi-default">1000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threads</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temp_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cleanup_temp</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">debug</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">separator</span><span class="mkapi-equal">=</span><span class="mkapi-default">'|'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run CellPhoneDB statistical analysis with proper file handling</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">-----------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span>
<span class="mkapi-dash">—</span>
str
Column name in adata.obs containing cell type annotations</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cell_fraction</span>
<span class="mkapi-dash">—</span>
float
Minimum fraction of total cells required for a cell type to be included</p>
</li>
<li>
<p><span class="mkapi-item-name">min_genes</span>
<span class="mkapi-dash">—</span>
int
Minimum number of genes required per cell</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cells</span>
<span class="mkapi-dash">—</span>
int
Minimum number of cells required per gene</p>
</li>
<li>
<p><span class="mkapi-item-name">cpdb_file_path</span>
<span class="mkapi-dash">—</span>
str or None
Path to CellPhoneDB database zip file. If None, will try to find automatically</p>
</li>
<li>
<p><span class="mkapi-item-name">iterations</span>
<span class="mkapi-dash">—</span>
int
Number of shufflings performed in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float
Min % of cells expressing a gene for this to be employed in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue</span>
<span class="mkapi-dash">—</span>
float
P-value threshold to employ for significance</p>
</li>
<li>
<p><span class="mkapi-item-name">threads</span>
<span class="mkapi-dash">—</span>
int
Number of threads to use in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">output_dir</span>
<span class="mkapi-dash">—</span>
str or None
Directory to save results. If None, creates temporary directory</p>
</li>
<li>
<p><span class="mkapi-item-name">temp_dir</span>
<span class="mkapi-dash">—</span>
str or None
Directory for temporary files. If None, uses system temp</p>
</li>
<li>
<p><span class="mkapi-item-name">cleanup_temp</span>
<span class="mkapi-dash">—</span>
bool
Whether to clean up temporary files after analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">debug</span>
<span class="mkapi-dash">—</span>
bool
Saves all intermediate tables employed during the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">separator</span>
<span class="mkapi-dash">—</span>
str
String to employ to separate cells in the results dataframes</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
dict
Additional parameters for cpdb_statistical_analysis_method.call</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">--------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">dict</span>
<span class="mkapi-dash">—</span>
CellPhoneDB results</p>
</li>
<li>
<p><span class="mkapi-item-name">adata_cpdb</span>
<span class="mkapi-dash">—</span>
AnnData
Formatted AnnData object for visualization with CellChatViz</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">FileNotFoundError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.run_cellphonedb_v5">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.run_cellphonedb_v5" title="omicverse.single.run_cellphonedb_v5">run_cellphonedb_v5</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cpdb_file_path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cell_fraction</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.005</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">iterations</span><span class="mkapi-equal">=</span><span class="mkapi-default">1000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threads</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temp_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cleanup_temp</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">debug</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">separator</span><span class="mkapi-equal">=</span><span class="mkapi-default">'|'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run CellPhoneDB statistical analysis with automatic database download</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">-----------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">cpdb_file_path</span>
<span class="mkapi-dash">—</span>
str
Path to CellPhoneDB database zip file (REQUIRED)
If file doesn't exist, will attempt automatic download</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span>
<span class="mkapi-dash">—</span>
str
Column name in adata.obs containing cell type annotations</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cell_fraction</span>
<span class="mkapi-dash">—</span>
float
Minimum fraction of total cells required for a cell type to be included</p>
</li>
<li>
<p><span class="mkapi-item-name">min_genes</span>
<span class="mkapi-dash">—</span>
int
Minimum number of genes required per cell</p>
</li>
<li>
<p><span class="mkapi-item-name">min_cells</span>
<span class="mkapi-dash">—</span>
int
Minimum number of cells required per gene</p>
</li>
<li>
<p><span class="mkapi-item-name">iterations</span>
<span class="mkapi-dash">—</span>
int
Number of shufflings performed in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float
Min % of cells expressing a gene for this to be employed in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue</span>
<span class="mkapi-dash">—</span>
float
P-value threshold to employ for significance</p>
</li>
<li>
<p><span class="mkapi-item-name">threads</span>
<span class="mkapi-dash">—</span>
int
Number of threads to use in the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">output_dir</span>
<span class="mkapi-dash">—</span>
str or None
Directory to save results. If None, creates temporary directory</p>
</li>
<li>
<p><span class="mkapi-item-name">temp_dir</span>
<span class="mkapi-dash">—</span>
str or None
Directory for temporary files. If None, uses system temp</p>
</li>
<li>
<p><span class="mkapi-item-name">cleanup_temp</span>
<span class="mkapi-dash">—</span>
bool
Whether to clean up temporary files after analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">debug</span>
<span class="mkapi-dash">—</span>
bool
Saves all intermediate tables employed during the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">separator</span>
<span class="mkapi-dash">—</span>
str
String to employ to separate cells in the results dataframes</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
dict
Additional parameters for cpdb_statistical_analysis_method.call</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">--------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">dict</span>
<span class="mkapi-dash">—</span>
CellPhoneDB results</p>
</li>
<li>
<p><span class="mkapi-item-name">adata_cpdb</span>
<span class="mkapi-dash">—</span>
AnnData
Formatted AnnData object for visualization with CellChatViz</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span></p>
</li>
<li>
<p><span class="mkapi-item-name">--------</span></p>
</li>
<li>
<p><span class="mkapi-item-name"># Basic usage - will download database automatically if needed</span></p>
</li>
<li>
<p><span class="mkapi-item-name">cpdb_results, adata_cpdb = run_cellphonedb_analysis(</span>
<span class="mkapi-dash">—</span>
adata, 
cpdb_file_path='./cellphonedb.zip',
celltype_key='celltype_minor'</p>
</li>
<li>
<p><span class="mkapi-item-name">)</span></p>
</li>
</ul>
</div>
<div class="mkapi-section-content">
<h1 id="advanced-usage">Advanced usage<a class="headerlink" href="#advanced-usage" title="Permanent link">¶</a></h1>
<p>cpdb_results, adata_cpdb = run_cellphonedb_analysis(
    adata,
    cpdb_file_path='/path/to/cellphonedb.zip',
    celltype_key='celltype_minor',
    min_cell_fraction=0.01,
    iterations=2000,
    threads=20
)</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.geneset_aucell">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.geneset_aucell" title="omicverse.single.geneset_aucell">geneset_aucell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">geneset_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">geneset</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the AUC-ell score for a given gene set.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">geneset_name</span>
<span class="mkapi-dash">—</span>
Name of the gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name">geneset</span>
<span class="mkapi-dash">—</span>
List of gene symbols for the gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
AUC threshold used to determine significant interactions. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
Seed used to initialize the random number generator. (42)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
Adds a column to the 'obs' attribute of the adata object containing the AUC-ell score for the gene set.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_aucell">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_aucell" title="omicverse.single.pathway_aucell">pathway_aucell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathway_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the area under the curve (AUC) for a set of pathways in an AnnData object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing the data.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathway_names</span>
<span class="mkapi-dash">—</span>
Names of the pathways to analyze.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways_dict</span>
<span class="mkapi-dash">—</span>
Dictionary containing the gene sets for each pathway.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
AUC threshold to use for determining significant gene-pathway associations. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
Random seed for reproducibility. (42)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function modifies the <code>adata.obs</code> attribute of the input AnnData object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_aucell_enrichment">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_aucell_enrichment" title="omicverse.single.pathway_aucell_enrichment">pathway_aucell_enrichment</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_workers</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Enrich cell annotations with pathway activity scores using the AUC-ell method.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing the expression matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways_dict</span>
<span class="mkapi-dash">—</span>
A dictionary where keys are pathway names and values are lists of genes associated with each pathway.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
The threshold for calculating the area under the curve (AUC) values using the AUC-ell method. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
The seed to use for the random number generator. (42)</p>
</li>
<li>
<p><span class="mkapi-item-name">num_workers</span>
<span class="mkapi-dash">—</span>
The number of workers to use for parallel processing. (1)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._scgsea.pathway_aucell_enrichment.adata_aucs">adata_aucs</span></span> <span class="mkapi-dash">—</span>
AnnData object containing the pathway activity scores for each cell in the input AnnData object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.geneset_aucell_tmp">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.geneset_aucell_tmp" title="omicverse.single.geneset_aucell_tmp">geneset_aucell_tmp</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">geneset_name</span><span class="mkapi-comma">, </span><span class="mkapi-arg">geneset</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-arg">chunk_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">10000</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the AUC-ell score for a given gene set.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">geneset_name</span>
<span class="mkapi-dash">—</span>
Name of the gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name">geneset</span>
<span class="mkapi-dash">—</span>
List of gene symbols for the gene set.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
AUC threshold used to determine significant interactions. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
Seed used to initialize the random number generator. (42)</p>
</li>
<li>
<p><span class="mkapi-item-name">chunk_size</span>
<span class="mkapi-dash">—</span>
The number of cells to process in each chunk. (10000)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
Adds a column to the 'obs' attribute of the adata object containing the AUC-ell score for the gene set.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_aucell_tmp">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_aucell_tmp" title="omicverse.single.pathway_aucell_tmp">pathway_aucell_tmp</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathway_names</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-arg">chunk_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">10000</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the area under the curve (AUC) for a set of pathways in an AnnData object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing the data.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathway_names</span>
<span class="mkapi-dash">—</span>
Names of the pathways to analyze.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways_dict</span>
<span class="mkapi-dash">—</span>
Dictionary containing the gene sets for each pathway.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
AUC threshold to use for determining significant gene-pathway associations. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
Random seed for reproducibility. (42)</p>
</li>
<li>
<p><span class="mkapi-item-name">chunk_size</span>
<span class="mkapi-dash">—</span>
The number of cells to process in each chunk. (10000)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function modifies the <code>adata.obs</code> attribute of the input AnnData object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_aucell_enrichment_tmp">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_aucell_enrichment_tmp" title="omicverse.single.pathway_aucell_enrichment_tmp">pathway_aucell_enrichment_tmp</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">AUC_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_workers</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">chunk_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">10000</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Enrich cell annotations with pathway activity scores using the AUC-ell method.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing the expression matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways_dict</span>
<span class="mkapi-dash">—</span>
A dictionary where keys are pathway names and values are lists of genes associated with each pathway.</p>
</li>
<li>
<p><span class="mkapi-item-name">AUC_threshold</span>
<span class="mkapi-dash">—</span>
The threshold for calculating the area under the curve (AUC) values using the AUC-ell method. (0.01)</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span>
<span class="mkapi-dash">—</span>
The seed to use for the random number generator. (42)</p>
</li>
<li>
<p><span class="mkapi-item-name">num_workers</span>
<span class="mkapi-dash">—</span>
The number of workers to use for parallel processing. (1)</p>
</li>
<li>
<p><span class="mkapi-item-name">chunk_size</span>
<span class="mkapi-dash">—</span>
The number of cells to process in each chunk. (10000)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._scgsea.pathway_aucell_enrichment_tmp.adata_aucs">adata_aucs</span></span> <span class="mkapi-dash">—</span>
AnnData object containing the pathway activity scores for each cell in the input AnnData object.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_enrichment">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_enrichment" title="omicverse.single.pathway_enrichment">pathway_enrichment</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">organism</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group_by</span><span class="mkapi-equal">=</span><span class="mkapi-default">'louvain'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cutoff</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">logfc_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'adjust'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Perform pathway enrichment analysis on gene expression data.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix containing gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways_dict</span>
<span class="mkapi-dash">—</span>
A dictionary of gene sets with their gene members.</p>
</li>
<li>
<p><span class="mkapi-item-name">organism</span>
<span class="mkapi-dash">—</span>
The organism to be used for the enrichment analysis. Can be either 'Human' or 'Mouse'. ('Human')</p>
</li>
<li>
<p><span class="mkapi-item-name">group_by</span>
<span class="mkapi-dash">—</span>
The group label of the cells in adata.obs to perform the enrichment analysis on. ('louvain')</p>
</li>
<li>
<p><span class="mkapi-item-name">cutoff</span>
<span class="mkapi-dash">—</span>
The adjusted p-value cutoff used to filter enriched pathways. (0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">logfc_threshold</span>
<span class="mkapi-dash">—</span>
The log2 fold change cutoff used to define differentially expressed genes. (2)</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue_type</span>
<span class="mkapi-dash">—</span>
The type of p-value used for filtering enriched pathways. Can be either 'adjust' or 'raw'. ('adjust')</p>
</li>
<li>
<p><span class="mkapi-item-name">plot</span>
<span class="mkapi-dash">—</span>
If True, generate a bar plot for each cluster of enriched pathways. (True)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._scgsea.pathway_enrichment.enrich_res">enrich_res</span></span> <span class="mkapi-dash">—</span>
A pandas dataframe containing the enriched pathways information including term name, p-value, adjusted p-value, overlap genes, odds ratio, log2 fold change, and cluster name.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="c1"># Perform pathway enrichment analysis on adata using pathways_dict</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">pathway_enrichment</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">pathways_dict</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle reference">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Reference</span>
</p>
<div class="mkapi-section-content">
<p>The code for pathway_enrichment() function was adapted from scanpy workflows: 
https://scanpy-tutorials.readthedocs.io/en/latest/pbmc3k.html#Gene-set-enrichment-analysis.</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pathway_enrichment_plot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pathway_enrichment_plot" title="omicverse.single.pathway_enrichment_plot">pathway_enrichment_plot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">enrich_res</span><span class="mkapi-comma">, </span><span class="mkapi-arg">term_num</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_table</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(3, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_title</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwds</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Visualize the pathway enrichment analysis results as a heatmap.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">enrich_res</span>
<span class="mkapi-dash">—</span>
The output from the pathway_enrichment() function.</p>
</li>
<li>
<p><span class="mkapi-item-name">term_num</span>
<span class="mkapi-dash">—</span>
The number of enriched terms to display for each cluster. (5)</p>
</li>
<li>
<p><span class="mkapi-item-name">return_table</span>
<span class="mkapi-dash">—</span>
Whether to return the heatmap table as a DataFrame. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
The size of the plot. ((3,10))</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_title</span>
<span class="mkapi-dash">—</span>
The title of the plot. ('')</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwds</span>
<span class="mkapi-dash">—</span>
Other keyword arguments to pass to the seaborn heatmap function.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax</span> <span class="mkapi-dash">—</span>
The heatmap plot.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">pathway_enrichment</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">pathways_dict</span><span class="p">)</span>
<span class="n">pathway_enrichment_plot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">term_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_table</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Blues'</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.autoResolution">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.autoResolution" title="omicverse.single.autoResolution">autoResolution</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cpus</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Automatically determine clustering resolution.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
The single cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name">cpus</span>
<span class="mkapi-dash">—</span>
The number of cpus used for parallel computing. (4)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
The single cell data with the clustering resolution.
res: The clustering resolution.
df_sil: The silhouette score of each clustering resolution.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.writeGEP">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.writeGEP" title="omicverse.single.writeGEP">writeGEP</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata_GEP</span><span class="mkapi-comma">, </span><span class="mkapi-arg">path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Write the gene expression profile to a file.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata_GEP</span>
<span class="mkapi-dash">—</span>
The single cell data with gene expression profile.</p>
</li>
<li>
<p><span class="mkapi-item-name">path</span>
<span class="mkapi-dash">—</span>
The path to save the gene expression profile.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scriptpath</span><span class="mkapi-comma">, </span><span class="mkapi-arg">modelpath</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output</span><span class="mkapi-equal">=</span><span class="mkapi-default">'./'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'GDSC'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clusters</span><span class="mkapi-equal">=</span><span class="mkapi-default">'All'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell</span><span class="mkapi-equal">=</span><span class="mkapi-default">'A549'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cpus</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_drugs</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Drug_Response class for drug response prediction.
The raw code could be found at https://github.com/ailabstw/scDrug</p>
<p>Initialize the Drug_Response class.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix with cells as rows and genes as columns.</p>
</li>
<li>
<p><span class="mkapi-item-name">scriptpath</span>
<span class="mkapi-dash">—</span>
Path to the directory containing the CaDRReS scripts for the analysis. You need to download the scripts according to <code>git clone https://github.com/CSB5/CaDRReS-Sc.git</code> and set the path to the directory.</p>
</li>
<li>
<p><span class="mkapi-item-name">modelpath</span>
<span class="mkapi-dash">—</span>
Path to the directory containing the pre-trained models. You need to download the models according to <code>Pyomic.utils.download_GDSC_data()</code> and <code>Pyomic.utils.download_CaDRReS_model()</code> and set the path to the directory.</p>
</li>
<li>
<p><span class="mkapi-item-name">output</span>
<span class="mkapi-dash">—</span>
Path to the directory where the output files will be saved. ('./')</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span>
<span class="mkapi-dash">—</span>
The name of the pre-trained model to be used for the analysis. ('GDSC')</p>
</li>
<li>
<p><span class="mkapi-item-name">clusters</span>
<span class="mkapi-dash">—</span>
The cluster labels to be used for the analysis. Default is all cells. ('All')</p>
</li>
<li>
<p><span class="mkapi-item-name">cell</span>
<span class="mkapi-dash">—</span>
The cell line to be analyzed. ('A549')</p>
</li>
<li>
<p><span class="mkapi-item-name">cpus</span>
<span class="mkapi-dash">—</span>
The number of CPUs to be used for the analysis. (4)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_drugs</span>
<span class="mkapi-dash">—</span>
The number of top drugs to be selected based on the predicted sensitivity. (10)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.load_model" title="omicverse.single.Drug_Response.load_model">load_model</a></span>
<span class="mkapi-dash">—</span>
Load the pre-trained model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.drug_info" title="omicverse.single.Drug_Response.drug_info">drug_info</a></span>
<span class="mkapi-dash">—</span>
read the drug information.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.bulk_exp" title="omicverse.single.Drug_Response.bulk_exp">bulk_exp</a></span>
<span class="mkapi-dash">—</span>
extract the bulk gene expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.sc_exp" title="omicverse.single.Drug_Response.sc_exp">sc_exp</a></span>
<span class="mkapi-dash">—</span>
Load cluster-specific gene expression profile</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.kernel_feature_preparartion" title="omicverse.single.Drug_Response.kernel_feature_preparartion">kernel_feature_preparartion</a></span>
<span class="mkapi-dash">—</span>
kernel feature preparation</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.sensitivity_prediction" title="omicverse.single.Drug_Response.sensitivity_prediction">sensitivity_prediction</a></span>
<span class="mkapi-dash">—</span>
Predict drug sensitivity</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.cell_death_proportion" title="omicverse.single.Drug_Response.cell_death_proportion">cell_death_proportion</a></span>
<span class="mkapi-dash">—</span>
Predict cell death proportion and cell death percentage at the ref_type dosage</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.output_result" title="omicverse.single.Drug_Response.output_result">output_result</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.draw_plot" title="omicverse.single.Drug_Response.draw_plot">draw_plot</a></span>
<span class="mkapi-dash">—</span>
plot heatmap of drug response prediction</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Drug_Response.figure_output" title="omicverse.single.Drug_Response.figure_output">figure_output</a></span>
<span class="mkapi-dash">—</span>
plot figures</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.load_model">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.load_model" title="omicverse.single.Drug_Response.load_model">load_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load the pre-trained model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.drug_info">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.drug_info" title="omicverse.single.Drug_Response.drug_info">drug_info</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>read the drug information.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.bulk_exp">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.bulk_exp" title="omicverse.single.Drug_Response.bulk_exp">bulk_exp</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>extract the bulk gene expression data.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.sc_exp">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.sc_exp" title="omicverse.single.Drug_Response.sc_exp">sc_exp</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load cluster-specific gene expression profile</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.kernel_feature_preparartion">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.kernel_feature_preparartion" title="omicverse.single.Drug_Response.kernel_feature_preparartion">kernel_feature_preparartion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>kernel feature preparation</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.sensitivity_prediction">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.sensitivity_prediction" title="omicverse.single.Drug_Response.sensitivity_prediction">sensitivity_prediction</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Predict drug sensitivity</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.cell_death_proportion">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.cell_death_proportion" title="omicverse.single.Drug_Response.cell_death_proportion">cell_death_proportion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Predict cell death proportion and cell death percentage at the ref_type dosage</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.output_result">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.output_result" title="omicverse.single.Drug_Response.output_result">output_result</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.draw_plot">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.draw_plot" title="omicverse.single.Drug_Response.draw_plot">draw_plot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">df</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_drug</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">name</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">()</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>plot heatmap of drug response prediction</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">df</span>
<span class="mkapi-dash">—</span>
<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame"><code>pandas.DataFrame</code></span> drug response prediction dataframe</p>
</li>
<li>
<p><span class="mkapi-item-name">n_drug</span>
<span class="mkapi-dash">—</span>
<code>int</code> number of drugs to be plotted</p>
</li>
<li>
<p><span class="mkapi-item-name">name</span>
<span class="mkapi-dash">—</span>
<code>str</code> name of the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
<code>tuple</code> size of the plot</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Drug_Response.figure_output">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Drug_Response" title="omicverse.single.Drug_Response">Drug_Response</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Drug_Response.figure_output" title="omicverse.single.Drug_Response.figure_output">figure_output</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>plot figures</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">device</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cuda:0'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.prepare_VAE" title="omicverse.single.scDiffusion.prepare_VAE">prepare_VAE</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.train_VAE" title="omicverse.single.scDiffusion.train_VAE">train_VAE</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.train_cellmodel" title="omicverse.single.scDiffusion.train_cellmodel">train_cellmodel</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.train_classifier" title="omicverse.single.scDiffusion.train_classifier">train_classifier</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.load_VAE" title="omicverse.single.scDiffusion.load_VAE">load_VAE</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.generate_cell" title="omicverse.single.scDiffusion.generate_cell">generate_cell</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.scDiffusion.generate_classifier" title="omicverse.single.scDiffusion.generate_classifier">generate_classifier</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.prepare_VAE">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.prepare_VAE" title="omicverse.single.scDiffusion.prepare_VAE">prepare_VAE</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">state_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">18996</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">1234</span><span class="mkapi-comma">, </span><span class="mkapi-arg">loss_ae</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">decoder_activation</span><span class="mkapi-equal">=</span><span class="mkapi-default">'ReLU'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.train_VAE">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.train_VAE" title="omicverse.single.scDiffusion.train_VAE">train_VAE</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">state_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">loss_ae</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">decoder_activation</span><span class="mkapi-equal">=</span><span class="mkapi-default">'ReLU'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">local_rank</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">split_seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">1234</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">18996</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">1234</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hparams</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">200000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_minutes</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">checkpoint_freq</span><span class="mkapi-equal">=</span><span class="mkapi-default">50000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sweep_seeds</span><span class="mkapi-equal">=</span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_model</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.train_cellmodel">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.train_cellmodel" title="omicverse.single.scDiffusion.train_cellmodel">train_cellmodel</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">schedule_sampler</span><span class="mkapi-equal">=</span><span class="mkapi-default">'uniform'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lr</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.0001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weight_decay</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.0001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lr_anneal_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">500000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">microbatch</span><span class="mkapi-equal">=</span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ema_rate</span><span class="mkapi-equal">=</span><span class="mkapi-default">'0.9999'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log_interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">200000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">resume_checkpoint</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_fp16</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fp16_scale_growth</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vae_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/Autoencoder_checkpoint/muris_AE/model_seed=0_step=0.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'muris_diffusion'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/diffusion_checkpoint'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.train_classifier">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.train_classifier" title="omicverse.single.scDiffusion.train_classifier">train_classifier</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'classifier_muris'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/classifier_checkpoint/classifier_muris'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">noised</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">resume_checkpoint</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_fp16</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vae_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/Autoencoder_checkpoint/muris_AE/model_seed=0_step=0.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">val_adata</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">input_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">lr</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.0003</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weight_decay</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start_guide_time</span><span class="mkapi-equal">=</span><span class="mkapi-default">500</span><span class="mkapi-comma">, </span><span class="mkapi-arg">microbatch</span><span class="mkapi-equal">=</span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/classifier_checkpoint/classifier_muris'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">iterations</span><span class="mkapi-equal">=</span><span class="mkapi-default">500000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log_interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eval_interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">100000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">anneal_lr</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_class</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">schedule_sampler</span><span class="mkapi-equal">=</span><span class="mkapi-default">'uniform'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.load_VAE">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.load_VAE" title="omicverse.single.scDiffusion.load_VAE">load_VAE</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">vae_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/checkpoint/AE/open_problem/model_seed=1234_step=150000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">loss_ae</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">decoder_activation</span><span class="mkapi-equal">=</span><span class="mkapi-default">'ReLU'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.generate_cell">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.generate_cell" title="omicverse.single.scDiffusion.generate_cell">generate_cell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clip_denoised</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_samples</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_ddim</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/diffusion_checkpoint/muris_diffusion/model600000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vae_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/Autoencoder_checkpoint/muris_AE/model_seed=0_step=0.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/simulated_samples/muris'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">loss_ae</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">decoder_activation</span><span class="mkapi-equal">=</span><span class="mkapi-default">'ReLU'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.scDiffusion.generate_classifier">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.scDiffusion" title="omicverse.single.scDiffusion">scDiffusion</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.scDiffusion.generate_classifier" title="omicverse.single.scDiffusion.generate_classifier">generate_classifier</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">[0]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">multi</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">inter</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weight</span><span class="mkapi-equal">=</span><span class="mkapi-default">[10, 10]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">input_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">128</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hidden_dim</span><span class="mkapi-equal">=</span><span class="mkapi-default">[512, 512, 256, 128]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dropout</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clip_denoised</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_samples</span><span class="mkapi-equal">=</span><span class="mkapi-default">9000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_ddim</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">class_cond</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">loss_ae</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mse'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">decoder_activation</span><span class="mkapi-equal">=</span><span class="mkapi-default">'ReLU'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/diffusion_checkpoint/muris_diffusion/model000000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">classifier_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/classifier_checkpoint/classifier_muris/model000100.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">classifier_path1</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/classifier_checkpoint/classifier_muris_ood_type/model200000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">classifier_path2</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/classifier_checkpoint/classifier_muris_ood_organ/model200000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_class1</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_class2</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">classifier_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vae_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'output/Autoencoder_checkpoint/WOT/model_seed=0_step=150000.pt'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_gene</span><span class="mkapi-equal">=</span><span class="mkapi-default">19423</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_class</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">init_time</span><span class="mkapi-equal">=</span><span class="mkapi-default">600</span><span class="mkapi-comma">, </span><span class="mkapi-arg">init_cell_adata</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">f'output/simulated_samples/muris'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start_guide_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">500</span><span class="mkapi-comma">, </span><span class="mkapi-arg">filter</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.atac_concat_get_index">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.atac_concat_get_index" title="omicverse.single.atac_concat_get_index">atac_concat_get_index</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata2</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.atac_concat_inner">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.atac_concat_inner" title="omicverse.single.atac_concat_inner">atac_concat_inner</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pair_index</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.atac_concat_outer">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.atac_concat_outer" title="omicverse.single.atac_concat_outer">atac_concat_outer</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pair_index</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.batch_correction">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.batch_correction" title="omicverse.single.batch_correction">batch_correction</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scaled|original|X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">methods</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'harmony'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span></span>
</p>
<div class="mkapi-document">
<p>Batch correction for single-cell data</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
batch key</p>
</li>
<li>
<p><span class="mkapi-item-name">methods</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
harmony,combat,scanorama</p>
</li>
<li>
<p><span class="mkapi-item-name">n_pcs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
number of PCs</p>
</li>
<li>
<p><span class="mkapi-item-name">kwargs</span>
<span class="mkapi-dash">—</span>
other parameters for harmony<code>harmonypy.run_harmony()</code>,combat<code>sc.pp.combat()</code>,scanorama<code>scanorama.integrate_scanpy()</code></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.single._batch.batch_correction.adata">adata</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.SCCAF_assessment">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.SCCAF_assessment" title="omicverse.single.SCCAF_assessment">SCCAF_assessment</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">*</span><span class="mkapi-arg">args</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Assessment of clustering reliability using self-projection.
It is the same as the self_projection function.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_roc">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_roc" title="omicverse.single.plot_roc">plot_roc</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">y_prob</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_test</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clf</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot</span><span class="mkapi-equal">=</span><span class="mkapi-default">'both'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cvsm</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">acc</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">13</span><span class="mkapi-comma">, </span><span class="mkapi-arg">axes</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>y_prob, y_test, clf, plot=True, save=False, title ='', colors=None, cvsm=None, acc=None, fontsize=16):</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.SCCAF_optimize_all">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.SCCAF_optimize_all" title="omicverse.single.SCCAF_optimize_all">SCCAF_optimize_all</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ad</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_acc</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.9</span><span class="mkapi-comma">, </span><span class="mkapi-arg">R1norm_cutoff</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">R2norm_cutoff</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">R1norm_step</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">R2norm_step</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">prefix</span><span class="mkapi-equal">=</span><span class="mkapi-default">'L1'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_i</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start_iter</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">iters</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-arg">args</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>ad: <code>AnnData</code>
    The AnnData object of the expression profile.
min_acc: <code>float</code> optional (default: 0.9)
    The minimum self-projection accuracy to be optimized for.
    e.g., 0.9 means the clustering optimization (merging process)
    will not stop until the self-projection accuracy is above 90%.
R1norm_cutoff: <code>float</code> optional (default: 0.5)
    The start cutoff for R1norm of confusion matrix.
    e.g., 0.5 means use 0.5 as a cutoff to discretize the confusion matrix after R1norm.
    the discretized matrix is used to construct the connection graph for clustering optimization.
R2norm_cutoff: <code>float</code> optional (default: 0.05)
    The start cutoff for R2norm of confusion matrix.
R1norm_step: <code>float</code> optional (default: 0.01)
    The reduce step for minimum R1norm value.
    Each round of optimization calls the function <span class="mkapi-tooltip" title="omicverse.single._sccaf.SCCAF_optimize"><code>SCCAF_optimize</code></span>.
    The start of the next round of optimization is based on a new
    cutoff for the R1norm of the confusion matrix. This cutoff is
    determined by the minimum R1norm value in the previous round minus the R1norm_step value.
R2norm_step: <code>float</code> optional (default: 0.001)
    The reduce step for minimum R2norm value.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_metacells</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_gpu</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_waypoint_eigs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">convergence_epsilon</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">l2_penalty</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_franke_wolfe_iters</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sparse</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Initialize MetaCell object for constructing metacells using SEACells.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obsm for representation used to compute kernel (e.g., 'X_pca')</p>
</li>
<li>
<p><span class="mkapi-item-name">n_metacells</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of metacells to compute (default: None, auto-computed as n_cells//75)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_gpu</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use GPU for computation (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">verbose</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show progress information (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_waypoint_eigs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of eigenvectors for waypoint initialization (default: 10)</p>
</li>
<li>
<p><span class="mkapi-item-name">n_neighbors</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of nearest neighbors for graph construction (default: 15)</p>
</li>
<li>
<p><span class="mkapi-item-name">convergence_epsilon</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Convergence threshold for Franke-Wolfe algorithm (default: 1e-3)</p>
</li>
<li>
<p><span class="mkapi-item-name">l2_penalty</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
L2 penalty for Franke-Wolfe algorithm (default: 0)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_franke_wolfe_iters</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum iterations for Franke-Wolfe algorithm (default: 50)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_sparse</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use sparse matrix operations (default: False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.initialize_archetypes" title="omicverse.single.MetaCell.initialize_archetypes">initialize_archetypes</a></span>
<span class="mkapi-dash">—</span>
Initialize metacell archetypes for SEACells algorithm.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.train" title="omicverse.single.MetaCell.train">train</a></span>
<span class="mkapi-dash">—</span>
Train the SEACells model to learn metacell assignments.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.predicted" title="omicverse.single.MetaCell.predicted">predicted</a></span>
<span class="mkapi-dash">—</span>
Generate metacell summary from trained SEACells model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.save" title="omicverse.single.MetaCell.save">save</a></span>
<span class="mkapi-dash">—</span>
Save the trained SEACells model to disk.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.load" title="omicverse.single.MetaCell.load">load</a></span>
<span class="mkapi-dash">—</span>
Load a pre-trained SEACells model from disk.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.step" title="omicverse.single.MetaCell.step">step</a></span>
<span class="mkapi-dash">—</span>
Run additional training iterations step-wise.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.compute_celltype_purity" title="omicverse.single.MetaCell.compute_celltype_purity">compute_celltype_purity</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.separation" title="omicverse.single.MetaCell.separation">separation</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.MetaCell.compactness" title="omicverse.single.MetaCell.compactness">compactness</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.initialize_archetypes">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.initialize_archetypes" title="omicverse.single.MetaCell.initialize_archetypes">initialize_archetypes</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Initialize metacell archetypes for SEACells algorithm.</p>
<p>This method constructs the kernel matrix and initializes archetype positions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to initialize_archetypes method</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.train" title="omicverse.single.MetaCell.train">train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">min_iter</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_iter</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Train the SEACells model to learn metacell assignments.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">min_iter</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Minimum number of training iterations (default: 10)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_iter</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Maximum number of training iterations (default: 50)</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to the fit method</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.predicted">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.predicted" title="omicverse.single.MetaCell.predicted">predicted</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'soft'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_label</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">summarize_layer</span><span class="mkapi-equal">=</span><span class="mkapi-default">'raw'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">minimum_weight</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate metacell summary from trained SEACells model.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Summarization method - 'soft' or 'hard' (default: 'soft')
celltype_label (str): Key in adata.obs containing cell type information (default: 'celltype')
summarize_layer (str): Layer to summarize for gene expression (default: 'raw')
minimum_weight (float): Minimum weight threshold for soft assignment (default: 0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
AnnData: Metacell AnnData object with summarized gene expression</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.save">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.save" title="omicverse.single.MetaCell.save">save</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'seacells/model.pkl'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Save the trained SEACells model to disk.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to save the model file (default: 'seacells/model.pkl')</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.load">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.load" title="omicverse.single.MetaCell.load">load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'seacells/model.pkl'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load a pre-trained SEACells model from disk.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model_path</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Path to the model file (default: 'seacells/model.pkl')</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.step">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.step" title="omicverse.single.MetaCell.step">step</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_steps</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run additional training iterations step-wise.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">n_steps</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of additional training steps to run (default: 5)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.compute_celltype_purity">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.compute_celltype_purity" title="omicverse.single.MetaCell.compute_celltype_purity">compute_celltype_purity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">celltype_label</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.separation">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.separation" title="omicverse.single.MetaCell.separation">separation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nth_nbr</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.MetaCell.compactness">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.MetaCell" title="omicverse.single.MetaCell">MetaCell</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.MetaCell.compactness" title="omicverse.single.MetaCell.compactness">compactness</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_metacells">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_metacells" title="omicverse.single.plot_metacells">plot_metacells</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">metacells_ad</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'#1f77b4'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edgecolors</span><span class="mkapi-equal">=</span><span class="mkapi-default">'b'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidths</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.6</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot metacells on an existing axis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
Matplotlib axis object for plotting
metacells_ad: AnnData object containing metacell data
use_rep (str): Representation to use for coordinates (default: 'X_umap')
color (str): Color for metacell points (default: '#1f77b4')
size (int): Size of metacell points (default: 15)
edgecolors (str): Edge color for points (default: 'b')
linewidths (float): Line width for point edges (default: 0.6)
alpha (float): Transparency of points (default: 1)
**kwargs: Additional arguments passed to scatter plot</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
matplotlib.axes.Axes: The modified axis object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.get_obs_value">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.get_obs_value" title="omicverse.single.get_obs_value">get_obs_value</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ad</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'int'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Transfer observation values from single-cell to metacell data.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ad</span>
<span class="mkapi-dash">—</span>
Metacell AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Original single-cell AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Column name in adata.obs to transfer</p>
</li>
<li>
<p><span class="mkapi-item-name">type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Aggregation method - 'str', 'int', 'max', 'mean', 'min' (default: 'int')</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DCT">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.DCT" title="omicverse.single.DCT">DCT</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">condition</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ctrl_group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">test_group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'sccoda'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Init the differential cell type abundance analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing the single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">condition</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The column name in adata.obs containing condition information</p>
</li>
<li>
<p><span class="mkapi-item-name">ctrl_group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The control group name in the condition column</p>
</li>
<li>
<p><span class="mkapi-item-name">test_group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The test group name in the condition column</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The column name in adata.obs containing cell type information</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Method for differential abundance analysis, either 'sccoda' or 'milo'</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
The column name in adata.obs containing sample information</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span>
<span class="mkapi-dash">—</span>
The representation in adata.obsm to use for Milo analysis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DCT.run" title="omicverse.single.DCT.run">run</a></span>
<span class="mkapi-dash">—</span>
Run the differential cell type abundance analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DCT.get_results" title="omicverse.single.DCT.get_results">get_results</a></span>
<span class="mkapi-dash">—</span>
Get the results of the differential cell type abundance analysis</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DCT.run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.DCT" title="omicverse.single.DCT">DCT</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.DCT.run" title="omicverse.single.DCT.run">run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run the differential cell type abundance analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments to pass to the differential abundance method</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DCT.get_results">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.DCT" title="omicverse.single.DCT">DCT</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.DCT.get_results" title="omicverse.single.DCT.get_results">get_results</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mix_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.6</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the results of the differential cell type abundance analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">mix_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
The threshold for determining mixed neighborhoods in Milo analysis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">DataFrame</span> <span class="mkapi-dash">—</span>
Results of the differential abundance analysis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DEG">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.DEG" title="omicverse.single.DEG">DEG</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">condition</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ctrl_group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">test_group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'wilcoxon'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Init the differential expression gene analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing the single-cell data</p>
</li>
<li>
<p><span class="mkapi-item-name">condition</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The column name in adata.obs containing condition information</p>
</li>
<li>
<p><span class="mkapi-item-name">ctrl_group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The control group name in the condition column</p>
</li>
<li>
<p><span class="mkapi-item-name">test_group</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The test group name in the condition column</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Method for differential expression analysis, either 'wilcoxon', 't-test', or 'memento-de'</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use adata.raw for DEG analysis. If None, will auto-detect (use raw if it exists)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DEG.run" title="omicverse.single.DEG.run">run</a></span>
<span class="mkapi-dash">—</span>
Run the differential expression analysis</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.DEG.get_results" title="omicverse.single.DEG.get_results">get_results</a></span>
<span class="mkapi-dash">—</span>
Get the results of the differential expression analysis</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DEG.run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.DEG" title="omicverse.single.DEG">DEG</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.DEG.run" title="omicverse.single.DEG.run">run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_group</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_cells</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100000</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Run the differential expression analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The column name in adata.obs containing cell type information</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_group</span>
<span class="mkapi-dash">—</span>
List of cell types to analyze, if None, all cell types will be analyzed</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments for the differential expression method
capture_rate: float, default=0.07
    The capture rate for the DE analysis
treatment_col: str, default='stim'
    The column name of the treatment variable
num_cpus: int, default=12
    The number of CPUs to use for the DE analysis
num_boot: int, default=5000
    The number of bootstraps to use for the DE analysis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.DEG.get_results">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.DEG" title="omicverse.single.DEG">DEG</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.DEG.get_results" title="omicverse.single.DEG.get_results">get_results</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the results of the differential expression analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">None</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">DataFrame</span> <span class="mkapi-dash">—</span>
Results of the differential expression analysis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMDIC3">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.pyMDIC3" title="omicverse.single.pyMDIC3">pyMDIC3</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clusters</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMDIC3.GRN_train" title="omicverse.single.pyMDIC3.GRN_train">GRN_train</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.pyMDIC3.CCC_cal" title="omicverse.single.pyMDIC3.CCC_cal">CCC_cal</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMDIC3.GRN_train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMDIC3" title="omicverse.single.pyMDIC3">pyMDIC3</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMDIC3.GRN_train" title="omicverse.single.pyMDIC3.GRN_train">GRN_train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">step</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">process</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.pyMDIC3.CCC_cal">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.pyMDIC3" title="omicverse.single.pyMDIC3">pyMDIC3</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.pyMDIC3.CCC_cal" title="omicverse.single.pyMDIC3.CCC_cal">CCC_cal</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.generate_scRNA_report">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.generate_scRNA_report" title="omicverse.single.generate_scRNA_report">generate_scRNA_report</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scRNA_analysis_report.html'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">species</span><span class="mkapi-equal">=</span><span class="mkapi-default">'human'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">template_dir</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_analytics</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">analytics_id</span><span class="mkapi-equal">=</span><span class="mkapi-default">'OV-001'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate MultiQC-style HTML report for single-cell RNA-seq analysis</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">-----------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object
The analyzed single-cell data object from lazy function</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
str
Path to save the HTML report</p>
</li>
<li>
<p><span class="mkapi-item-name">species</span>
<span class="mkapi-dash">—</span>
str
Species information for the analysis</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span>
<span class="mkapi-dash">—</span>
str
Key for batch/sample information</p>
</li>
<li>
<p><span class="mkapi-item-name">template_dir</span>
<span class="mkapi-dash">—</span>
str
Directory containing HTML templates (optional)</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_analytics</span>
<span class="mkapi-dash">—</span>
bool
Whether to enable analytics tracking</p>
</li>
<li>
<p><span class="mkapi-item-name">analytics_id</span>
<span class="mkapi-dash">—</span>
str
The ID for analytics tracking</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.SCENIC">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.SCENIC" title="omicverse.single.SCENIC">SCENIC</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">db_glob</span><span class="mkapi-comma">, </span><span class="mkapi-arg">motif_path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-equal">=</span><span class="mkapi-default">8</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.SCENIC.cal_grn" title="omicverse.single.SCENIC.cal_grn">cal_grn</a></span>
<span class="mkapi-dash">—</span>
Initialize and Train a RegDiffusion model.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.SCENIC.cal_regulons" title="omicverse.single.SCENIC.cal_regulons">cal_regulons</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.SCENIC.cal_grn">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.SCENIC" title="omicverse.single.SCENIC">SCENIC</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.SCENIC.cal_grn" title="omicverse.single.SCENIC.cal_grn">cal_grn</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'regdiffusion'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-equal">=</span><span class="mkapi-default">'counts'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tf_names</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Initialize and Train a RegDiffusion model.</p>
<p>For architecture and training details, please refer to our paper.</p>
<blockquote>
<p>From noise to knowledge: probabilistic diffusion-based neural inference</p>
</blockquote>
<p>You can access the model through <code>RegDiffusionTrainer.model</code>. </p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">exp_array</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span> <span class="mkapi-dash">—</span>
2D numpy array. If used on single-cell RNAseq, 
the rows are cells and the columns are genes. Data should be log 
transformed. You may also want to remove all non expressed genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_types</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span> <span class="mkapi-dash">—</span>
(Optional) 1D integer array for cell type. If 
you have labels in your cell type, you need to convert them to 
interge. Default is None.</p>
</li>
<li>
<p><span class="mkapi-item-name">T</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Total number of diffusion steps. Default: 5,000</p>
</li>
<li>
<p><span class="mkapi-item-name">start_noise</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Minimal noise level (beta) to be added. Default: 
0.0001</p>
</li>
<li>
<p><span class="mkapi-item-name">end_noise</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Maximal noise level (beta) to be added. Default: 
0.02</p>
</li>
<li>
<p><span class="mkapi-item-name">time_dim</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Dimension size for the time embedding. Default: 64.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_dim</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Dimension size for the cell type embedding. 
Default: 4.</p>
</li>
<li>
<p><span class="mkapi-item-name">hidden_dim</span> : 
<span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
Dimension sizes for the feature learning layers. We 
use the size of the first layer as the dimension for gene embeddings
as well. Default: [16, 16, 16].</p>
</li>
<li>
<p><span class="mkapi-item-name">init_coef</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
A coefficent to control the value to initialize the 
adjacency matrix. Here we define regulatory norm as 1 over (number 
of genes - 1). The value which we use to initialize the model is 
<code>init_coef</code> times of the regulatory norm. Default: 5.</p>
</li>
<li>
<p><span class="mkapi-item-name">lr_nn</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Learning rate for the rest of the neural networks except
the adjacency matrix. Default: 0.001</p>
</li>
<li>
<p><span class="mkapi-item-name">lr_adj</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Learning rate for the adjacency matrix. By default, it 
equals to 0.02 * gene regulatory norm, which equals 1/(n_gene-1).</p>
</li>
<li>
<p><span class="mkapi-item-name">weight_decay_nn</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
L2 regularization coef on the rest of the 
neural networks. Default: 0.1.</p>
</li>
<li>
<p><span class="mkapi-item-name">weight_decay_adj</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
L2 regularization coef on the adj matrix.
Default: 0.01.</p>
</li>
<li>
<p><span class="mkapi-item-name">sparse_loss_coef</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
L1 regularization coef on the adj matrix. 
Default: 0.25.</p>
</li>
<li>
<p><span class="mkapi-item-name">adj_dropout</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Probability of an edge to be zeroed. Default: 0.3.</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Batch size for training. Default: 128.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_steps</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Total number of training iterations. Default: 1000.</p>
</li>
<li>
<p><span class="mkapi-item-name">train_split</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Train partition. Default: 1.0.</p>
</li>
<li>
<p><span class="mkapi-item-name">train_split_seed</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Random seed for train/val partition. 
Default: 123</p>
</li>
<li>
<p><span class="mkapi-item-name">device</span> : 
<span class="mkapi-item-type">str or torch.<span class="mkapi-tooltip" title="torch.device">device</span></span> <span class="mkapi-dash">—</span>
Device where the model is running. For 
example, "cpu", "cuda", "cuda:1", and etc. You are not recommended 
to run this model on Apple's MPS chips. Default is "cuda" but if 
you only has CPU, it will switch back to CPU.</p>
</li>
<li>
<p><span class="mkapi-item-name">compile</span> : 
<span class="mkapi-item-type">boolean</span> <span class="mkapi-dash">—</span>
Whether to compile the model before training. 
Compile the model is a good idea on large dataset and ofter improves
inference speed when it works. For smaller dataset, eager execution 
if often good enough.</p>
</li>
<li>
<p><span class="mkapi-item-name">evaluator</span> : 
<span class="mkapi-item-type">GRNEvaluator</span> <span class="mkapi-dash">—</span>
(Optional) A defined GRNEvaluator if ground 
truth data is available. Evaluation will be done every 100 steps by 
default but you can change this setting through the eval_on_n_steps 
option. Default is None</p>
</li>
<li>
<p><span class="mkapi-item-name">eval_on_n_steps</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
If an evaluator is provided, the trainer will 
run evaluation every <code>eval_on_n_steps</code> steps. Default: 100.</p>
</li>
<li>
<p><span class="mkapi-item-name">logger</span> : 
<span class="mkapi-item-type">LightLogger</span> <span class="mkapi-dash">—</span>
(Optional) A LightLogger to log training process. 
The only situation when you need to provide this is when you want 
to save logs from different trainers into the same logger. Default 
is None.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.SCENIC.cal_regulons">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.SCENIC" title="omicverse.single.SCENIC">SCENIC</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.SCENIC.cal_regulons" title="omicverse.single.SCENIC.cal_regulons">cal_regulons</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">rho_mask_dropouts</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-equal">=</span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.build_correlation_network_umap_layout">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.build_correlation_network_umap_layout" title="omicverse.single.build_correlation_network_umap_layout">build_correlation_network_umap_layout</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">embedding_df</span><span class="mkapi-comma">, </span><span class="mkapi-arg">correlation_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.7</span><span class="mkapi-comma">, </span><span class="mkapi-arg">umap_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_dist</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>UMAP layout + correlation network</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">-----------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">embedding_df</span>
<span class="mkapi-dash">—</span>
pd.DataFrame
Gene embedding data</p>
</li>
<li>
<p><span class="mkapi-item-name">correlation_threshold</span>
<span class="mkapi-dash">—</span>
float
Correlation threshold, control gene connection</p>
</li>
<li>
<p><span class="mkapi-item-name">umap_neighbors</span>
<span class="mkapi-dash">—</span>
int
UMAP neighbors parameter</p>
</li>
<li>
<p><span class="mkapi-item-name">min_dist</span>
<span class="mkapi-dash">—</span>
float
UMAP minimum distance parameter</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<hr/>
<p>G : nx.Graph
    Network graph (based on correlation connection)
pos : dict
    UMAP layout position
correlation_matrix : pd.DataFrame
    Correlation matrix</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.add_tf_regulation">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.add_tf_regulation" title="omicverse.single.add_tf_regulation">add_tf_regulation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">G</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tf_gene_dict</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Add TF-Gene regulation relationship to network</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">-----------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">G</span>
<span class="mkapi-dash">—</span>
nx.Graph
Existing network</p>
</li>
<li>
<p><span class="mkapi-item-name">tf_gene_dict</span>
<span class="mkapi-dash">—</span>
dict
TF-Gene regulation dictionary {TF: [target_genes]}</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<hr/>
<p>G : nx.Graph
    Network with regulation relationship
tf_genes : list
    TF gene list</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.plot_grn">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.plot_grn" title="omicverse.single.plot_grn">plot_grn</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">G</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tf_list</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temporal_df</span><span class="mkapi-comma">, </span><span class="mkapi-arg">tf_gene_dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">top_tf_target_num</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'GRN'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'RdBu_r'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.run" title="omicverse.single.Velo.run">run</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.filter_genes" title="omicverse.single.Velo.filter_genes">filter_genes</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.preprocess" title="omicverse.single.Velo.preprocess">preprocess</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.moments" title="omicverse.single.Velo.moments">moments</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.dynamics" title="omicverse.single.Velo.dynamics">dynamics</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.cal_velocity" title="omicverse.single.Velo.cal_velocity">cal_velocity</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.graphvelo" title="omicverse.single.Velo.graphvelo">graphvelo</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.velocity_graph" title="omicverse.single.Velo.velocity_graph">velocity_graph</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Velo.velocity_embedding" title="omicverse.single.Velo.velocity_embedding">velocity_embedding</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.run" title="omicverse.single.Velo.run">run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.filter_genes">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.filter_genes" title="omicverse.single.Velo.filter_genes">filter_genes</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">min_shared_counts</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.preprocess" title="omicverse.single.Velo.preprocess">preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">recipe</span><span class="mkapi-equal">=</span><span class="mkapi-default">'monocle'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.moments">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.moments" title="omicverse.single.Velo.moments">moments</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">backend</span><span class="mkapi-equal">=</span><span class="mkapi-default">'dynamo'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.dynamics">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.dynamics" title="omicverse.single.Velo.dynamics">dynamics</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">backend</span><span class="mkapi-equal">=</span><span class="mkapi-default">'dynamo'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.cal_velocity">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.cal_velocity" title="omicverse.single.Velo.cal_velocity">cal_velocity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'dynamo'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">velocity_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity_S'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_top_genes</span><span class="mkapi-equal">=</span><span class="mkapi-default">2000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">param_name_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'tmp/latentvelo_params'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">latentvelo_VAE_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.graphvelo">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.graphvelo" title="omicverse.single.Velo.graphvelo">graphvelo</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">xkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Ms'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity_S'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis_keys</span><span class="mkapi-equal">=</span><span class="mkapi-default">['X_umap', 'X_pca']</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_subset</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.velocity_graph">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.velocity_graph" title="omicverse.single.Velo.velocity_graph">velocity_graph</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity_S'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Velo.velocity_embedding">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Velo" title="omicverse.single.Velo">Velo</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Velo.velocity_embedding" title="omicverse.single.Velo.velocity_embedding">velocity_embedding</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity_S'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.velocity_embedding">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.velocity_embedding" title="omicverse.single.velocity_embedding">velocity_embedding</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">self_transitions</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_negative_cosines</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">direct_pca_projection</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retain_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">autoscale</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">all_comps</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">T</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">copy</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Projects the single cell velocities into any embedding.</p>
<p>Given normalized difference of the embedding positions</p>
<p>.. math::
    \tilde \delta_{ij} = \frac{x_j-x_i}{\left\lVert x_j-x_i \right\rVert},</p>
<p>the projections are obtained as expected displacements with respect to the
transition matrix :math:<code>\tilde \pi_{ij}</code> as</p>
<p>.. math::
    \tilde \nu_i = E_{\tilde \pi_{i\cdot}} [\tilde \delta_{i \cdot}]
    = \sum_{j \neq i} \left( \tilde \pi_{ij} - \frac1n \right) \tilde
    \delta_{ij}.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type">:class:<code>~anndata.&lt;span class="mkapi-tooltip" title="anndata._core.anndata.AnnData"&gt;AnnData&lt;/span&gt;</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type"><code>str</code> (default: <code>'tsne'</code>)</span> <span class="mkapi-dash">—</span>
Which embedding to use.</p>
</li>
<li>
<p><span class="mkapi-item-name">vkey</span> : 
<span class="mkapi-item-type"><code>str</code> (default: <code>'velocity'</code>)</span> <span class="mkapi-dash">—</span>
Name of velocity estimates to be used.</p>
</li>
<li>
<p><span class="mkapi-item-name">scale</span> : 
<span class="mkapi-item-type"><code>int</code> (default: 10)</span> <span class="mkapi-dash">—</span>
Scale parameter of gaussian kernel for transition matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">self_transitions</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>True</code>)</span> <span class="mkapi-dash">—</span>
Whether to allow self transitions, based on the confidences of transitioning to
neighboring cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_negative_cosines</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>True</code>)</span> <span class="mkapi-dash">—</span>
Whether to project cell-to-cell transitions with negative cosines into
negative/opposite direction.</p>
</li>
<li>
<p><span class="mkapi-item-name">direct_pca_projection</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>None</code>)</span> <span class="mkapi-dash">—</span>
Whether to directly project the velocities into PCA space,
thus skipping the velocity graph.</p>
</li>
<li>
<p><span class="mkapi-item-name">retain_scale</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>False</code>)</span> <span class="mkapi-dash">—</span>
Whether to retain scale from high dimensional space in embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name">autoscale</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>True</code>)</span> <span class="mkapi-dash">—</span>
Whether to scale the embedded velocities by a scalar multiplier,
which simply ensures that the arrows in the embedding are properly scaled.</p>
</li>
<li>
<p><span class="mkapi-item-name">all_comps</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>True</code>)</span> <span class="mkapi-dash">—</span>
Whether to compute the velocities on all embedding components.</p>
</li>
<li>
<p><span class="mkapi-item-name">T</span> : 
<span class="mkapi-item-type"><code>csr\_matrix</code> (default: <code>None</code>)</span> <span class="mkapi-dash">—</span>
Allows the user to directly pass a transition matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">copy</span> : 
<span class="mkapi-item-type"><code>bool</code> (default: <code>False</code>)</span> <span class="mkapi-dash">—</span>
Return a copy instead of writing to <span class="mkapi-tooltip" title="omicverse.single._velo.velocity_embedding.adata"><code>adata</code></span>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">velocity_umap</span> : 
<span class="mkapi-item-type"><code>.obsm</code></span> <span class="mkapi-dash">—</span>
coordinates of velocity projection on embedding (e.g., basis='umap')</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.annotate" title="omicverse.single.Annotation.annotate">annotate</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.add_reference_sc" title="omicverse.single.Annotation.add_reference_sc">add_reference_sc</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.add_reference_pkl" title="omicverse.single.Annotation.add_reference_pkl">add_reference_pkl</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.add_reference_scsa_db" title="omicverse.single.Annotation.add_reference_scsa_db">add_reference_scsa_db</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.download_scsa_db" title="omicverse.single.Annotation.download_scsa_db">download_scsa_db</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.download_reference_pkl" title="omicverse.single.Annotation.download_reference_pkl">download_reference_pkl</a></span>
<span class="mkapi-dash">—</span>
Download a CellTypist model pickle file by name and return its path.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.Annotation.query_reference" title="omicverse.single.Annotation.query_reference">query_reference</a></span>
<span class="mkapi-dash">—</span>
Use an LLM to identify relevant reference resources based on a description.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.annotate">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.annotate" title="omicverse.single.Annotation.annotate">annotate</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltypist'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.add_reference_sc">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.add_reference_sc" title="omicverse.single.Annotation.add_reference_sc">add_reference_sc</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">reference</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'celltype'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.add_reference_pkl">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.add_reference_pkl" title="omicverse.single.Annotation.add_reference_pkl">add_reference_pkl</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">reference</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.add_reference_scsa_db">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.add_reference_scsa_db" title="omicverse.single.Annotation.add_reference_scsa_db">add_reference_scsa_db</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">reference</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.download_scsa_db">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.download_scsa_db" title="omicverse.single.Annotation.download_scsa_db">download_scsa_db</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'temp/pySCSA_2024_v1_plus.db'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.download_reference_pkl">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.download_reference_pkl" title="omicverse.single.Annotation.download_reference_pkl">download_reference_pkl</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">reference_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">force_download</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>Download a CellTypist model pickle file by name and return its path.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">RuntimeError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.Annotation.query_reference">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.Annotation" title="omicverse.single.Annotation">Annotation</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.Annotation.query_reference" title="omicverse.single.Annotation.query_reference">query_reference</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">source</span><span class="mkapi-equal">=</span><span class="mkapi-default">'cellxgene'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">data_desc</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_model</span><span class="mkapi-equal">=</span><span class="mkapi-default">'gpt-4o-mini'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_api_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'sk*'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_provider</span><span class="mkapi-equal">=</span><span class="mkapi-default">'openai'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_base_url</span><span class="mkapi-equal">=</span><span class="mkapi-default">'https://api.openai.com/v1'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">llm_extra_params</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Use an LLM to identify relevant reference resources based on a description.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">source</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Data source identifier. Supported values: <code>'cellxgene'</code> and <code>'celltypist'</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">data_desc</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Free-text description of the dataset you are trying to match.</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Model name passed to the selected LLM provider.</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_api_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
API key for the LLM provider. If left as a placeholder (e.g. <code>'sk*'</code>),
the method will attempt to read provider-specific environment variables.</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_provider</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
LLM provider identifier. Implemented providers: <code>'openai'</code>,
<code>'custom_openai'</code> (OpenAI-compatible), <code>'doubao'</code>, <code>'anthropic'</code> and <code>'ollama'</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_base_url</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Base URL for OpenAI-compatible endpoints. Ignored for providers that do
not use it.</p>
</li>
<li>
<p><span class="mkapi-item-name">llm_extra_params</span> : 
<span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Additional parameters forwarded directly to the LLM API call.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">pandas.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Selected entries with source-specific columns (e.g. <code>collection_id</code>/<code>collection_url</code>
for CellxGene, <code>model</code> for CellTypist) plus <code>llm_reason</code>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">NotImplementedError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">RuntimeError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.AnnotationRef">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.single.AnnotationRef" title="omicverse.single.AnnotationRef">AnnotationRef</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata_query</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata_ref</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'celltype'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.AnnotationRef.preprocess" title="omicverse.single.AnnotationRef.preprocess">preprocess</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.AnnotationRef.train" title="omicverse.single.AnnotationRef.train">train</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.single.AnnotationRef.predict" title="omicverse.single.AnnotationRef.predict">predict</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.AnnotationRef.preprocess">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.AnnotationRef" title="omicverse.single.AnnotationRef">AnnotationRef</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.AnnotationRef.preprocess" title="omicverse.single.AnnotationRef.preprocess">preprocess</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">mode</span><span class="mkapi-equal">=</span><span class="mkapi-default">'shiftlog|pearson'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_HVGs</span><span class="mkapi-equal">=</span><span class="mkapi-default">3000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'integrate_batch'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.AnnotationRef.train">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.AnnotationRef" title="omicverse.single.AnnotationRef">AnnotationRef</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.AnnotationRef.train" title="omicverse.single.AnnotationRef.train">train</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'harmony'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.single.AnnotationRef.predict">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.single.AnnotationRef" title="omicverse.single.AnnotationRef">AnnotationRef</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.single.AnnotationRef.predict" title="omicverse.single.AnnotationRef.predict">predict</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'harmony'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pred_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">uncert_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2019-2025, 112 Lab, USTB
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.fc8c2696.min.js"></script>
<script src="../../../javascript/mkapi.js"></script>
<script src="../../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>