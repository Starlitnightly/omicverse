
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Zehua Zeng" name="author"/>
<link href="../space/" rel="prev"/>
<link href="../../../Release_notes/" rel="next"/>
<link href="../../../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.1.2" name="generator"/>
<title>utils - omicverse Readthedocs</title>
<link href="../../../assets/stylesheets/main.7bf56d0a.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/mkapi-common.css" rel="stylesheet"/>
<link href="../../../css/mkapi-material.css" rel="stylesheet"/>
<link href="../../../css/tags.css" rel="stylesheet"/>
<link href="../../../css/custom.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#omicverse.utils">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="omicverse Readthedocs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            omicverse Readthedocs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              utils
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="omicverse Readthedocs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
    omicverse Readthedocs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Index
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Installation_guild/">
        Installation
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Bulk
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
          Bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_1">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_bulk_combat/">
        Batch correction in Bulk RNA-seq or microarray data
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_2">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deg/">
        Different Expression Analysis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deseq2/">
        Different Expression Analysis with DEseq2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_network/">
        Protein-Protein interaction (PPI) analysis by String-db
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_wgcna/">
        WGCNA (Weighted gene co-expression network analysis) analysis
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_3">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_decov_bulk/">
        Bulk deconvolution with reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
          Others
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_4">
<span class="md-nav__icon md-icon"></span>
          Others
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_tcga/">
        TCGA database preprocess
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          Alignment
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_1">
<span class="md-nav__icon md-icon"></span>
          Alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_1k/">
        Alignment and analysis of single-cell RNA-seq data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_velocity/">
        Alignment and RNA velocity analysis of single-cell RNA-seq data.
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_2">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_cpu/">
        Preprocessing the data of scRNA-seq with omicverse[CPU-GPU-mixed]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_gpu/">
        Preprocessing the data of scRNA-seq with omicverse[GPU]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cluster/">
        Clustering space
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_single_batch/">
        Data integration and batch correction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cnmf/">
        GeneModule Identified
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_lazy/">
        Lazy analysis of scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
          Annotation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_3">
<span class="md-nav__icon md-icon"></span>
          Annotation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_noref/">
        Reference-free automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_ref/">
        Reference automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_gptanno/">
        Automatic cell type annotation with GPT/Other
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellmatch/">
        Mapping Cell Names to the Cell Ontology/Taxonomy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellanno/">
        Celltype auto annotation with SCSA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metatime/">
        Celltype auto annotation with MetaTiME
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_tosica/">
        Celltype annotation migration(mapping) with TOSICA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scmulan/">
        Celltype auto annotation with scMulan
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellvote/">
        Consensus annotation with CellVote
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
          Trajectory
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
          Trajectory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cytotrace/">
        Prediction of absolute developmental potential using CytoTrace2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_traj/">
        Basic Trajectory Inference
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_stavia/">
        Trajectory Inference with StaVIA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate_gene/">
        Timing-associated genes analysis with TimeFateKernel
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate/">
        Identify the driver regulators of cell fate decisions
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
          Cell Structure
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_5">
<span class="md-nav__icon md-icon"></span>
          Cell Structure
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metacells/">
        Inference of MetaCell from Single-Cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_deg_single/">
        Differential expression and celltype analysis [All Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdeg/">
        Differential expression analysis [Meta Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scenic/">
        Gene Regulatory Network Analysis with SCENIC
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_aucell/">
        Pathway analysis with AUCell
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellphonedb/">
        Cell-cell communication using CellPhoneDBViz
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdrug/">
        Drug response predict with scDrug
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_simba/">
        Data integration and batch correction with SIMBA
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
          Velocity
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_6">
<span class="md-nav__icon md-icon"></span>
          Velocity
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_velo/">
        Velocity Basic Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_graphvelo/">
        Velocity Optimization
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_7" id="__nav_3_2_7_label" tabindex="0">
          Multi omics
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_7">
<span class="md-nav__icon md-icon"></span>
          Multi omics
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa/">
        Multi omics analysis by MOFA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa_glue/">
        Multi omics analysis by MOFA and GLUE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_trans/">
        Celltype annotation transfer in multi-omics
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Bulk2Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          Bulk2Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulktrajblend/">
        Bulk RNA-seq generate 'interrupted' cells to interpolate scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulk2single/">
        Bulk RNA-seq to Single RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_single2spatial/">
        Single RNA-seq to Spatial RNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Space
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
          Space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
          Preprocess
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_1">
<span class="md-nav__icon md-icon"></span>
          Preprocess
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_crop_rotate/">
        Crop and Rotation of spatial transcriptomic data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cellpose/">
        Cell Segmemtation (10x HD)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cluster_space/">
        Spatial clustering and denoising expressions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_staligner/">
        Spatial integration and clustering
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_2">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_spaceflow/">
        Identifying Pseudo-Spatial Map
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_decov/">
        Spatial deconvolution with reference scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_flashdeconv/">
        FlashDeconv: Fast Spatial Deconvolution via Structure-Preserving Sketching
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_starfysh_new/">
        Spatial deconvolution without reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_3">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_stt/">
        Spatial transition tensor of single cells
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_commot_flowsig/">
        Spatial Communication
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_gaston/">
        Spatial IsoDepth Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_slat/">
        Single cell spatial alignment tools
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          LLM
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          LLM
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr/">
        Domain Research (dr): Comprehensive Report Tutorial
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr_web/">
        Domain Research (dr) — Live Web
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_ov_agent_pbmc3k/">
        ov.Agent with Skills: Natural‑Language Single‑Cell Analysis (PBMC3k)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_uce/">
        UCE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scgpt/">
        scGPT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scfoundation/">
        scFoundation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_geneformer/">
        GeneFormer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_cellplm/">
        CellPLM
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Plotting
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
          Plotting
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_single/">
        Visualization of single cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_bulk/">
        Visualization of Bulk RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_colorsystem/">
        Color system
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../GPU_supported_registry_functions/">
        GPU Support
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">API documentation</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../agent/">agent</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          agent
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../alignment/">alignment</a>
<label for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
          alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../alignment/kb_api/">
        kb_api
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk/">bulk</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk2single/">bulk2single</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
          bulk2single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../datasets/">datasets</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_6">
<span class="md-nav__icon md-icon"></span>
          datasets
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pl/">pl</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
          pl
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/">pp</a>
<label for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
          pp
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/experimental/">experimental</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_8_2">
<span class="md-nav__icon md-icon"></span>
          experimental
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pp/pyg_knn_implementation/">
        pyg_knn_implementation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_9" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../single/">single</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_9">
<span class="md-nav__icon md-icon"></span>
          single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_10" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../space/">space</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_10">
<span class="md-nav__icon md-icon"></span>
          space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_11" type="checkbox"/>
<div class="md-nav__link md-nav__link--index md-nav__link--active">
<a href="./">utils</a>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_11">
<span class="md-nav__icon md-icon"></span>
          utils
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Release_notes/">
        Release notes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Developer_guild/">
        Developer guild
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.read">
    read
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.read_csv">
    read_csv
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.read_10x_mtx">
    read_10x_mtx
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.read_h5ad">
    read_h5ad
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.read_10x_h5">
    read_10x_h5
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.convert_to_pandas">
    convert_to_pandas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.download_CaDRReS_model">
    download_CaDRReS_model
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.download_GDSC_data">
    download_GDSC_data
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.download_pathway_database">
    download_pathway_database
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.download_geneid_annotation_pair">
    download_geneid_annotation_pair
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.gtf_to_pair_tsv">
    gtf_to_pair_tsv
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.download_tosica_gmt">
    download_tosica_gmt
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_prepare">
    geneset_prepare
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.get_gene_annotation">
    get_gene_annotation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.correlation_pseudotime">
    correlation_pseudotime
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.store_layers">
    store_layers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.retrieve_layers">
    retrieve_layers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.easter_egg">
    easter_egg
  </a>
<nav aria-label="easter_egg" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.easter_egg.O">
    O
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.save">
    save
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.load">
    load
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.convert_adata_for_rust">
    convert_adata_for_rust
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.anndata_sparse">
    anndata_sparse
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.np_mean">
    np_mean
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.np_std">
    np_std
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.load_signatures_from_file">
    load_signatures_from_file
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.patch_rust_adata">
    patch_rust_adata
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_set">
    plot_set
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.pyomic_palette">
    pyomic_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.palette">
    palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.blue_palette">
    blue_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.orange_palette">
    orange_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.red_palette">
    red_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.green_palette">
    green_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_text_set">
    plot_text_set
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.ticks_range">
    ticks_range
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_boxplot">
    plot_boxplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_network">
    plot_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_cellproportion">
    plot_cellproportion
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_embedding_celltype">
    plot_embedding_celltype
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud">
    geneset_wordcloud
  </a>
<nav aria-label="geneset_wordcloud" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud.get">
    get
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud.get_geneset">
    get_geneset
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud.get_wordcloud">
    get_wordcloud
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud.plot">
    plot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.geneset_wordcloud.plot_heatmap">
    plot_heatmap
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_pca_variance_ratio">
    plot_pca_variance_ratio
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.gen_mpl_labels">
    gen_mpl_labels
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.mde">
    mde
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.pancreas">
    pancreas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.synthetic_iid">
    synthetic_iid
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.diffmap">
    diffmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.draw_graph">
    draw_graph
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.embedding">
    embedding
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.pca">
    pca
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.spatial">
    spatial
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.tsne">
    tsne
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.umap">
    umap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.weighted_knn_trainer">
    weighted_knn_trainer
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.weighted_knn_transfer">
    weighted_knn_transfer
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.adjust_palette">
    adjust_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.clip">
    clip
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.default_color">
    default_color
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.default_palette">
    default_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.get_colors">
    get_colors
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.interpret_colorkey">
    interpret_colorkey
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.is_categorical">
    is_categorical
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.is_list">
    is_list
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.is_list_of_str">
    is_list_of_str
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.is_list_or_array">
    is_list_or_array
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.is_view">
    is_view
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.make_dense">
    make_dense
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_heatmap">
    plot_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.set_colors_for_categorical_obs">
    set_colors_for_categorical_obs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.strings_to_categoricals">
    strings_to_categoricals
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.to_list">
    to_list
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.roe">
    roe
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.roe_plot_heatmap">
    roe_plot_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.transform_roe_values">
    transform_roe_values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.odds_ratio">
    odds_ratio
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_odds_ratio_heatmap">
    plot_odds_ratio_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.shannon_diversity">
    shannon_diversity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.compare_shannon_diversity">
    compare_shannon_diversity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_shannon_diversity">
    plot_shannon_diversity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.optimal_resolution">
    optimal_resolution
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_resolution_optimization">
    plot_resolution_optimization
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.resolution_stability_analysis">
    resolution_stability_analysis
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.cal_paga">
    cal_paga
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.plot_paga">
    plot_paga
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.PAGA_tree">
    PAGA_tree
  </a>
<nav aria-label="PAGA_tree" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.PAGA_tree.compute_transitions">
    compute_transitions
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.cluster">
    cluster
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.LDA_topic">
    LDA_topic
  </a>
<nav aria-label="LDA_topic" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.LDA_topic.plot_topic_contributions">
    plot_topic_contributions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.LDA_topic.predicted">
    predicted
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.LDA_topic.get_results_rfc">
    get_results_rfc
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.filtered">
    filtered
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.refine_label">
    refine_label
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.venny4py">
    venny4py
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.lsi">
    lsi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.tfidf">
    tfidf
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.neighbors">
    neighbors
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.calc_kBET">
    calc_kBET
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.calc_kSIM">
    calc_kSIM
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.agent_backend">
    agent_backend
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.BackendConfig">
    BackendConfig
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseLLMBackend">
    OmicVerseLLMBackend
  </a>
<nav aria-label="OmicVerseLLMBackend" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseLLMBackend.run">
    run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseLLMBackend.stream">
    stream
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.Usage">
    Usage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.smart_agent">
    smart_agent
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.Agent">
    Agent
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent">
    OmicVerseAgent
  </a>
<nav aria-label="OmicVerseAgent" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.help_short">
    help_short
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.run_async">
    run_async
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.run_async_LEGACY">
    run_async_LEGACY
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.stream_async">
    stream_async
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.run">
    run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.get_current_session_info">
    get_current_session_info
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.restart_session">
    restart_session
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.get_session_history">
    get_session_history
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.filesystem_context">
    filesystem_context
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.write_note">
    write_note
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.search_context">
    search_context
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.get_relevant_context">
    get_relevant_context
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.save_plan">
    save_plan
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.update_plan_step">
    update_plan_step
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.get_workspace_summary">
    get_workspace_summary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.OmicVerseAgent.get_context_stats">
    get_context_stats
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.utils.list_supported_models">
    list_supported_models
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 style="display: none;">omicverse.utils<a class="headerlink" href="#omicverse.utils" title="Permanent link">¶</a></h1><p class="mkapi-object mkapi-page-source" id="omicverse.utils">
<span class="mkapi-object-link">
<a href="../../../src/omicverse/utils/#omicverse.utils" title="Go to source">source</a>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">package</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils" title="omicverse.utils">omicverse.utils</a></span>
</p>
<div class="mkapi-document">
<p>Utility functions for data handling and analysis.</p>
<p>This module provides essential utility functions for data I/O, manipulation,
visualization, clustering, and various computational tasks across the omicverse
ecosystem. It serves as the foundation for many higher-level analysis functions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle data i/o and manipulation">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Data I/O and manipulation</span>
</p>
<div class="mkapi-section-content">
<div class="highlight"><pre><span></span><code>read: Universal data reader for various formats
read_csv, read_10x_mtx, read_h5ad, read_10x_h5: Format-specific readers
data_downloader: Download datasets and models
geneset_prepare: Prepare gene sets for analysis
get_gene_annotation: Gene annotation utilities
</code></pre></div>
<p>Visualization utilities:
    palette: Color palette management
    ov_plot_set, plot_set: Global plot settings
    Various plotting helper functions</p>
<p>Clustering and analysis:
    cluster: General clustering functions
    LDA_topic: Topic modeling for single-cell data
    filtered, refine_label: Data filtering and label refinement</p>
<p>Statistical and computational tools:
    correlation_pseudotime: Pseudotime correlation analysis
    np_mean, np_std: Numpy-based statistical functions
    neighbors: Neighbor graph construction
    mde: Minimum distortion embedding</p>
<p>Data structures and conversion:
    anndata_sparse: Sparse matrix utilities for AnnData
    store_layers, retrieve_layers: Layer management</p>
<p>Specialized analysis:
    roe: Ratio of expression analysis
    cal_paga, plot_paga: PAGA trajectory analysis
    venny4py: Venn diagram utilities
    syn: Synthetic data generation
    scatterplot: Advanced scatter plot functions
    knn: K-nearest neighbors utilities
    heatmap: Heatmap generation and customization
    lsi: Latent semantic indexing</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Data reading</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'data.h5ad'</span><span class="p">)</span>

<span class="c1"># Clustering</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s1">'X_pca'</span><span class="p">],</span> 
    <span class="n">method</span><span class="o">=</span><span class="s1">'leiden'</span><span class="p">,</span> 
    <span class="n">resolution</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># Visualization setup</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">ov_plot_set</span><span class="p">()</span>

<span class="c1"># Download data</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data_downloader</span><span class="p">(</span><span class="s1">'pbmc3k'</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle classes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Classes</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.easter_egg" title="omicverse.utils.easter_egg">easter_egg</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.PAGA_tree" title="omicverse.utils.PAGA_tree">PAGA_tree</a></span>
<span class="mkapi-dash">—</span>
TODO.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.LDA_topic" title="omicverse.utils.LDA_topic">LDA_topic</a></span>
<span class="mkapi-dash">—</span>
Latent Dirichlet Allocation (LDA) topic modeling for single-cell data using MIRA.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.BackendConfig" title="omicverse.utils.BackendConfig">BackendConfig</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseLLMBackend" title="omicverse.utils.OmicVerseLLMBackend">OmicVerseLLMBackend</a></span>
<span class="mkapi-dash">—</span>
Simple, async LLM client used by the OmicVerse Agent.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.Usage" title="omicverse.utils.Usage">Usage</a></span>
<span class="mkapi-dash">—</span>
Token usage statistics for a model completion.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a></span>
<span class="mkapi-dash">—</span>
Intelligent agent for OmicVerse function discovery and execution.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle functions">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Functions</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.read" title="omicverse.utils.read">read</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.read_csv" title="omicverse.utils.read_csv">read_csv</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.read_10x_mtx" title="omicverse.utils.read_10x_mtx">read_10x_mtx</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.read_h5ad" title="omicverse.utils.read_h5ad">read_h5ad</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.read_10x_h5" title="omicverse.utils.read_10x_h5">read_10x_h5</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.convert_to_pandas" title="omicverse.utils.convert_to_pandas">convert_to_pandas</a></span>
<span class="mkapi-dash">—</span>
Convert PyDataFrameElem or similar objects to pandas DataFrame.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.download_CaDRReS_model" title="omicverse.utils.download_CaDRReS_model">download_CaDRReS_model</a></span>
<span class="mkapi-dash">—</span>
load CaDRReS_model</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.download_GDSC_data" title="omicverse.utils.download_GDSC_data">download_GDSC_data</a></span>
<span class="mkapi-dash">—</span>
load GDSC_data</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.download_pathway_database" title="omicverse.utils.download_pathway_database">download_pathway_database</a></span>
<span class="mkapi-dash">—</span>
Download pathway and gene set databases for enrichment analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.download_geneid_annotation_pair" title="omicverse.utils.download_geneid_annotation_pair">download_geneid_annotation_pair</a></span>
<span class="mkapi-dash">—</span>
Download gene ID annotation mapping files for various organisms.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.gtf_to_pair_tsv" title="omicverse.utils.gtf_to_pair_tsv">gtf_to_pair_tsv</a></span>
<span class="mkapi-dash">—</span>
Convert GTF file to gene ID mapping pairs TSV format.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.download_tosica_gmt" title="omicverse.utils.download_tosica_gmt">download_tosica_gmt</a></span>
<span class="mkapi-dash">—</span>
load TOSICA gmt dataset</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_prepare" title="omicverse.utils.geneset_prepare">geneset_prepare</a></span>
<span class="mkapi-dash">—</span>
Load and prepare gene sets from GMT/TXT files for enrichment analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.get_gene_annotation" title="omicverse.utils.get_gene_annotation">get_gene_annotation</a></span>
<span class="mkapi-dash">—</span>
Get genomic annotation of genes by joining with a GTF file.
It was writed by scglue, and I just copy it.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.correlation_pseudotime" title="omicverse.utils.correlation_pseudotime">correlation_pseudotime</a></span>
<span class="mkapi-dash">—</span>
Compute the correlation between rows in matrix <code>X</code> columns of matrix <code>Y</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.store_layers" title="omicverse.utils.store_layers">store_layers</a></span>
<span class="mkapi-dash">—</span>
Store the X matrix of AnnData in adata.uns for later retrieval.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.retrieve_layers" title="omicverse.utils.retrieve_layers">retrieve_layers</a></span>
<span class="mkapi-dash">—</span>
Retrieve previously stored X matrix from adata.uns and restore to adata.X.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.save" title="omicverse.utils.save">save</a></span>
<span class="mkapi-dash">—</span>
Save object to file using pickle or cloudpickle.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.load" title="omicverse.utils.load">load</a></span>
<span class="mkapi-dash">—</span>
Load object from file using pickle or cloudpickle.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.convert_adata_for_rust" title="omicverse.utils.convert_adata_for_rust">convert_adata_for_rust</a></span>
<span class="mkapi-dash">—</span>
Convert AnnData object to be compatible with Rust backend using snapatac2.AnnData.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.anndata_sparse" title="omicverse.utils.anndata_sparse">anndata_sparse</a></span>
<span class="mkapi-dash">—</span>
Set adata.X to csr_matrix</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.np_mean" title="omicverse.utils.np_mean">np_mean</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.np_std" title="omicverse.utils.np_std">np_std</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.load_signatures_from_file" title="omicverse.utils.load_signatures_from_file">load_signatures_from_file</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.patch_rust_adata" title="omicverse.utils.patch_rust_adata">patch_rust_adata</a></span>
<span class="mkapi-dash">—</span>
Apply a collection of compatibility patches to an anndata-rs AnnData instance.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_set" title="omicverse.utils.plot_set">plot_set</a></span>
<span class="mkapi-dash">—</span>
Configure plotting settings for OmicVerse.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.pyomic_palette" title="omicverse.utils.pyomic_palette">pyomic_palette</a></span>
<span class="mkapi-dash">—</span>
Returns the default OmicVerse color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.palette" title="omicverse.utils.palette">palette</a></span>
<span class="mkapi-dash">—</span>
Returns the default OmicVerse color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.blue_palette" title="omicverse.utils.blue_palette">blue_palette</a></span>
<span class="mkapi-dash">—</span>
Returns a blue-themed color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.orange_palette" title="omicverse.utils.orange_palette">orange_palette</a></span>
<span class="mkapi-dash">—</span>
Returns an orange-themed color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.red_palette" title="omicverse.utils.red_palette">red_palette</a></span>
<span class="mkapi-dash">—</span>
Returns a red-themed color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.green_palette" title="omicverse.utils.green_palette">green_palette</a></span>
<span class="mkapi-dash">—</span>
Returns a green-themed color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_text_set" title="omicverse.utils.plot_text_set">plot_text_set</a></span>
<span class="mkapi-dash">—</span>
Format text for plotting by adding line breaks.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.ticks_range" title="omicverse.utils.ticks_range">ticks_range</a></span>
<span class="mkapi-dash">—</span>
Generate tick positions for multi-group plots.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_boxplot" title="omicverse.utils.plot_boxplot">plot_boxplot</a></span>
<span class="mkapi-dash">—</span>
Create boxplot with jittered points for grouped data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_network" title="omicverse.utils.plot_network">plot_network</a></span>
<span class="mkapi-dash">—</span>
Plot network graph with customizable node and edge properties.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_cellproportion" title="omicverse.utils.plot_cellproportion">plot_cellproportion</a></span>
<span class="mkapi-dash">—</span>
Plot stacked bar chart showing cell type proportions across groups.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_embedding_celltype" title="omicverse.utils.plot_embedding_celltype">plot_embedding_celltype</a></span>
<span class="mkapi-dash">—</span>
Create combined embedding plot with cell type legend and counts.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_pca_variance_ratio" title="omicverse.utils.plot_pca_variance_ratio">plot_pca_variance_ratio</a></span>
<span class="mkapi-dash">—</span>
Plot PCA variance ratio to determine optimal number of principal components.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.gen_mpl_labels" title="omicverse.utils.gen_mpl_labels">gen_mpl_labels</a></span>
<span class="mkapi-dash">—</span>
Add cluster labels at median positions in embedding plots with automatic text positioning.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.mde" title="omicverse.utils.mde">mde</a></span>
<span class="mkapi-dash">—</span>
Util to run :func:<span class="mkapi-tooltip" title="pymde.recipes.preserve_neighbors"><code>pymde.preserve_neighbors</code></span> for visualization of scvi-tools embeddings.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.pancreas" title="omicverse.utils.pancreas">pancreas</a></span>
<span class="mkapi-dash">—</span>
Pancreatic endocrinogenesis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.synthetic_iid" title="omicverse.utils.synthetic_iid">synthetic_iid</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.diffmap" title="omicverse.utils.diffmap">diffmap</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in Diffusion Map basis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.draw_graph" title="omicverse.utils.draw_graph">draw_graph</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in graph-drawing basis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.embedding" title="omicverse.utils.embedding">embedding</a></span>
<span class="mkapi-dash">—</span>
Scatter plot for user specified embedding basis (e.g. umap, pca, etc).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.pca" title="omicverse.utils.pca">pca</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in PCA coordinates.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.spatial" title="omicverse.utils.spatial">spatial</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in spatial coordinates.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.tsne" title="omicverse.utils.tsne">tsne</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in tSNE basis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.umap" title="omicverse.utils.umap">umap</a></span>
<span class="mkapi-dash">—</span>
Scatter plot in UMAP basis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.weighted_knn_trainer" title="omicverse.utils.weighted_knn_trainer">weighted_knn_trainer</a></span>
<span class="mkapi-dash">—</span>
Trains a weighted KNN classifier on <code>train_adata</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.weighted_knn_transfer" title="omicverse.utils.weighted_knn_transfer">weighted_knn_transfer</a></span>
<span class="mkapi-dash">—</span>
Annotates <code>query_adata</code> cells with an input trained weighted KNN classifier.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.adjust_palette" title="omicverse.utils.adjust_palette">adjust_palette</a></span>
<span class="mkapi-dash">—</span>
Adjust palette to match required length.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.clip" title="omicverse.utils.clip">clip</a></span>
<span class="mkapi-dash">—</span>
Clip values to specified percentile range.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.default_color" title="omicverse.utils.default_color">default_color</a></span>
<span class="mkapi-dash">—</span>
Get default color for plotting based on available metadata.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.default_palette" title="omicverse.utils.default_palette">default_palette</a></span>
<span class="mkapi-dash">—</span>
Get default color palette for plotting.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.get_colors" title="omicverse.utils.get_colors">get_colors</a></span>
<span class="mkapi-dash">—</span>
Get colors for categorical or continuous variables.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.interpret_colorkey" title="omicverse.utils.interpret_colorkey">interpret_colorkey</a></span>
<span class="mkapi-dash">—</span>
Interpret color key specification for plotting.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.is_categorical" title="omicverse.utils.is_categorical">is_categorical</a></span>
<span class="mkapi-dash">—</span>
Check if data or column is categorical.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.is_list" title="omicverse.utils.is_list">is_list</a></span>
<span class="mkapi-dash">—</span>
Check if key is a list-like object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.is_list_of_str" title="omicverse.utils.is_list_of_str">is_list_of_str</a></span>
<span class="mkapi-dash">—</span>
Check if key is a list of strings.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.is_list_or_array" title="omicverse.utils.is_list_or_array">is_list_or_array</a></span>
<span class="mkapi-dash">—</span>
Check if key is a list or array-like object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.is_view" title="omicverse.utils.is_view">is_view</a></span>
<span class="mkapi-dash">—</span>
Check if AnnData object is a view.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.make_dense" title="omicverse.utils.make_dense">make_dense</a></span>
<span class="mkapi-dash">—</span>
Convert sparse matrix to dense array.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_heatmap" title="omicverse.utils.plot_heatmap">plot_heatmap</a></span>
<span class="mkapi-dash">—</span>
Plot time series for genes as heatmap.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.set_colors_for_categorical_obs" title="omicverse.utils.set_colors_for_categorical_obs">set_colors_for_categorical_obs</a></span>
<span class="mkapi-dash">—</span>
Set colors for categorical observation in AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.strings_to_categoricals" title="omicverse.utils.strings_to_categoricals">strings_to_categoricals</a></span>
<span class="mkapi-dash">—</span>
Transform string annotations to categoricals.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.to_list" title="omicverse.utils.to_list">to_list</a></span>
<span class="mkapi-dash">—</span>
Convert key to list format.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.roe" title="omicverse.utils.roe">roe</a></span>
<span class="mkapi-dash">—</span>
Calculate the ratio of observed cell number to expected cell number (Ro/e) for each cell type in each sample.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.roe_plot_heatmap" title="omicverse.utils.roe_plot_heatmap">roe_plot_heatmap</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.transform_roe_values" title="omicverse.utils.transform_roe_values">transform_roe_values</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.odds_ratio" title="omicverse.utils.odds_ratio">odds_ratio</a></span>
<span class="mkapi-dash">—</span>
Calculate odds ratios for each cell type comparing different sample groups.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_odds_ratio_heatmap" title="omicverse.utils.plot_odds_ratio_heatmap">plot_odds_ratio_heatmap</a></span>
<span class="mkapi-dash">—</span>
Plot heatmap of odds ratios for cell types across sample groups.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.shannon_diversity" title="omicverse.utils.shannon_diversity">shannon_diversity</a></span>
<span class="mkapi-dash">—</span>
Calculate Shannon diversity index for cell type composition across different groups/samples.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.compare_shannon_diversity" title="omicverse.utils.compare_shannon_diversity">compare_shannon_diversity</a></span>
<span class="mkapi-dash">—</span>
Compare Shannon diversity indices between groups using statistical tests.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_shannon_diversity" title="omicverse.utils.plot_shannon_diversity">plot_shannon_diversity</a></span>
<span class="mkapi-dash">—</span>
Plot Shannon diversity indices across groups.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.optimal_resolution" title="omicverse.utils.optimal_resolution">optimal_resolution</a></span>
<span class="mkapi-dash">—</span>
Find optimal clustering resolution by scanning different values and evaluating clustering quality.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_resolution_optimization" title="omicverse.utils.plot_resolution_optimization">plot_resolution_optimization</a></span>
<span class="mkapi-dash">—</span>
Plot resolution optimization results showing metrics vs resolution values.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.resolution_stability_analysis" title="omicverse.utils.resolution_stability_analysis">resolution_stability_analysis</a></span>
<span class="mkapi-dash">—</span>
Analyze clustering stability across different resolutions and random seeds.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.cal_paga" title="omicverse.utils.cal_paga">cal_paga</a></span>
<span class="mkapi-dash">—</span>
PAGA graph with velocity-directed edges.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.plot_paga" title="omicverse.utils.plot_paga">plot_paga</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.cluster" title="omicverse.utils.cluster">cluster</a></span>
<span class="mkapi-dash">—</span>
Perform clustering using various algorithms including Leiden, Louvain, GMM, K-means, and scICE.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.filtered" title="omicverse.utils.filtered">filtered</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.refine_label" title="omicverse.utils.refine_label">refine_label</a></span>
<span class="mkapi-dash">—</span>
Optimize the label by majority voting in the neighborhood.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.venny4py" title="omicverse.utils.venny4py">venny4py</a></span>
<span class="mkapi-dash">—</span>
Create Venn diagram for 2-4 sets.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.lsi" title="omicverse.utils.lsi">lsi</a></span>
<span class="mkapi-dash">—</span>
LSI analysis (following the Seurat v3 approach)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.tfidf" title="omicverse.utils.tfidf">tfidf</a></span>
<span class="mkapi-dash">—</span>
TF-IDF normalization (following the Seurat v3 approach)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.neighbors" title="omicverse.utils.neighbors">neighbors</a></span>
<span class="mkapi-dash">—</span>
Compute k nearest neighbors and affinity matrix, which will be used for diffmap and graph-based community detection algorithms.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.calc_kBET" title="omicverse.utils.calc_kBET">calc_kBET</a></span>
<span class="mkapi-dash">—</span>
Calculate the kBET metric of the data regarding a specific sample attribute and embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.calc_kSIM" title="omicverse.utils.calc_kSIM">calc_kSIM</a></span>
<span class="mkapi-dash">—</span>
Calculate the kSIM metric of the data regarding a specific sample attribute and embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.Agent" title="omicverse.utils.Agent">Agent</a></span>
<span class="mkapi-dash">—</span>
Create an OmicVerse Smart Agent instance.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.list_supported_models" title="omicverse.utils.list_supported_models">list_supported_models</a></span>
<span class="mkapi-dash">—</span>
List all supported models for OmicVerse Smart Agent.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle modules">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Modules</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.agent_backend" title="omicverse.utils.agent_backend">agent_backend</a></span>
<span class="mkapi-dash">—</span>
OmicVerse internal LLM backend (Pantheon replacement)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.smart_agent" title="omicverse.utils.smart_agent">smart_agent</a></span>
<span class="mkapi-dash">—</span>
OmicVerse Smart Agent (internal LLM backend)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.read">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.read" title="omicverse.utils.read">read</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">backend</span><span class="mkapi-equal">=</span><span class="mkapi-default">'python'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">path</span>
<span class="mkapi-dash">—</span>
The path of the file to read
backend: 'python' | 'rust'</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
AnnData-like object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.read_csv">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.read_csv" title="omicverse.utils.read_csv">read_csv</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.read_10x_mtx">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.read_10x_mtx" title="omicverse.utils.read_10x_mtx">read_10x_mtx</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.read_h5ad">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.read_h5ad" title="omicverse.utils.read_h5ad">read_h5ad</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.read_10x_h5">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.read_10x_h5" title="omicverse.utils.read_10x_h5">read_10x_h5</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.convert_to_pandas">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.convert_to_pandas" title="omicverse.utils.convert_to_pandas">convert_to_pandas</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">df_obj</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert PyDataFrameElem or similar objects to pandas DataFrame.</p>
<p>This is a utility function to convert Rust-based DataFrame objects
(like PyDataFrameElem from anndata-rs/SnapATAC2) to pandas DataFrames.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">df_obj</span>
<span class="mkapi-dash">—</span>
PyDataFrameElem or similar DataFrame-like object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">pandas.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
Converted DataFrame</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'data.h5ad'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'rust'</span><span class="p">)</span>
<span class="n">obs_df</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_df</span><span class="p">)</span>  <span class="c1"># Now displays as pandas DataFrame</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.download_CaDRReS_model">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.download_CaDRReS_model" title="omicverse.utils.download_CaDRReS_model">download_CaDRReS_model</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>load CaDRReS_model</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.download_GDSC_data">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.download_GDSC_data" title="omicverse.utils.download_GDSC_data">download_GDSC_data</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>load GDSC_data</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.download_pathway_database">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.download_pathway_database" title="omicverse.utils.download_pathway_database">download_pathway_database</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Download pathway and gene set databases for enrichment analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">None</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function downloads pathway databases to the genesets/ directory including GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Human, WikiPathways_2019_Mouse, and Reactome_2022.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.download_geneid_annotation_pair">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.download_geneid_annotation_pair" title="omicverse.utils.download_geneid_annotation_pair">download_geneid_annotation_pair</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Download gene ID annotation mapping files for various organisms.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">None</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function downloads mapping files to the genesets/ directory including pair_GRCm39.tsv (Mouse), pair_GRCh38.tsv (Human), pair_GRCh37.tsv (Human legacy), and pair_danRer11.tsv (Zebrafish).</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.gtf_to_pair_tsv">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.gtf_to_pair_tsv" title="omicverse.utils.gtf_to_pair_tsv">gtf_to_pair_tsv</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">gtf_path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_id_version</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert GTF file to gene ID mapping pairs TSV format.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">gtf_path</span>
<span class="mkapi-dash">—</span>
Path to input GTF file.</p>
</li>
<li>
<p><span class="mkapi-item-name">output_path</span>
<span class="mkapi-dash">—</span>
Path for output TSV file.</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_id_version</span>
<span class="mkapi-dash">—</span>
Whether to keep version numbers in gene IDs. Default: True.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">gene_count</span> <span class="mkapi-dash">—</span>
Number of genes processed and written to the output file.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Convert GTF to mapping pairs</span>
<span class="n">gene_count</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">gtf_to_pair_tsv</span><span class="p">(</span><span class="s1">'genes.gtf'</span><span class="p">,</span> <span class="s1">'gene_pairs.tsv'</span><span class="p">)</span>
<span class="c1"># Use converted file for gene mapping</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">bulk</span><span class="o">.</span><span class="n">Matrix_ID_mapping</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'gene_pairs.tsv'</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.download_tosica_gmt">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.download_tosica_gmt" title="omicverse.utils.download_tosica_gmt">download_tosica_gmt</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>load TOSICA gmt dataset</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_prepare">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_prepare" title="omicverse.utils.geneset_prepare">geneset_prepare</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">geneset_path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">organism</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Human'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load and prepare gene sets from GMT/TXT files for enrichment analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">geneset_path</span>
<span class="mkapi-dash">—</span>
Path of geneset file.</p>
</li>
<li>
<p><span class="mkapi-item-name">organism</span>
<span class="mkapi-dash">—</span>
Organism of geneset file. Default: 'Human'.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils._data.geneset_prepare.go_bio_dict">go_bio_dict</span></span> <span class="mkapi-dash">—</span>
A dictionary of geneset where keys are pathway names and values are lists of gene symbols.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.get_gene_annotation">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.get_gene_annotation" title="omicverse.utils.get_gene_annotation">get_gene_annotation</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_by</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gtf</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="os">os</span>.<span class="mkapi-tooltip" title="os.PathLike">PathLike</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gtf_by</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">by_func</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Callable">Callable</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Get genomic annotation of genes by joining with a GTF file.
It was writed by scglue, and I just copy it.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Input dataset.</p>
</li>
<li>
<p><span class="mkapi-item-name">var_by</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Specify a column in <code>adata.var</code> used to merge with GTF attributes,
otherwise <code>adata.var_names</code> is used by default.</p>
</li>
<li>
<p><span class="mkapi-item-name">gtf</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="os">os</span>.<span class="mkapi-tooltip" title="os.PathLike">PathLike</span></span> <span class="mkapi-dash">—</span>
Path to the GTF file.</p>
</li>
<li>
<p><span class="mkapi-item-name">gtf_by</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Specify a field in the GTF attributes used to merge with <code>adata.var</code>,
e.g. "gene_id", "gene_name".</p>
</li>
<li>
<p><span class="mkapi-item-name">by_func</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Callable">Callable</span>]</span> <span class="mkapi-dash">—</span>
Specify an element-wise function used to transform merging fields,
e.g. removing suffix in gene IDs.</p>
</li>
</ul>
</div>
<div class="mkapi-section-content">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The genomic locations are converted to 0-based as specified
in bed format rather than 1-based as specified in GTF format.</p>
</div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.correlation_pseudotime">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.correlation_pseudotime" title="omicverse.utils.correlation_pseudotime">correlation_pseudotime</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="scipy.sparse._matrix.spmatrix">spmatrix</span>]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">Y</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.utils._data.TestMethod">TestMethod</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="omicverse.utils._data.TestMethod">TestMethod</span>.<span class="mkapi-tooltip" title="omicverse.utils._data.TestMethod.FISHER">FISHER</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_perms</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seed</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">confidence_level</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.95</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Compute the correlation between rows in matrix <code>X</code> columns of matrix <code>Y</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">X</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="scipy.sparse._matrix.spmatrix">spmatrix</span>]</span> <span class="mkapi-dash">—</span>
Array or matrix of <code>(M, N)</code> elements.</p>
</li>
<li>
<p><span class="mkapi-item-name">Y</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span> <span class="mkapi-dash">—</span>
Array of <code>(N, K)</code> elements.</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils._data.TestMethod">TestMethod</span></span> <span class="mkapi-dash">—</span>
Method for p-value calculation.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_perms</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span> <span class="mkapi-dash">—</span>
Number of permutations if <code>method='perm_test'</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">seed</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span> <span class="mkapi-dash">—</span>
Random seed if <code>method = 'perm_test'</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">confidence_level</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Confidence level for the confidence interval calculation. Must be in <code>[0, 1]</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">kwargs</span>
<span class="mkapi-dash">—</span>
Keyword arguments for :func:<span class="mkapi-tooltip" title="cellrank._utils._parallelize.parallelize"><code>cellrank._utils._parallelize.parallelize</code></span>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">Correlations, p-values, corrected p-values, lower and upper bound of 95% confidence interval.</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span></p>
</li>
<li>
<p><span class="mkapi-item-name">Each array if of shape <code>(n\_genes, n\_lineages)</code>.</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">NotImplementedError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.store_layers">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.store_layers" title="omicverse.utils.store_layers">store_layers</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layers</span><span class="mkapi-equal">=</span><span class="mkapi-default">'counts'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Store the X matrix of AnnData in adata.uns for later retrieval.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name">layers</span>
<span class="mkapi-dash">—</span>
The layers name to store. Default: 'counts'.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function modifies adata.uns in place by storing the X matrix.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Store original counts before preprocessing</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">store_layers</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s1">'raw_counts'</span><span class="p">)</span>
<span class="c1"># Apply preprocessing</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="c1"># Retrieve original data if needed</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">retrieve_layers</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s1">'raw_counts'</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.retrieve_layers">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.retrieve_layers" title="omicverse.utils.retrieve_layers">retrieve_layers</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layers</span><span class="mkapi-equal">=</span><span class="mkapi-default">'counts'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Retrieve previously stored X matrix from adata.uns and restore to adata.X.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name">layers</span>
<span class="mkapi-dash">—</span>
The layers name to retrieve. Default: 'counts'.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
The function modifies adata.X in place by restoring the stored matrix.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Store original data before preprocessing</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">store_layers</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s1">'raw_counts'</span><span class="p">)</span>
<span class="c1"># Apply preprocessing</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="c1"># Retrieve original data</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">retrieve_layers</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s1">'raw_counts'</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.easter_egg">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.easter_egg" title="omicverse.utils.easter_egg">easter_egg</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.easter_egg.O" title="omicverse.utils.easter_egg.O">O</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.easter_egg.O">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.easter_egg" title="omicverse.utils.easter_egg">easter_egg</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.easter_egg.O" title="omicverse.utils.easter_egg.O">O</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.save">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.save" title="omicverse.utils.save">save</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">file</span><span class="mkapi-comma">, </span><span class="mkapi-arg">path</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Save object to file using pickle or cloudpickle.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.load">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.load" title="omicverse.utils.load">load</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">path</span><span class="mkapi-comma">, </span><span class="mkapi-arg">backend</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Load object from file using pickle or cloudpickle.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.convert_adata_for_rust">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.convert_adata_for_rust" title="omicverse.utils.convert_adata_for_rust">convert_adata_for_rust</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_file</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">close_file</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert AnnData object to be compatible with Rust backend using snapatac2.AnnData.</p>
<p>This function creates a new backed AnnData object using snapatac2.AnnData constructor,
ensuring full compatibility with Rust backend requirements. It handles:
- Proper sparse matrix formatting
- DataFrame compatibility
- Data type consistency
- Automatic unique name generation</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object to be converted (from Python backend)
output_file: Output h5ad file path. If None, uses temp file. Default: None
verbose: Whether to print conversion progress. Default: True
close_file: Whether to close the snapatac2 AnnData after creation. Default: True</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
output_file: Path to the converted h5ad file compatible with Rust backend</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span>
<span class="mkapi-dash">—</span>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Load old h5ad file with Python backend</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'old_data.h5ad'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'python'</span><span class="p">)</span>
<span class="c1"># Convert for Rust compatibility</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_adata_for_rust</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">'fixed_data.h5ad'</span><span class="p">)</span>
<span class="c1"># Now read with Rust backend</span>
<span class="n">adata_rust</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'rust'</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.anndata_sparse">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.anndata_sparse" title="omicverse.utils.anndata_sparse">anndata_sparse</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Set adata.X to csr_matrix</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">adata</span> <span class="mkapi-dash">—</span>
AnnData</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.np_mean">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.np_mean" title="omicverse.utils.np_mean">np_mean</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">array</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">axis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.np_std">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.np_std" title="omicverse.utils.np_std">np_std</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">array</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">axis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.load_signatures_from_file">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.load_signatures_from_file" title="omicverse.utils.load_signatures_from_file">load_signatures_from_file</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input_file</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.List">List</span>[str]]</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.patch_rust_adata">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.patch_rust_adata" title="omicverse.utils.patch_rust_adata">patch_rust_adata</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">apply_vector_api</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sync_index</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">patch_dataframe_access</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">patch_boolean_getitem</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">verbose</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Apply a collection of compatibility patches to an anndata-rs AnnData instance.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_set">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_set" title="omicverse.utils.plot_set">plot_set</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">verbosity</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">80</span><span class="mkapi-comma">, </span><span class="mkapi-arg">facecolor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'white'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">font_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ipython_format</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'retina'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi_save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">transparent</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scanpy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">14</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_map</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vector_friendly</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_monitor</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Configure plotting settings for OmicVerse.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">verbosity</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Scanpy verbosity level. Default: 3.
dpi: Resolution for matplotlib figures. Default: 80.
facecolor: Background color for figures. Default: 'white'.
font_path: Path to font for custom fonts. Default: None.
ipython_format: IPython display format. Default: 'retina'.
dpi_save: Resolution for saved figures. Default: 300.
transparent: Whether to use transparent background. Default: None.
scanpy: Whether to apply scanpy settings. Default: True.
fontsize: Default font size for plots. Default: 14.
color_map: Default color map for plots. Default: None.
figsize: Default figure size. Default: None.
vector_friendly: Control rasterization for vector-friendly plots. Default: True.</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None: The function configures global plotting settings and displays initialization information.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.pyomic_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.pyomic_palette" title="omicverse.utils.pyomic_palette">pyomic_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns the default OmicVerse color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of hex color codes for plotting</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.palette" title="omicverse.utils.palette">palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns the default OmicVerse color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of hex color codes for plotting</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.blue_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.blue_palette" title="omicverse.utils.blue_palette">blue_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns a blue-themed color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of blue-themed hex color codes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.orange_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.orange_palette" title="omicverse.utils.orange_palette">orange_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns an orange-themed color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of orange-themed hex color codes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.red_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.red_palette" title="omicverse.utils.red_palette">red_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns a red-themed color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of red-themed hex color codes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.green_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.green_palette" title="omicverse.utils.green_palette">green_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns a green-themed color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list</span> <span class="mkapi-dash">—</span>
List of green-themed hex color codes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_text_set">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_text_set" title="omicverse.utils.plot_text_set">plot_text_set</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">text</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_knock</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_maxsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Format text for plotting by adding line breaks.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">text</span>
<span class="mkapi-dash">—</span>
Text string to format
text_knock: Number of words between line breaks (2)
text_maxsize: Maximum text length before formatting (20)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Formatted text string with line breaks</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.ticks_range">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.ticks_range" title="omicverse.utils.ticks_range">ticks_range</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">x</span><span class="mkapi-comma">, </span><span class="mkapi-arg">width</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate tick positions for multi-group plots.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">x</span>
<span class="mkapi-dash">—</span>
Number of ticks
width: Width spacing between ticks</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
List of tick positions</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_boxplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_boxplot" title="omicverse.utils.plot_boxplot">plot_boxplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hue</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_value</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_value</span><span class="mkapi-comma">, </span><span class="mkapi-arg">width</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.6</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-equal">=</span><span class="mkapi-default">(1, 0.55)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create boxplot with jittered points for grouped data.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span>
<span class="mkapi-dash">—</span>
DataFrame containing the data to plot
hue: Column name for grouping variable
x_value: Column name for x-axis categories
y_value: Column name for y-axis values
width: Width of boxplots (0.6)
title: Plot title ('')
figsize: Figure size ((6,3))
palette: List of colors (None)
fontsize: Font size for labels (10)
legend_bbox: Legend bounding box ((1, 0.55))
legend_ncol: Number of legend columns (1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Tuple of (figure, axes) objects</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_network" title="omicverse.utils.plot_network">plot_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">G</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="networkx">nx</span>.<span class="mkapi-tooltip" title="networkx.classes.graph.Graph">Graph</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">G_type_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">G_color_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'spring'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_dim</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_k</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.6</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_linewidths</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_node</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_node_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_verticalalignment</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'center_baseline'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontfamily</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Arial'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_bbox</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.7, 0.05)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot network graph with customizable node and edge properties.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">G</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="networkx">nx</span>.<span class="mkapi-tooltip" title="networkx.classes.graph.Graph">Graph</span></span> <span class="mkapi-dash">—</span>
NetworkX graph object
G_type_dict: Dictionary mapping nodes to types
G_color_dict: Dictionary mapping nodes to colors
pos_type: Layout algorithm - 'spring' or 'kamada_kawai' ('spring')
pos_dim: Layout dimension - 2 or 3 (2)
figsize: Figure size ((4,4))
pos_scale: Layout scale factor (10)
pos_k: Spring layout k parameter (None)
pos_alpha: Edge transparency (0.4)
node_size: Base node size (50)
node_alpha: Node transparency (0.6)
node_linewidths: Node border width (1)
plot_node: Specific nodes to label (None)
plot_node_num: Number of top degree nodes to label (20)
label_verticalalignment: Label vertical alignment ('center_baseline')
label_fontsize: Label font size (12)
label_fontfamily: Label font family ('Arial')
label_fontweight: Label font weight ('bold')
label_bbox: Label bounding box properties (None)
legend_bbox: Legend position ((0.7, 0.05))
legend_ncol: Legend columns (3)
legend_fontsize: Legend font size (12)
legend_fontweight: Legend font weight ('bold')</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Tuple of (figure, axes) objects</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_cellproportion">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_cellproportion" title="omicverse.utils.plot_cellproportion">plot_cellproportion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_clusters</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">visual_clusters</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">visual_li</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">visual_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot stacked bar chart showing cell type proportions across groups.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object
celltype_clusters: Column name for cell types
visual_clusters: Column name for grouping variable
visual_li: List of groups to plot (None)
visual_name: Label for x-axis ('')
figsize: Figure size ((4,6))
ticks_fontsize: Font size for tick labels (12)
labels_fontsize: Font size for axis labels (12)
legend: Whether to show legend (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Tuple of (figure, axes) objects</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_embedding_celltype">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_embedding_celltype" title="omicverse.utils.plot_embedding_celltype">plot_embedding_celltype</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(6, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'major_celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(2, 9)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embedding_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlim</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1000</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Create combined embedding plot with cell type legend and counts.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object
figsize: Figure size ((6,4))
basis: Embedding basis name ('umap')
celltype_key: Column name for cell types ('major_celltype')
title: Plot title (None)
celltype_range: Grid range for cell type panel ((2,9))
embedding_range: Grid range for embedding panel ((3,10))
xlim: X-axis limit for counts (-1000)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Tuple of (figure, [embedding_axis, celltype_axis])</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pseudotime</span><span class="mkapi-comma">, </span><span class="mkapi-arg">resolution</span><span class="mkapi-equal">=</span><span class="mkapi-default">1000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 10)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud.get" title="omicverse.utils.geneset_wordcloud.get">get</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud.get_geneset" title="omicverse.utils.geneset_wordcloud.get_geneset">get_geneset</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud.get_wordcloud" title="omicverse.utils.geneset_wordcloud.get_wordcloud">get_wordcloud</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud.plot" title="omicverse.utils.geneset_wordcloud.plot">plot</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.geneset_wordcloud.plot_heatmap" title="omicverse.utils.geneset_wordcloud.plot_heatmap">plot_heatmap</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud.get">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud.get" title="omicverse.utils.geneset_wordcloud.get">get</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud.get_geneset">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud.get_geneset" title="omicverse.utils.geneset_wordcloud.get_geneset">get_geneset</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud.get_wordcloud">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud.get_wordcloud" title="omicverse.utils.geneset_wordcloud.get_wordcloud">get_wordcloud</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud.plot">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud.plot" title="omicverse.utils.geneset_wordcloud.plot">plot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.geneset_wordcloud.plot_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.geneset_wordcloud" title="omicverse.utils.geneset_wordcloud">geneset_wordcloud</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.geneset_wordcloud.plot_heatmap" title="omicverse.utils.geneset_wordcloud.plot_heatmap">plot_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">n_convolve</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figwidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'RdBu_r'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cbar</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cbar_kws</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cbar_fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_pca_variance_ratio">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_pca_variance_ratio" title="omicverse.utils.plot_pca_variance_ratio">plot_pca_variance_ratio</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'scaled|original|pca_var_ratios'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_pcs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot PCA variance ratio to determine optimal number of principal components.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing PCA results.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span>
<span class="mkapi-dash">—</span>
Key in adata.uns for variance ratios. Default: 'scaled|original|pca_var_ratios'.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_pcs</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of principal components to plot. Default: 30.</p>
</li>
<li>
<p><span class="mkapi-item-name">log</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to use logarithmic scale. Default: False.</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span>
<span class="mkapi-dash">—</span>
Show the figure. Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span>
<span class="mkapi-dash">—</span>
Save the figure to file. Default: None.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
Displays or saves the PCA variance ratio plot.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Basic PCA variance ratio plot</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_pca_variance_ratio</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="c1"># Custom variance ratios with log scale</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_pca_variance_ratio</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.gen_mpl_labels">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.gen_mpl_labels" title="omicverse.utils.gen_mpl_labels">gen_mpl_labels</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">exclude</span><span class="mkapi-equal">=</span><span class="mkapi-default">()</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Add cluster labels at median positions in embedding plots with automatic text positioning.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data.
groupby: Column name for grouping in adata.obs.
exclude: Groups to exclude from labeling. Default: ().
basis: Embedding basis name in adata.obsm. Default: 'X_umap'.
ax: Matplotlib axes object. Default: None.
adjust_kwargs: Parameters for adjustText text adjustment. Default: None.
text_kwargs: Parameters for text styling (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.mde">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.mde" title="omicverse.utils.mde">mde</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span>, <span class="mkapi-tooltip" title="scipy.sparse._matrix.spmatrix">spmatrix</span>, <span class="mkapi-tooltip" title="omicverse.utils._mde.torch">torch</span>.Tensor]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">device</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Literal">Literal</span>['cpu', 'cuda']]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span></span>
</p>
<div class="mkapi-document">
<p>Util to run :func:<span class="mkapi-tooltip" title="pymde.recipes.preserve_neighbors"><code>pymde.preserve_neighbors</code></span> for visualization of scvi-tools embeddings.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, <span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span>, <span class="mkapi-tooltip" title="scipy.sparse._matrix.spmatrix">spmatrix</span>, <span class="mkapi-tooltip" title="omicverse.utils._mde.torch">torch</span>.<span class="mkapi-tooltip" title="torch._tensor.Tensor">Tensor</span>]</span> <span class="mkapi-dash">—</span>
The data of shape (n_obs, k), where k is typically defined by one of the models
in scvi-tools that produces an embedding (e.g., :class:<code>~scvi.model.SCVI</code>.)</p>
</li>
<li>
<p><span class="mkapi-item-name">device</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Literal">Literal</span>['cpu', 'cuda']]</span> <span class="mkapi-dash">—</span>
Whether to run on cpu or gpu ("cuda"). If None, tries to run on gpu if available.</p>
</li>
<li>
<p><span class="mkapi-item-name">kwargs</span>
<span class="mkapi-dash">—</span>
Keyword args to :func:<span class="mkapi-tooltip" title="pymde.recipes.preserve_neighbors"><code>pymde.preserve_neighbors</code></span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span></span> <span class="mkapi-dash">—</span>
The pymde embedding, defaults to two dimensions.</p>
</li>
</ul>
</div>
<div class="mkapi-section-content">
<div class="admonition note">
<p class="admonition-title">Notes</p>
<p>This function is included in scvi-tools to provide an alternative to UMAP/TSNE that is GPU-
accelerated. The appropriateness of use of visualization of high-dimensional spaces in single-
cell omics remains an open research questions. See:</p>
<p>Chari, Tara, Joeyta Banerjee, and Lior Pachter. "The specious art of single-cell genomics." bioRxiv (2021).</p>
<p>If you use this function in your research please cite:</p>
<p>Agrawal, Akshay, Alnur Ali, and Stephen Boyd. "Minimum-distortion embedding." arXiv preprint arXiv:2103.02559 (2021).</p>
</div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">adata</span> <span class="o">=</span> <span class="n">anndata</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="n">path_to_anndata</span><span class="p">)</span>
<span class="n">scvi</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">SCVI</span><span class="o">.</span><span class="n">setup_anndata</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">batch_key</span><span class="o">=</span><span class="s2">"batch"</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">scvi</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">SCVI</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">"X_scVI"</span><span class="p">]</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_latent_representation</span><span class="p">()</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">"X_mde"</span><span class="p">]</span> <span class="o">=</span> <span class="n">scvi</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">mde</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">"X_scVI"</span><span class="p">])</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.pancreas">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.pancreas" title="omicverse.utils.pancreas">pancreas</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">file_path</span><span class="mkapi-equal">=</span><span class="mkapi-default">'data/Pancreas/endocrinogenesis_day15.h5ad'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Pancreatic endocrinogenesis.</p>
<p>Data from <code>Bastidas-Ponce et al. (2019) &lt;https://doi.org/10.1242/dev.173849&gt;</code>__.</p>
<p>Pancreatic epithelial and Ngn3-Venus fusion (NVF) cells during secondary transition
with transcriptome profiles sampled from embryonic day 15.5.</p>
<p>Endocrine cells are derived from endocrine progenitors located in the pancreatic
epithelium. Endocrine commitment terminates in four major fates: glucagon- producing
α-cells, insulin-producing β-cells, somatostatin-producing δ-cells and
ghrelin-producing ε-cells.</p>
<p>.. image:: https://user-images.githubusercontent.com/31883718/67709134-a0989480-f9bd-11e9-8ae6-f6391f5d95a0.png
   :width: 600px</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">file_path</span>
<span class="mkapi-dash">—</span>
Path where to save dataset and read it from.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>Returns <span class="mkapi-tooltip" title="omicverse.utils._syn.pancreas.adata"><code>adata</code></span> object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.synthetic_iid">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.synthetic_iid" title="omicverse.utils.synthetic_iid">synthetic_iid</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">batch_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">200</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10000</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_proteins</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_regions</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_batches</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_labels</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dropout_ratio</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.7</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sparse_format</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.diffmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.diffmap" title="omicverse.utils.diffmap">diffmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in Diffusion Map basis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">{adata_color_etc}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{scatter_bulk}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{show_save_ax}</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
If <code>show==False</code> a :class:<code>~matplotlib.axes.Axes</code> or a list of it.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<p>.. plot::
    :context: close-figs</p>
<div class="highlight"><pre><span></span><code>import scanpy as sc
adata = sc.datasets.pbmc68k_reduced()
sc.tl.diffmap(adata)
sc.pl.diffmap(adata, color='bulk_labels')
</code></pre></div>
<p>.. currentmodule:: scanpy</p>
</div>
<div class="mkapi-section-content">
<div class="admonition info">
<p class="admonition-title">See Also</p>
<p>tl.diffmap</p>
</div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.draw_graph">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.draw_graph" title="omicverse.utils.draw_graph">draw_graph</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layout</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in graph-drawing basis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">{adata_color_etc}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">layout</span>
<span class="mkapi-dash">—</span>
One of the :func:<code>~scanpy.tl.draw_graph</code> layouts.
By default, the last computed layout is used.</p>
</li>
<li>
<p><span class="mkapi-item-name">{edges_arrows}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{scatter_bulk}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{show_save_ax}</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
If <code>show==False</code> a :class:<code>~matplotlib.axes.Axes</code> or a list of it.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<p>.. plot::
    :context: close-figs</p>
<div class="highlight"><pre><span></span><code>import scanpy as sc
adata = sc.datasets.pbmc68k_reduced()
sc.tl.draw_graph(adata)
sc.pl.draw_graph(adata, color=['phase', 'bulk_labels'])
</code></pre></div>
<p>.. currentmodule:: scanpy</p>
</div>
<div class="mkapi-section-content">
<div class="admonition info">
<p class="admonition-title">See Also</p>
<p>tl.draw_graph</p>
</div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.embedding">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.embedding" title="omicverse.utils.embedding">embedding</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort_order</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'grey'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">neighbors_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrows</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrows_kwds</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">components</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dimensions</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">projection</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Literal">Literal</span>['2d', '3d']</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'2d'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_map</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], <span class="mkapi-tooltip" title="cycler.Cycler">Cycler</span>, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="scanpy.plotting._utils.ColorLike">ColorLike</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">'lightgray'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_in_legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">frameon</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, float, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontSize">_FontSize</span>, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontWeight">_FontWeight</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'right margin'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontoutline</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'right'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmin</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vcenter</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">norm</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_outline</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">outline_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.3, 0.05)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">outline_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[str, str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">('black', 'white')</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hspace</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">wspace</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">marker</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'.'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrow_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrow_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.005</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot for user specified embedding basis (e.g. umap, pca, etc).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix
basis: Name of the obsm basis to use
color: Keys for annotations of observations/cells or variables/genes (None)
gene_symbols: Column name in .var DataFrame for gene symbols (None)
use_raw: Whether to use .raw attribute of adata (None)
sort_order: Sort order for points by color values (True)
edges: Whether to draw edges of graph (False)
edges_width: Width of edges (0.1)
edges_color: Color of edges ('grey')
neighbors_key: Key to use for neighbors (None)
arrows: Whether to draw arrows (False) 
arrows_kwds: Keywords for arrow plotting (None)
groups: Restrict to a subset of groups (None)
components: Components to plot (None)
dimensions: Dimensions to plot (None)
layer: Layer to use for coloring (None)
projection: Projection type - '2d' or '3d' ('2d')
scale_factor: Scaling factor for spatial coordinates (None)
color_map: Colormap for continuous variables (None)
cmap: Alias for color_map (None)
palette: Colors to use for categorical variables (None)
na_color: Color for missing values ('lightgray')
na_in_legend: Include missing values in legend (True)
size: Point size (None)
frameon: Draw frame around plot (None)
legend_fontsize: Font size for legend (None)
legend_fontweight: Font weight for legend ('bold')
legend_loc: Location of legend ('right margin')
legend_fontoutline: Font outline width for legend (None)
colorbar_loc: Location of colorbar ('right')
vmax: Maximum color scale value (None)
vmin: Minimum color scale value (None)
vcenter: Center color scale value (None)
norm: Normalization for color scale (None)
add_outline: Add outline to points (False)
outline_width: Width of outline (0.3, 0.05)
outline_color: Color of outline ('black', 'white')
ncols: Number of columns for multi-panel plots (4)
hspace: Height spacing between subplots (0.25)
wspace: Width spacing between subplots (None)
title: Plot title (None)
show: Show the plot (None)
save: Save the plot (None)
ax: Matplotlib axes object (None)
return_fig: Return figure object (None)
marker: Marker style ('.') 
**kwargs: Additional arguments passed to scatter</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Matplotlib axes or figure object if show=False</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.pca">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.pca" title="omicverse.utils.pca">pca</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">annotate_var_explained</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in PCA coordinates.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">annotate_var_explained</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Annotate explained variance (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Show the plot (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">return_fig</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Return figure object (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span> <span class="mkapi-dash">—</span>
Save the plot (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to embedding function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
Matplotlib axes or list of axes if show=False</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">KeyError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.spatial">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.spatial" title="omicverse.utils.spatial">spatial</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'spatial'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, None, <span class="mkapi-tooltip" title="scanpy._utils.Empty">Empty</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="scanpy._utils._empty">_empty</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">library_id</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, None, <span class="mkapi-tooltip" title="scanpy._utils.Empty">Empty</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="scanpy._utils._empty">_empty</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">crop_coord</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int, int, int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha_img</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spot_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.ColorLike">ColorLike</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in spatial coordinates.</p>
<p>This function allows overlaying data on top of images.
Use the parameter <code>img_key</code> to see the image in the background
And the parameter <code>library_id</code> to select the image.
By default, <code>'hires'</code> and <code>'lowres'</code> are attempted.</p>
<p>Use <span class="mkapi-tooltip" title="omicverse.utils._scatterplot.spatial.crop_coord"><code>crop_coord</code></span>, <code>alpha_img</code>, and <code>bw</code> to control how it is displayed.
Use <code>size</code> to scale the size of the Visium spots plotted on top.</p>
<p>As this function is designed to for imaging data, there are two key assumptions
about how coordinates are handled:</p>
<ol>
<li>
<p>The origin (e.g <code>(0, 0)</code>) is at the top left – as is common convention
with image data.</p>
</li>
<li>
<p>Coordinates are in the pixel space of the source image, so an equal
aspect ratio is assumed.</p>
</li>
</ol>
<p>If your anndata object has a <code>"spatial"</code> entry in <code>.uns</code>, the <code>img_key</code>
and <code>library_id</code> parameters to find values for <code>img</code>, <span class="mkapi-tooltip" title="omicverse.utils._scatterplot.spatial.scale_factor"><code>scale_factor</code></span>,
and <span class="mkapi-tooltip" title="omicverse.utils._scatterplot.spatial.spot_size"><code>spot_size</code></span> arguments. Alternatively, these values be passed directly.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">{adata_color_etc}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{scatter_spatial}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{scatter_bulk}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">{show_save_ax}</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
If <code>show==False</code> a :class:<code>~matplotlib.axes.Axes</code> or a list of it.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<p>This function behaves very similarly to other embedding plots like
:func:<code>~scanpy.pl.umap</code></p>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">visium_sge</span><span class="p">(</span><span class="s2">"Targeted_Visium_Human_Glioblastoma_Pan_Cancer"</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">calculate_qc_metrics</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"log1p_n_genes_by_counts"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="mkapi-section-content">
<div class="admonition info">
<p class="admonition-title">See Also</p>
<p>:func:<span class="mkapi-tooltip" title="scanpy.datasets._datasets.visium_sge"><code>scanpy.datasets.visium_sge</code></span>
    Example visium data.
:tutorial:<code>spatial/basic-analysis</code>
    Tutorial on spatial analysis.</p>
</div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.tsne">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.tsne" title="omicverse.utils.tsne">tsne</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in tSNE basis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to embedding function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
Matplotlib axes or list of axes if show=False</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.umap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.umap" title="omicverse.utils.umap">umap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot in UMAP basis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to embedding function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, <span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>], None]</span> <span class="mkapi-dash">—</span>
Matplotlib axes or list of axes if show=False</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.weighted_knn_trainer">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.weighted_knn_trainer" title="omicverse.utils.weighted_knn_trainer">weighted_knn_trainer</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">train_adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">train_adata_emb</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="sklearn.neighbors._graph.KNeighborsTransformer">KNeighborsTransformer</span></span></span>
</p>
<div class="mkapi-document">
<p>Trains a weighted KNN classifier on <code>train_adata</code>.</p>
<p>Arguments
    train_adata: :Annotated dataset to be used to train KNN classifier with <code>label_key</code> as the target variable.
    train_adata_emb: Name of the obsm layer to be used for calculation of neighbors. If set to "X", anndata.X will be used
    n_neighbors: Number of nearest neighbors in KNN classifier.</p>
<p>Returns
    k_neighbors_transformer: KNeighborsTransformer</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.weighted_knn_transfer">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.weighted_knn_transfer" title="omicverse.utils.weighted_knn_transfer">weighted_knn_transfer</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">query_adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">query_adata_emb</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ref_adata_obs</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_keys</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">knn_model</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="sklearn.neighbors._graph.KNeighborsTransformer">KNeighborsTransformer</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pred_unknown</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">mode</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'package'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Annotates <code>query_adata</code> cells with an input trained weighted KNN classifier.</p>
<p>Arguments
    query_adata: Annotated dataset to be used to queryate KNN classifier. Embedding to be used
    query_adata_emb: Name of the obsm layer to be used for label transfer. If set to "X", query_adata.X will be used
    ref_adata_obs: obs of ref Anndata
    label_keys: Names of the columns to be used as target variables (e.g. cell_type) in <code>query_adata</code>.
    knn_model: knn model trained on reference adata with weighted_knn_trainer function
    threshold: Threshold of uncertainty used to annotating cells as "Unknown". cells with uncertainties higher than this value will be annotated as "Unknown". Set to 1 to keep all predictions. This enables one to later on play with thresholds.
    pred_unknown: <code>False</code> by default. Whether to annotate any cell as "unknown" or not. If <code>False</code>, <code>threshold</code> will not be used and each cell will be annotated with the label which is the most common in its <code>n_neighbors</code> nearest cells.
    mode: Has to be one of "paper" or "package". If mode is set to "package", uncertainties will be 1 - P(pred_label), otherwise it will be 1 - P(true_label).</p>
<p>Returns
    pred_labels: Dataframe with predicted labels for each cell in <code>query_adata</code>.
    uncertainties: Dataframe with uncertainties for each cell in <code>query_adata</code>.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">Exception</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.adjust_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.adjust_palette" title="omicverse.utils.adjust_palette">adjust_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">palette</span><span class="mkapi-comma">, </span><span class="mkapi-arg">length</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Adjust palette to match required length.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
Input color palette
length: Required number of colors</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Adjusted color palette</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.clip">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.clip" title="omicverse.utils.clip">clip</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">c</span><span class="mkapi-comma">, </span><span class="mkapi-arg">perc</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Clip values to specified percentile range.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">c</span>
<span class="mkapi-dash">—</span>
Values to clip
perc: Percentile range for clipping</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Clipped values</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.default_color">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.default_color" title="omicverse.utils.default_color">default_color</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_outline</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get default color for plotting based on available metadata.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object
add_outline: Outline parameter (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Default color key string</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.default_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.default_palette" title="omicverse.utils.default_palette">default_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get default color palette for plotting.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
Input palette (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Cycler object with color palette</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.get_colors">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.get_colors" title="omicverse.utils.get_colors">get_colors</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">c</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get colors for categorical or continuous variables.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object
c: Color specification</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Array of colors</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.interpret_colorkey">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.interpret_colorkey" title="omicverse.utils.interpret_colorkey">interpret_colorkey</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">c</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">perc</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Interpret color key specification for plotting.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object
c: Color key specification (None)
layer: Layer to use for gene expression (None)
perc: Percentile clipping values (None)
use_raw: Whether to use raw data (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Interpreted color values</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.is_categorical">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.is_categorical" title="omicverse.utils.is_categorical">is_categorical</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">c</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if data or column is categorical.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span>
<span class="mkapi-dash">—</span>
Data object to check
c: Column name to check (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Boolean indicating if data/column is categorical</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.is_list">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.is_list" title="omicverse.utils.is_list">is_list</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">key</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if key is a list-like object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
Object to check</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Boolean indicating if key is list-like</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.is_list_of_str">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.is_list_of_str" title="omicverse.utils.is_list_of_str">is_list_of_str</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_len</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if key is a list of strings.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
Object to check
max_len: Maximum length allowed (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Boolean indicating if key is list of strings</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.is_list_or_array">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.is_list_or_array" title="omicverse.utils.is_list_or_array">is_list_or_array</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">key</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if key is a list or array-like object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
Object to check</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Boolean indicating if key is list or array-like</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.is_view">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.is_view" title="omicverse.utils.is_view">is_view</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if AnnData object is a view.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Boolean indicating if adata is a view</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.make_dense">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.make_dense" title="omicverse.utils.make_dense">make_dense</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert sparse matrix to dense array.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">X</span>
<span class="mkapi-dash">—</span>
Input matrix (sparse or dense)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Dense numpy array</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_heatmap" title="omicverse.utils.plot_heatmap">plot_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_names</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sortby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'latent_time'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Ms'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_map</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'RdBu_r'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'viridis'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_convolve</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">row_cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">context</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">font_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(8, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot time series for genes as heatmap.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">var_names</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Names of variables to use for the plot</p>
</li>
<li>
<p><span class="mkapi-item-name">sortby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Observation key to extract time data from ('latent_time')</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Layer key to extract count data from ('Ms')</p>
</li>
<li>
<p><span class="mkapi-item-name">color_map</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
String denoting matplotlib color map ('RdBu_r')</p>
</li>
<li>
<p><span class="mkapi-item-name">col_color</span>
<span class="mkapi-dash">—</span>
String denoting matplotlib color map to use along columns (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Colors to use for plotting groups ('viridis')</p>
</li>
<li>
<p><span class="mkapi-item-name">n_convolve</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
If int is given, data is smoothed by convolution (30)</p>
</li>
<li>
<p><span class="mkapi-item-name">standard_scale</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Either 0 (rows) or 1 (columns) for standardization (0)</p>
</li>
<li>
<p><span class="mkapi-item-name">sort</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to sort the expression values (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">colorbar</span>
<span class="mkapi-dash">—</span>
Whether to show colorbar (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">col_cluster</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If True, cluster the columns (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">row_cluster</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If True, cluster the rows (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">context</span>
<span class="mkapi-dash">—</span>
Dictionary of parameters or preconfigured set name (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">font_scale</span>
<span class="mkapi-dash">—</span>
Scaling factor to scale the size of font elements (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
Figure size ((8, 4))</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span>
<span class="mkapi-dash">—</span>
Show the plot, do not return axis (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span>
<span class="mkapi-dash">—</span>
If True or str, save the figure (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">kwargs</span>
<span class="mkapi-dash">—</span>
Arguments passed to seaborn's clustermap</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>Matplotlib clustermap object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.set_colors_for_categorical_obs">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.set_colors_for_categorical_obs" title="omicverse.utils.set_colors_for_categorical_obs">set_colors_for_categorical_obs</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">value_to_plot</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Set colors for categorical observation in AnnData object.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object
value_to_plot: Name of valid categorical observation
palette: Color palette specification (None)
    Can be matplotlib colormap string, sequence of colors,
    or cycler object with 'color' key</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None (modifies adata.uns in place)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.strings_to_categoricals">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.strings_to_categoricals" title="omicverse.utils.strings_to_categoricals">strings_to_categoricals</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Transform string annotations to categoricals.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None (modifies adata in place)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.to_list">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.to_list" title="omicverse.utils.to_list">to_list</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_len</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert key to list format.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
Object to convert
max_len: Maximum length allowed (20)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
List representation of key</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.roe">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.roe" title="omicverse.utils.roe">roe</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expected_value_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">order</span><span class="mkapi-equal">=</span><span class="mkapi-default">'F'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate the ratio of observed cell number to expected cell number (Ro/e) for each cell type in each sample.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key for sample information in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key for cell type information in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">pval_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Threshold for p-value. Default: 0.05.</p>
</li>
<li>
<p><span class="mkapi-item-name">expected_value_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Threshold for expected value. Default: 5.</p>
</li>
<li>
<p><span class="mkapi-item-name">order</span>
<span class="mkapi-dash">—</span>
Order of columns in the contingency table. Default: "F".</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">Ro/e</span> <span class="mkapi-dash">—</span>
results in a DataFrame.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.roe_plot_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.roe_plot_heatmap" title="omicverse.utils.roe_plot_heatmap">roe_plot_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">display_numbers</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">center_value</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_scheme</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'cool'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">custom_colors</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_order</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.transform_roe_values">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.transform_roe_values" title="omicverse.utils.transform_roe_values">transform_roe_values</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">roe</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.odds_ratio">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.odds_ratio" title="omicverse.utils.odds_ratio">odds_ratio</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">sample_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reference_group</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">confidence_level</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.95</span><span class="mkapi-comma">, </span><span class="mkapi-arg">correction_method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bonferroni'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate odds ratios for each cell type comparing different sample groups.</p>
<p>This function performs pairwise comparisons between sample groups for each cell type,
calculating odds ratios and confidence intervals using Fisher's exact test.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing cell type and sample information.</p>
</li>
<li>
<p><span class="mkapi-item-name">sample_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key for sample/group information in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key for cell type information in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">reference_group</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Reference group for comparison. If None, uses the first group alphabetically.</p>
</li>
<li>
<p><span class="mkapi-item-name">confidence_level</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Confidence level for intervals (default: 0.95).</p>
</li>
<li>
<p><span class="mkapi-item-name">correction_method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Multiple testing correction method ('bonferroni', 'fdr_bh', or 'none').</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame containing odds ratios, confidence intervals, and p-values for each comparison.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="c1"># Load data</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc3k_processed</span><span class="p">()</span>

<span class="c1"># Add mock sample groups for demonstration</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">'condition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">'Control'</span><span class="p">,</span> <span class="s1">'Treatment'</span><span class="p">],</span> <span class="n">adata</span><span class="o">.</span><span class="n">n_obs</span><span class="p">)</span>

<span class="c1"># Calculate odds ratios</span>
<span class="n">or_results</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">odds_ratio</span><span class="p">(</span>
    <span class="n">adata</span><span class="p">,</span> 
    <span class="n">sample_key</span><span class="o">=</span><span class="s1">'condition'</span><span class="p">,</span> 
    <span class="n">cell_type_key</span><span class="o">=</span><span class="s1">'louvain'</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">or_results</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_odds_ratio_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_odds_ratio_heatmap" title="omicverse.utils.plot_odds_ratio_heatmap">plot_odds_ratio_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(10, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_ci</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">significance_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'RdBu_r'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Plot heatmap of odds ratios for cell types across sample groups.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object with odds ratio results stored in .uns.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span> <span class="mkapi-dash">—</span>
Figure size as (width, height).</p>
</li>
<li>
<p><span class="mkapi-item-name">log_scale</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to plot log2-transformed odds ratios.</p>
</li>
<li>
<p><span class="mkapi-item-name">show_ci</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to annotate confidence intervals.</p>
</li>
<li>
<p><span class="mkapi-item-name">significance_threshold</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
P-value threshold for significance marking.</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Colormap for the heatmap.</p>
</li>
<li>
<p><span class="mkapi-item-name">save_path</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Path to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.shannon_diversity">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.shannon_diversity" title="omicverse.utils.shannon_diversity">shannon_diversity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'natural'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">calculate_evenness</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Calculate Shannon diversity index for cell type composition across different groups/samples.</p>
<p>The Shannon diversity index measures the diversity of cell types within each sample/group.
Higher values indicate more diverse cell type compositions.</p>
<p>H = -Σ(p_i * ln(p_i))
where p_i is the proportion of cells of type i</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing cell type and group information.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs for grouping samples (e.g., 'condition', 'sample_id').</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs for cell type labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">base</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Base for logarithm calculation ('natural', '2', '10').</p>
</li>
<li>
<p><span class="mkapi-item-name">calculate_evenness</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to calculate Shannon evenness (equitability).</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
    DataFrame with Shannon diversity indices for each group.</p>
<p>Examples:
    <div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="c1"># Load data</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc3k_processed</span><span class="p">()</span>

<span class="c1"># Add mock condition groups</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">'condition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">'Control'</span><span class="p">,</span> <span class="s1">'Treatment'</span><span class="p">],</span> <span class="n">adata</span><span class="o">.</span><span class="n">n_obs</span><span class="p">)</span>

<span class="c1"># Calculate Shannon diversity</span>
<span class="n">diversity_results</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">shannon_diversity</span><span class="p">(</span>
    <span class="n">adata</span><span class="p">,</span> 
    <span class="n">groupby</span><span class="o">=</span><span class="s1">'condition'</span><span class="p">,</span> 
    <span class="n">cell_type_key</span><span class="o">=</span><span class="s1">'louvain'</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diversity_results</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.compare_shannon_diversity">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.compare_shannon_diversity" title="omicverse.utils.compare_shannon_diversity">compare_shannon_diversity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">test_method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'kruskal'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">base</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'natural'</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Dict">Dict</span></span></span>
</p>
<div class="mkapi-document">
<p>Compare Shannon diversity indices between groups using statistical tests.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs for grouping samples.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_type_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Key in adata.obs for cell type labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">test_method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Statistical test to use ('kruskal', 'mann_whitney', 'ttest').</p>
</li>
<li>
<p><span class="mkapi-item-name">base</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Base for logarithm calculation.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Dict">Dict</span></span> <span class="mkapi-dash">—</span>
Dictionary containing test results and diversity values.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_shannon_diversity">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_shannon_diversity" title="omicverse.utils.plot_shannon_diversity">plot_shannon_diversity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">metric</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'shannon_diversity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(8, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_stats</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Plot Shannon diversity indices across groups.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object with diversity results stored in .uns.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Grouping variable for plot. If None, uses stored results.</p>
</li>
<li>
<p><span class="mkapi-item-name">metric</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Which diversity metric to plot ('shannon_diversity', 'shannon_evenness', 'simpson_diversity').</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span> <span class="mkapi-dash">—</span>
Figure size as (width, height).</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Color palette for the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">show_stats</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show statistical comparisons.</p>
</li>
<li>
<p><span class="mkapi-item-name">save_path</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Path to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.optimal_resolution">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.optimal_resolution" title="omicverse.utils.optimal_resolution">optimal_resolution</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">resolution_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.1, 2.0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_resolutions</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustering_method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">metric</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'silhouette'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key_added</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">42</span><span class="mkapi-comma">, </span><span class="mkapi-arg">copy</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, <span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Find optimal clustering resolution by scanning different values and evaluating clustering quality.</p>
<p>This function tests multiple resolution values and selects the one that optimizes
the chosen clustering quality metric (silhouette score or modularity).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object with computed neighborhood graph.</p>
</li>
<li>
<p><span class="mkapi-item-name">resolution_range</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span> <span class="mkapi-dash">—</span>
Tuple of (min_resolution, max_resolution) to test.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_resolutions</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of resolution values to test within the range.</p>
</li>
<li>
<p><span class="mkapi-item-name">clustering_method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering algorithm to use ('leiden' or 'louvain').</p>
</li>
<li>
<p><span class="mkapi-item-name">metric</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Evaluation metric ('silhouette', 'modularity', or 'both').</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Representation to use for silhouette calculation (e.g., 'X_pca', 'X_umap').</p>
</li>
<li>
<p><span class="mkapi-item-name">key_added</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Key to store optimal clustering results in adata.obs.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Random state for reproducibility.</p>
</li>
<li>
<p><span class="mkapi-item-name">copy</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to return a copy of adata.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">If copy=True, returns AnnData object with optimal clustering.</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
If copy=False, modifies adata in place and returns optimal resolution value.</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="c1"># Load and preprocess data</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc3k_processed</span><span class="p">()</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="c1"># Find optimal resolution</span>
<span class="n">optimal_res</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">optimal_resolution</span><span class="p">(</span>
    <span class="n">adata</span><span class="p">,</span> 
    <span class="n">resolution_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">'silhouette'</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Optimal resolution: </span><span class="si">{</span><span class="n">optimal_res</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_resolution_optimization">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_resolution_optimization" title="omicverse.utils.plot_resolution_optimization">plot_resolution_optimization</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(12, 5)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Plot resolution optimization results showing metrics vs resolution values.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object with resolution optimization results in .uns.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]</span> <span class="mkapi-dash">—</span>
Figure size as (width, height).</p>
</li>
<li>
<p><span class="mkapi-item-name">save_path</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Path to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.resolution_stability_analysis">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.resolution_stability_analysis" title="omicverse.utils.resolution_stability_analysis">resolution_stability_analysis</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">resolution_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.1, 2.0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_resolutions</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clustering_method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_iterations</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">42</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Analyze clustering stability across different resolutions and random seeds.</p>
<p>This function tests clustering reproducibility by running the same resolution
multiple times with different random seeds and measuring consistency.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object with computed neighborhood graph.</p>
</li>
<li>
<p><span class="mkapi-item-name">resolution_range</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span> <span class="mkapi-dash">—</span>
Tuple of (min_resolution, max_resolution) to test.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_resolutions</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of resolution values to test.</p>
</li>
<li>
<p><span class="mkapi-item-name">clustering_method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering algorithm to use ('leiden' or 'louvain').</p>
</li>
<li>
<p><span class="mkapi-item-name">n_iterations</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of random iterations per resolution.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Representation to use for consistency calculations.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Base random state.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span> <span class="mkapi-dash">—</span>
DataFrame with stability metrics for each resolution.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.cal_paga">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.cal_paga" title="omicverse.utils.cal_paga">cal_paga</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_time_prior</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">root_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">end_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold_root_end_prior</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">minimum_spanning_tree</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">copy</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>PAGA graph with velocity-directed edges.</p>
<p>Mapping out the coarse-grained connectivity structures of complex manifolds
:cite:p:<code>Wolf19</code>. By quantifying the connectivity of partitions (groups, clusters) of the
single-cell graph, partition-based graph abstraction (PAGA) generates a much
simpler abstracted graph (<em>PAGA graph</em>) of partitions, in which edge weights
represent confidence in the presence of connections.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type">:class:<code>~anndata.&lt;span class="mkapi-tooltip" title="anndata._core.anndata.AnnData"&gt;AnnData&lt;/span&gt;</code></span> <span class="mkapi-dash">—</span>
An annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">groups</span> : 
<span class="mkapi-item-type">key for categorical in <code>[adata][__mkapi__.omicverse.utils._paga.cal_paga.adata].obs</code>, optional (default: 'louvain')</span> <span class="mkapi-dash">—</span>
You can pass your predefined groups by choosing any categorical
annotation of observations (<code>adata.obs</code>).</p>
</li>
<li>
<p><span class="mkapi-item-name">vkey</span> : 
<span class="mkapi-item-type"><code>str</code> or <code>None</code> (default: <code>None</code>)</span> <span class="mkapi-dash">—</span>
Key for annotations of observations/cells or variables/genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_time_prior</span> : 
<span class="mkapi-item-type"><code>str</code> or bool, optional (default: True)</span> <span class="mkapi-dash">—</span>
Obs key for pseudo-time values.
If True, 'velocity_pseudotime' is used if available.</p>
</li>
<li>
<p><span class="mkapi-item-name">root_key</span> : 
<span class="mkapi-item-type"><code>str</code> or bool, optional (default: None)</span> <span class="mkapi-dash">—</span>
Obs key for root states.</p>
</li>
<li>
<p><span class="mkapi-item-name">end_key</span> : 
<span class="mkapi-item-type"><code>str</code> or bool, optional (default: None)</span> <span class="mkapi-dash">—</span>
Obs key for end states.</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold_root_end_prior</span> : 
<span class="mkapi-item-type"><code>float</code> (default: 0.9)</span> <span class="mkapi-dash">—</span>
Threshold for root and final states priors, to be in the range of [0,1].
Values above the threshold will be considered as terminal and included as prior.</p>
</li>
<li>
<p><span class="mkapi-item-name">minimum_spanning_tree</span> : 
<span class="mkapi-item-type">bool, optional (default: True)</span> <span class="mkapi-dash">—</span>
Whether to prune the tree such that a path from A-to-B
is removed if another more confident path exists.</p>
</li>
<li>
<p><span class="mkapi-item-name">copy</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional (default: <code>False</code>)</span> <span class="mkapi-dash">—</span>
Copy <span class="mkapi-tooltip" title="omicverse.utils._paga.cal_paga.adata"><code>adata</code></span> before computation and return a copy.
Otherwise, perform computation inplace and return <code>None</code>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">connectivities</span> : 
<span class="mkapi-item-type"><code>.uns</code></span> <span class="mkapi-dash">—</span>
The full adjacency matrix of the abstracted graph, weights correspond to
confidence in the connectivities of partitions.</p>
</li>
<li>
<p><span class="mkapi-item-name">connectivities_tree</span> : 
<span class="mkapi-item-type"><code>.uns</code></span> <span class="mkapi-dash">—</span>
The adjacency matrix of the tree-like subgraph that best explains the topology.</p>
</li>
<li>
<p><span class="mkapi-item-name">transitions_confidence</span> : 
<span class="mkapi-item-type"><code>.uns</code></span> <span class="mkapi-dash">—</span>
The adjacency matrix of the abstracted directed graph, weights correspond to
confidence in the transitions between partitions.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.plot_paga">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.plot_paga" title="omicverse.utils.plot_paga">plot_paga</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layout</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layout_kwds</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">init_pos</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">root</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">single_component</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dashed_edges</span><span class="mkapi-equal">=</span><span class="mkapi-default">'connectivities'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">solid_edges</span><span class="mkapi-equal">=</span><span class="mkapi-default">'transitions_confidence'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">transitions</span><span class="mkapi-equal">=</span><span class="mkapi-default">'transitions_confidence'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_size_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_size_power</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_edge_width</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_edge_width</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrowsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normalize_to_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cb_kwds</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_pos</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">export_to_gexf</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">components</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scatter_flag</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.PAGA_tree">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.PAGA_tree" title="omicverse.utils.PAGA_tree">PAGA_tree</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vkey</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_time_prior</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">root_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">end_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold_root_end_prior</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">minimum_spanning_tree</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base"><span class="mkapi-tooltip" title="scanpy.tools._paga.PAGA">PAGA</span></span></p></p>
<p>TODO.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.PAGA_tree.compute_transitions" title="omicverse.utils.PAGA_tree.compute_transitions">compute_transitions</a></span>
<span class="mkapi-dash">—</span>
TODO.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.PAGA_tree.compute_transitions">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.PAGA_tree" title="omicverse.utils.PAGA_tree">PAGA_tree</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.PAGA_tree.compute_transitions" title="omicverse.utils.PAGA_tree.compute_transitions">compute_transitions</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>TODO.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.cluster">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.cluster" title="omicverse.utils.cluster">cluster</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'leiden'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1024</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_components</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Perform clustering using various algorithms including Leiden, Louvain, GMM, K-means, and scICE.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object containing single-cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Clustering algorithm to use - 'leiden', 'louvain', 'GMM', 'kmeans', 'mclust', 'schist', or 'scICE'. Default: 'leiden'.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_rep</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Representation in adata.obsm to use for clustering. Default: 'X_pca'.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Random seed for reproducibility. Default: 1024.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_components</span>
<span class="mkapi-dash">—</span>
Number of clusters (required for GMM and kmeans). Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional arguments passed to the clustering algorithm.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>For scICE method, returns the scICE model object. Otherwise returns None and adds cluster labels to adata.obs.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Leiden clustering (recommended)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'leiden'</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="c1"># Gaussian Mixture Model clustering</span>
<span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'GMM'</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># scICE ensemble clustering</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'scICE'</span><span class="p">,</span> <span class="n">resolution_range</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.LDA_topic">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.LDA_topic" title="omicverse.utils.LDA_topic">LDA_topic</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">feature_type</span><span class="mkapi-equal">=</span><span class="mkapi-default">'expression'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">highly_variable_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'highly_variable_features'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layers</span><span class="mkapi-equal">=</span><span class="mkapi-default">'counts'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">batch_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">learning_rate</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.001</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ondisk</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Latent Dirichlet Allocation (LDA) topic modeling for single-cell data using MIRA.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object containing single-cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name">feature_type</span>
<span class="mkapi-dash">—</span>
Type of features to use. Default: 'expression'.</p>
</li>
<li>
<p><span class="mkapi-item-name">highly_variable_key</span>
<span class="mkapi-dash">—</span>
Key in adata.var for highly variable features. Default: 'highly_variable_features'.</p>
</li>
<li>
<p><span class="mkapi-item-name">layers</span>
<span class="mkapi-dash">—</span>
Layer in adata.layers containing count data. Default: 'counts'.</p>
</li>
<li>
<p><span class="mkapi-item-name">batch_key</span>
<span class="mkapi-dash">—</span>
Column in adata.obs for batch correction. Default: None.</p>
</li>
<li>
<p><span class="mkapi-item-name">learning_rate</span>
<span class="mkapi-dash">—</span>
Learning rate for optimization. Default: 1e-3.</p>
</li>
<li>
<p><span class="mkapi-item-name">ondisk</span>
<span class="mkapi-dash">—</span>
Whether to use on-disk datasets for large data. Default: False.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils._cluster.LDA_topic">LDA_topic</span></span> <span class="mkapi-dash">—</span>
Object with methods for topic modeling analysis.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Basic LDA topic modeling</span>
<span class="n">LDA_obj</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">LDA_topic</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="s1">'expression'</span><span class="p">,</span>
                             <span class="n">layers</span><span class="o">=</span><span class="s1">'counts'</span><span class="p">)</span>
<span class="c1"># Determine optimal number of topics</span>
<span class="n">LDA_obj</span><span class="o">.</span><span class="n">plot_topic_contributions</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># Fit model and predict topics</span>
<span class="n">LDA_obj</span><span class="o">.</span><span class="n">predicted</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1"># Advanced classification with Random Forest</span>
<span class="n">LDA_obj</span><span class="o">.</span><span class="n">get_results_rfc</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">use_rep</span><span class="o">=</span><span class="s1">'X_pca'</span><span class="p">,</span> <span class="n">LDA_threshold</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.LDA_topic.plot_topic_contributions" title="omicverse.utils.LDA_topic.plot_topic_contributions">plot_topic_contributions</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.LDA_topic.predicted" title="omicverse.utils.LDA_topic.predicted">predicted</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.LDA_topic.get_results_rfc" title="omicverse.utils.LDA_topic.get_results_rfc">get_results_rfc</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.LDA_topic.plot_topic_contributions">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.LDA_topic" title="omicverse.utils.LDA_topic">LDA_topic</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.LDA_topic.plot_topic_contributions" title="omicverse.utils.LDA_topic.plot_topic_contributions">plot_topic_contributions</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">num_topics</span><span class="mkapi-equal">=</span><span class="mkapi-default">6</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.LDA_topic.predicted">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.LDA_topic" title="omicverse.utils.LDA_topic">LDA_topic</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.LDA_topic.predicted" title="omicverse.utils.LDA_topic.predicted">predicted</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">num_topics</span><span class="mkapi-equal">=</span><span class="mkapi-default">6</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.LDA_topic.get_results_rfc">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.LDA_topic" title="omicverse.utils.LDA_topic">LDA_topic</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.LDA_topic.get_results_rfc" title="omicverse.utils.LDA_topic.get_results_rfc">get_results_rfc</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">LDA_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_topics</span><span class="mkapi-equal">=</span><span class="mkapi-default">6</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.filtered">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.filtered" title="omicverse.utils.filtered">filtered</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_minsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.refine_label">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.refine_label" title="omicverse.utils.refine_label">refine_label</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_rep</span><span class="mkapi-equal">=</span><span class="mkapi-default">'spatial'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">radius</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'label'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Optimize the label by majority voting in the neighborhood.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
an Anndata object, after normalization.</p>
</li>
<li>
<p><span class="mkapi-item-name">radius</span>
<span class="mkapi-dash">—</span>
the radius of the neighborhood.</p>
</li>
<li>
<p><span class="mkapi-item-name">key</span>
<span class="mkapi-dash">—</span>
the key in <code>.obs</code> that corresponds to the cluster labels.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.venny4py">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.venny4py" title="omicverse.utils.venny4py">venny4py</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">sets</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">out</span><span class="mkapi-equal">=</span><span class="mkapi-default">'./'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ce</span><span class="mkapi-equal">=</span><span class="mkapi-default">'bgrc'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">asax</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ext</span><span class="mkapi-equal">=</span><span class="mkapi-default">'png'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-equal">=</span><span class="mkapi-default">300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-equal">=</span><span class="mkapi-default">3.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bbox_to_anchor</span><span class="mkapi-equal">=</span><span class="mkapi-default">(0.5, 0.99)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nc</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cs</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create Venn diagram for 2-4 sets.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">sets</span>
<span class="mkapi-dash">—</span>
Dictionary of set names to sets ({})
out: Output directory ('./')
ce: Colors for ellipses ('bgrc')
asax: Use existing axes (False)
ext: File extension ('png')
dpi: Resolution for saved figure (300)
size: Figure size (3.5)
bbox_to_anchor: Legend position ((.5, .99))
nc: Number of legend columns (2)
cs: Column spacing (4)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Matplotlib figure and axes objects</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.lsi">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.lsi" title="omicverse.utils.lsi">lsi</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_components</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_highly_variable</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>LSI analysis (following the Seurat v3 approach)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Input dataset</p>
</li>
<li>
<p><span class="mkapi-item-name">n_components</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of dimensions to use</p>
</li>
<li>
<p><span class="mkapi-item-name">use_highly_variable</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Whether to use highly variable features only, stored in
<code>adata.var['highly_variable']</code>. By default uses them if they
have been determined beforehand.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments are passed to
:func:<span class="mkapi-tooltip" title="sklearn.utils.extmath.randomized_svd"><code>sklearn.utils.extmath.randomized_svd</code></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.tfidf">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.tfidf" title="omicverse.utils.tfidf">tfidf</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.utils._lsi.Array">Array</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="omicverse.utils._lsi.Array">Array</span></span></span>
</p>
<div class="mkapi-document">
<p>TF-IDF normalization (following the Seurat v3 approach)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">X</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils._lsi.Array">Array</span></span> <span class="mkapi-dash">—</span>
Input matrix</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">X_tfidf</span> <span class="mkapi-dash">—</span>
TF-IDF normalized matrix</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.neighbors">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.neighbors" title="omicverse.utils.neighbors">neighbors</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">K</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_comps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">full_speed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_cache</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dist</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'l2'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'hnsw'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">exact_k</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Compute k nearest neighbors and affinity matrix, which will be used for diffmap and graph-based community detection algorithms.</p>
<p>The kNN calculation uses <code>hnswlib &lt;https://github.com/nmslib/hnswlib&gt;</code><em> introduced by [Malkov16]</em>.</p>
<p>K is determined by min(K, sqrt(data.shape[0])).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><code>pegasusio.MultimodalData</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix with rows for cells and columns for genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">K</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>100</code></span> <span class="mkapi-dash">—</span>
Number of neighbors, including the data point itself.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"pca"</code></span> <span class="mkapi-dash">—</span>
Embedding representation used to calculate kNN. If <code>None</code>, use <code>data.X</code>; otherwise, keyword <code>'X_' + rep</code> must exist in <code>data.obsm</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_comps</span> : 
<span class="mkapi-item-type"><code>int</code>, optional (default: None)</span> <span class="mkapi-dash">—</span>
Number of components to be used in the <span class="mkapi-tooltip" title="omicverse.utils._neighboors.neighbors.rep"><code>rep</code></span>. If n_comps == None, use all components; otherwise, use the minimum of n_comps and rep's dimensions.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_jobs</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>-1</code></span> <span class="mkapi-dash">—</span>
Number of threads to use. If <code>-1</code>, use all physical CPU cores.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>0</code></span> <span class="mkapi-dash">—</span>
Random seed set for reproducing results.</p>
</li>
<li>
<p><span class="mkapi-item-name">full_speed</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>False</code></span> <span class="mkapi-dash">—</span>
* If <code>True</code>, use multiple threads in constructing <code>hnsw</code> index. However, the kNN results are not reproducible.
* Otherwise, use only one thread to make sure results are reproducible.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_cache</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>False</code></span> <span class="mkapi-dash">—</span>
* If <code>True</code> and found cached knn results, Pegasus will use cached results and do not recompute.
* Otherwise, compute kNN irrespective of caching status.</p>
</li>
<li>
<p><span class="mkapi-item-name">dist</span> : 
<span class="mkapi-item-type"><code>str</code>, optional (default: <code>"l2"</code>)</span> <span class="mkapi-dash">—</span>
Distance metric to use. By default, use squared L2 distance. Available options, <code>"l2"</code> or inner product <code>"ip"</code> or cosine similarity <code>"cosine"</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span> : 
<span class="mkapi-item-type"><code>str</code>, optional (default: <code>"hnsw"</code>)</span> <span class="mkapi-dash">—</span>
Choose from "hnsw" or "sklearn". "hnsw" uses HNSW algorithm for approximate nearest neighbor search and "sklearn" uses sklearn package for exact nearest neighbor search.</p>
</li>
<li>
<p><span class="mkapi-item-name">exact_k</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional (default: <code>False</code>)</span> <span class="mkapi-dash">—</span>
If True, use exactly the K passed to the function; otherwise K is determined as min(K, sqrt(X.shape[0])).</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><code>None</code></span></p>
</li>
<li>
<p><span class="mkapi-item-name">Update <code>data.obsm</code></span>
<span class="mkapi-dash">—</span>
* <code>data.obsm[rep + "_knn_indices"]</code>: kNN index matrix. Row i is the index list of kNN of cell i (excluding itself), sorted from nearest to farthest.
* <code>data.obsm[rep + "_knn_distances"]</code>: kNN distance matrix. Row i is the distance list of kNN of cell i (excluding itselt), sorted from smallest to largest.</p>
</li>
<li>
<p><span class="mkapi-item-name">Update <code>data.obsp</code></span>
<span class="mkapi-dash">—</span>
* <code>data.obsp["W_" + rep]</code>: kNN graph of the data in terms of affinity matrix.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.calc_kBET">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.calc_kBET" title="omicverse.utils.calc_kBET">calc_kBET</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">attr</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">K</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temp_folder</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_cache</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float, float]</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the kBET metric of the data regarding a specific sample attribute and embedding.</p>
<p>The kBET metric is defined in [Büttner18]_, which measures if cells from different samples mix well in their local neighborhood.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><code>pegasusio.MultimodalData</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix with rows for cells and columns for genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">attr</span> : 
<span class="mkapi-item-type"><code>str</code></span> <span class="mkapi-dash">—</span>
The sample attribute to consider. Must exist in <code>data.obs</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"pca"</code></span> <span class="mkapi-dash">—</span>
The embedding representation to be used. The key <code>'X_' + rep</code> must exist in <code>data.obsm</code>. By default, use PCA coordinates.</p>
</li>
<li>
<p><span class="mkapi-item-name">K</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>25</code></span> <span class="mkapi-dash">—</span>
Number of nearest neighbors, using L2 metric.</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>0.05</code></span> <span class="mkapi-dash">—</span>
Acceptance rate threshold. A cell is accepted if its kBET p-value is greater than or equal to <code>alpha</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_jobs</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>-1</code></span> <span class="mkapi-dash">—</span>
Number of threads used. If <code>-1</code>, use all physical CPU cores.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>0</code></span> <span class="mkapi-dash">—</span>
Random seed set for reproducing results.</p>
</li>
<li>
<p><span class="mkapi-item-name">temp_folder</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>None</code></span> <span class="mkapi-dash">—</span>
Temporary folder for joblib execution.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_cache</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>True</code></span> <span class="mkapi-dash">—</span>
If use cache results for kNN.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">stat_mean</span> : 
<span class="mkapi-item-type"><code>float</code></span> <span class="mkapi-dash">—</span>
Mean kBET chi-square statistic over all cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue_mean</span> : 
<span class="mkapi-item-type"><code>float</code></span> <span class="mkapi-dash">—</span>
Mean kBET p-value over all cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">accept_rate</span> : 
<span class="mkapi-item-type"><code>float</code></span> <span class="mkapi-dash">—</span>
kBET Acceptance rate of the sample.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">calc_kBET</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="s1">'Channel'</span><span class="p">)</span>
</code></pre></div>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">calc_kBET</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="s1">'Channel'</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="s1">'umap'</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.calc_kSIM">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.calc_kSIM" title="omicverse.utils.calc_kSIM">calc_kSIM</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">attr</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rep</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'pca'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">K</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_rate</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.9</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_jobs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">random_state</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_cache</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span></span>
</p>
<div class="mkapi-document">
<p>Calculate the kSIM metric of the data regarding a specific sample attribute and embedding.</p>
<p>The kSIM metric is defined in [Li20]_, which measures if a sample attribute is not diffused too much in each cell's local neighborhood.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><code>pegasusio.MultimodalData</code></span> <span class="mkapi-dash">—</span>
Annotated data matrix with rows for cells and columns for genes.</p>
</li>
<li>
<p><span class="mkapi-item-name">attr</span> : 
<span class="mkapi-item-type"><code>str</code></span> <span class="mkapi-dash">—</span>
The sample attribute to consider. Must exist in <code>data.obs</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">rep</span> : 
<span class="mkapi-item-type"><code>str</code>, optional, default: <code>"pca"</code></span> <span class="mkapi-dash">—</span>
The embedding representation to consider. The key <code>'X_' + rep</code> must exist in <code>data.obsm</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">K</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>25</code></span> <span class="mkapi-dash">—</span>
The number of nearest neighbors to be considered.</p>
</li>
<li>
<p><span class="mkapi-item-name">min_rate</span> : 
<span class="mkapi-item-type"><code>float</code>, optional, default: <code>0.9</code></span> <span class="mkapi-dash">—</span>
Acceptance rate threshold. A cell is accepted if its kSIM rate is larger than or equal to <code>min_rate</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_jobs</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>-1</code></span> <span class="mkapi-dash">—</span>
Number of threads used. If <code>-1</code>, use all physical CPU cores.</p>
</li>
<li>
<p><span class="mkapi-item-name">random_state</span> : 
<span class="mkapi-item-type"><code>int</code>, optional, default: <code>0</code></span> <span class="mkapi-dash">—</span>
Random seed set for reproducing results.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_cache</span> : 
<span class="mkapi-item-type"><code>bool</code>, optional, default: <code>True</code></span> <span class="mkapi-dash">—</span>
If use cache results for kNN.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">kSIM_mean</span> : 
<span class="mkapi-item-type"><code>float</code></span> <span class="mkapi-dash">—</span>
Mean kSIM rate over all the cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">kSIM_accept_rate</span> : 
<span class="mkapi-item-type"><code>float</code></span> <span class="mkapi-dash">—</span>
kSIM Acceptance rate of the sample.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">calc_kSIM</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="s1">'cell_type'</span><span class="p">)</span>
</code></pre></div>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">pg</span><span class="o">.</span><span class="n">calc_kSIM</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="s1">'cell_type'</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="s1">'umap'</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.agent_backend">
<span class="mkapi-object-link">
<a href="../../../src/omicverse/utils/#omicverse.utils.agent_backend" title="Go to source">source</a>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">module</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.agent_backend" title="omicverse.utils.agent_backend">agent_backend</a></span>
</p>
<div class="mkapi-document">
<p>OmicVerse internal LLM backend (Pantheon replacement)</p>
<p>This module provides a lightweight, provider-agnostic backend to call LLMs
directly, removing the dependency on the Pantheon framework. It is intentionally
minimal: it sends a system prompt plus the user prompt to the selected model
and returns the text content of the response.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle design goals">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Design goals</span>
</p>
<div class="mkapi-section-content">
<ul>
<li>Keep public behavior in smart_agent.py intact (system + user messages → text)</li>
<li>Support OpenAI and OpenAI-compatible providers out of the box</li>
<li>GPT-5 series uses OpenAI Responses API with 'instructions' + 'input' parameters</li>
<li>Provide graceful fallbacks and clear error messages for other providers</li>
<li>Allow configuration of model parameters (max_tokens, temperature)</li>
</ul>
</div>
<div class="mkapi-section-content">
<p>Note: Network calls require the relevant provider API keys to be present in the
environment, or passed explicitly to the backend constructor. This file does not
introduce any runtime dependency on Pantheon.</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.BackendConfig">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">dataclass</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.BackendConfig" title="omicverse.utils.BackendConfig">BackendConfig</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">endpoint</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">system_prompt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8192</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temperature</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_retry_attempts</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_base_delay</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_backoff_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_jitter</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseLLMBackend">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseLLMBackend" title="omicverse.utils.OmicVerseLLMBackend">OmicVerseLLMBackend</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">system_prompt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">endpoint</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">8192</span><span class="mkapi-comma">, </span><span class="mkapi-arg">temperature</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_retry_attempts</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_base_delay</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_backoff_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">retry_jitter</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Simple, async LLM client used by the OmicVerse Agent.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">system_prompt</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Instructions injected as the system message for each request</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Model identifier (must be recognized by ModelConfig)</p>
</li>
<li>
<p><span class="mkapi-item-name">api_key</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Provider API key; falls back to environment variables if omitted</p>
</li>
<li>
<p><span class="mkapi-item-name">endpoint</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Custom base URL (used to override default OpenAI-compatible routes)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_tokens</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Maximum tokens in model response (default: 8192)</p>
</li>
<li>
<p><span class="mkapi-item-name">temperature</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
Sampling temperature for model output (default: 0.2)</p>
</li>
<li>
<p><span class="mkapi-item-name">max_retry_attempts</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Maximum number of retry attempts on transient failures (default: 3)</p>
</li>
<li>
<p><span class="mkapi-item-name">retry_base_delay</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
Base delay in seconds for exponential backoff (default: 1.0)</p>
</li>
<li>
<p><span class="mkapi-item-name">retry_backoff_factor</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
Exponential backoff multiplier (default: 2.0)</p>
</li>
<li>
<p><span class="mkapi-item-name">retry_jitter</span> : 
<span class="mkapi-item-type">float, optional</span> <span class="mkapi-dash">—</span>
Maximum jitter factor as proportion of delay (default: 0.5)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseLLMBackend.run" title="omicverse.utils.OmicVerseLLMBackend.run">run</a></span>
<span class="mkapi-dash">—</span>
Run an LLM completion and return the response text.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseLLMBackend.stream" title="omicverse.utils.OmicVerseLLMBackend.stream">stream</a></span>
<span class="mkapi-dash">—</span>
Stream LLM completion tokens as they arrive.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseLLMBackend.run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">async method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseLLMBackend" title="omicverse.utils.OmicVerseLLMBackend">OmicVerseLLMBackend</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseLLMBackend.run" title="omicverse.utils.OmicVerseLLMBackend.run">run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">self</span><span class="mkapi-comma">, </span><span class="mkapi-arg">user_prompt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>Run an LLM completion and return the response text.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseLLMBackend.stream">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">async method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseLLMBackend" title="omicverse.utils.OmicVerseLLMBackend">OmicVerseLLMBackend</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseLLMBackend.stream" title="omicverse.utils.OmicVerseLLMBackend.stream">stream</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">self</span><span class="mkapi-comma">, </span><span class="mkapi-arg">user_prompt</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Stream LLM completion tokens as they arrive.</p>
<p>Yields text deltas from the model response. For providers that don't support
streaming, yields the complete response as a single chunk.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">user_prompt</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The user's input prompt</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle yields">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Yields</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Text delta (chunk) from the streaming response</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">backend</span> <span class="o">=</span> <span class="n">OmicVerseLLMBackend</span><span class="p">(</span><span class="n">system_prompt</span><span class="o">=</span><span class="s2">"..."</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">"gpt-4o"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">backend</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s2">"Analyze this data"</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.Usage">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">dataclass</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.Usage" title="omicverse.utils.Usage">Usage</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">input_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">output_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">total_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">model</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">provider</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Token usage statistics for a model completion.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle attributes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Attributes</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">input_tokens</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of tokens in the prompt/input</p>
</li>
<li>
<p><span class="mkapi-item-name">output_tokens</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of tokens in the generated response</p>
</li>
<li>
<p><span class="mkapi-item-name">total_tokens</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Total tokens used (input + output)</p>
</li>
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Model identifier that generated this usage</p>
</li>
<li>
<p><span class="mkapi-item-name">provider</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Provider name (openai, anthropic, google, dashscope, etc.)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.smart_agent">
<span class="mkapi-object-link">
<a href="../../../src/omicverse/utils/#omicverse.utils.smart_agent" title="Go to source">source</a>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">module</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.smart_agent" title="omicverse.utils.smart_agent">smart_agent</a></span>
</p>
<div class="mkapi-document">
<p>OmicVerse Smart Agent (internal LLM backend)</p>
<p>This module provides a smart agent that can understand natural language requests
and automatically execute appropriate OmicVerse functions. It now uses a built-in
LLM backend (see <code>agent_backend.py</code>) instead of the external Pantheon framework.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle usage">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Usage</span>
</p>
<div class="mkapi-section-content">
<p>import omicverse as ov
result = ov.Agent("quality control with nUMI&gt;500, mito&lt;0.2", adata)</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.Agent">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.Agent" title="omicverse.utils.Agent">Agent</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'gemini-2.5-flash'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">endpoint</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_reflection</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reflection_iterations</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_result_review</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_notebook_execution</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_prompts_per_session</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">notebook_storage_dir</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keep_execution_notebooks</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">notebook_timeout</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">600</span><span class="mkapi-comma">, </span><span class="mkapi-arg">strict_kernel_validation</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_filesystem_context</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">context_storage_dir</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="omicverse.utils.smart_agent.OmicVerseAgent">OmicVerseAgent</span></span></span>
</p>
<div class="mkapi-document">
<p>Create an OmicVerse Smart Agent instance.</p>
<p>This function creates and returns a smart agent that can execute OmicVerse functions
based on natural language descriptions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
LLM model to use (default: "gemini-2.5-flash"). Use list_supported_models() to see all options</p>
</li>
<li>
<p><span class="mkapi-item-name">api_key</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
API key for the model provider. If not provided, will use environment variable</p>
</li>
<li>
<p><span class="mkapi-item-name">endpoint</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Custom API endpoint. If not provided, will use default for the provider</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_reflection</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable reflection step to review and improve generated code (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">reflection_iterations</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Maximum number of reflection iterations (default: 1, range: 1-3)</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_result_review</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable result review to validate output matches user intent (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_notebook_execution</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Execute code in separate Jupyter notebook for isolation and debugging (default: True).
Set to False to use legacy in-process execution.</p>
</li>
<li>
<p><span class="mkapi-item-name">max_prompts_per_session</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Number of prompts to execute in same notebook session before restart (default: 5).
This prevents memory bloat while maintaining context for iterative analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name">notebook_storage_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Directory to store session notebooks. Defaults to ~/.ovagent/sessions</p>
</li>
<li>
<p><span class="mkapi-item-name">keep_execution_notebooks</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Whether to keep session notebooks after execution (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">notebook_timeout</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Execution timeout in seconds (default: 600)</p>
</li>
<li>
<p><span class="mkapi-item-name">strict_kernel_validation</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
If True, raise error if kernel not found. If False, fall back to python3 kernel (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_filesystem_context</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable filesystem-based context management for offloading intermediate results,
plans, and notes to disk. This reduces context window usage and enables
selective context retrieval. Default: True.</p>
</li>
<li>
<p><span class="mkapi-item-name">context_storage_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Directory for storing context files. Defaults to ~/.ovagent/context/</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils.smart_agent.OmicVerseAgent">OmicVerseAgent</span></span> <span class="mkapi-dash">—</span>
Configured agent instance ready for use</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="c1"># Create agent instance with full validation (default, session-based execution)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">)</span>

<span class="c1"># Create agent with multiple reflection iterations</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">reflection_iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create agent without validation (fastest execution)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">enable_reflection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enable_result_review</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Disable notebook execution (use legacy in-process execution)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">use_notebook_execution</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Maximum isolation (new session per prompt)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">max_prompts_per_session</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Longer sessions for complex workflows</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">max_prompts_per_session</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Custom storage directory</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-5"</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">"your-key"</span><span class="p">,</span> <span class="n">notebook_storage_dir</span><span class="o">=</span><span class="s2">"~/my_project/sessions"</span><span class="p">)</span>

<span class="c1"># Load data</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc3k</span><span class="p">()</span>

<span class="c1"># Use agent for quality control</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"quality control with nUMI&gt;500, mito&lt;0.2"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>

<span class="c1"># Use agent for preprocessing</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"preprocess with 2000 highly variable genes"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>

<span class="c1"># Use agent for clustering</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"leiden clustering resolution=1.0"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>

<span class="c1"># Check session info</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_current_session_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Session: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'session_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">, Prompts: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'prompt_count'</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'max_prompts'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">model</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'gemini-2.5-flash'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">api_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">endpoint</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_reflection</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reflection_iterations</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_result_review</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_notebook_execution</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_prompts_per_session</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">notebook_storage_dir</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keep_execution_notebooks</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">notebook_timeout</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">600</span><span class="mkapi-comma">, </span><span class="mkapi-arg">strict_kernel_validation</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enable_filesystem_context</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">context_storage_dir</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Intelligent agent for OmicVerse function discovery and execution.</p>
<p>This agent uses an internal LLM backend to understand natural language
requests and automatically execute appropriate OmicVerse functions.</p>
<p>Initialize the OmicVerse Smart Agent.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle usage">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Usage</span>
</p>
<div class="mkapi-section-content">
<p>agent = ov.Agent(api_key="your-api-key")  # Uses gemini-2.5-flash by default
result_adata = agent.run("quality control with nUMI&gt;500, mito&lt;0.2", adata)</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">model</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
LLM model to use for reasoning (default: "gemini-2.5-flash")</p>
</li>
<li>
<p><span class="mkapi-item-name">api_key</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
API key for the model provider. If not provided, will use environment variable</p>
</li>
<li>
<p><span class="mkapi-item-name">endpoint</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Custom API endpoint. If not provided, will use default for the provider</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_reflection</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable reflection step to review and improve generated code (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">reflection_iterations</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Maximum number of reflection iterations (default: 1, range: 1-3)</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_result_review</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable result review to validate output matches user intent (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_notebook_execution</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Execute code in separate Jupyter notebook for isolation and debugging (default: True).
Set to False to use legacy in-process execution.</p>
</li>
<li>
<p><span class="mkapi-item-name">max_prompts_per_session</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Number of prompts to execute in same notebook session before restart (default: 5).
This prevents memory bloat while maintaining context for iterative analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name">notebook_storage_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Directory to store session notebooks. Defaults to ~/.ovagent/sessions</p>
</li>
<li>
<p><span class="mkapi-item-name">keep_execution_notebooks</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Whether to keep session notebooks after execution (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">notebook_timeout</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Execution timeout in seconds (default: 600)</p>
</li>
<li>
<p><span class="mkapi-item-name">strict_kernel_validation</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
If True, raise error if kernel not found. If False, fall back to python3 kernel (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">enable_filesystem_context</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
Enable filesystem-based context management for offloading intermediate results,
plans, and notes to disk. This reduces context window usage and enables
selective context retrieval. Default: True.</p>
</li>
<li>
<p><span class="mkapi-item-name">context_storage_dir</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Directory for storing context files. Defaults to ~/.ovagent/context/</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle attributes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Attributes</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">filesystem_context</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="omicverse.utils.filesystem_context.FilesystemContextManager">FilesystemContextManager</span>]</span> <span class="mkapi-dash">—</span>
Get the filesystem context manager.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.help_short" title="omicverse.utils.OmicVerseAgent.help_short">help_short</a></span>
<span class="mkapi-dash">—</span>
Return a short, non-expert help string with sample prompts.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.run_async" title="omicverse.utils.OmicVerseAgent.run_async">run_async</a></span>
<span class="mkapi-dash">—</span>
Process a natural language request using priority-based execution strategy.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.run_async_LEGACY" title="omicverse.utils.OmicVerseAgent.run_async_LEGACY">run_async_LEGACY</a></span>
<span class="mkapi-dash">—</span>
[LEGACY] Original run_async implementation before priority system.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.stream_async" title="omicverse.utils.OmicVerseAgent.stream_async">stream_async</a></span>
<span class="mkapi-dash">—</span>
Stream LLM response chunks as they arrive while processing a request.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.run" title="omicverse.utils.OmicVerseAgent.run">run</a></span>
<span class="mkapi-dash">—</span>
Process a natural language request with the provided adata (main method).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.get_current_session_info" title="omicverse.utils.OmicVerseAgent.get_current_session_info">get_current_session_info</a></span>
<span class="mkapi-dash">—</span>
Get information about current notebook session.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.restart_session" title="omicverse.utils.OmicVerseAgent.restart_session">restart_session</a></span>
<span class="mkapi-dash">—</span>
Manually restart notebook session (clear memory, start fresh).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.get_session_history" title="omicverse.utils.OmicVerseAgent.get_session_history">get_session_history</a></span>
<span class="mkapi-dash">—</span>
Get history of all archived notebook sessions.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.write_note" title="omicverse.utils.OmicVerseAgent.write_note">write_note</a></span>
<span class="mkapi-dash">—</span>
Write a note to the filesystem context workspace.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.search_context" title="omicverse.utils.OmicVerseAgent.search_context">search_context</a></span>
<span class="mkapi-dash">—</span>
Search the filesystem context for relevant notes.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.get_relevant_context" title="omicverse.utils.OmicVerseAgent.get_relevant_context">get_relevant_context</a></span>
<span class="mkapi-dash">—</span>
Get context relevant to a query, formatted for LLM injection.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.save_plan" title="omicverse.utils.OmicVerseAgent.save_plan">save_plan</a></span>
<span class="mkapi-dash">—</span>
Save an execution plan to the filesystem context.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.update_plan_step" title="omicverse.utils.OmicVerseAgent.update_plan_step">update_plan_step</a></span>
<span class="mkapi-dash">—</span>
Update the status of a plan step.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.get_workspace_summary" title="omicverse.utils.OmicVerseAgent.get_workspace_summary">get_workspace_summary</a></span>
<span class="mkapi-dash">—</span>
Get a summary of the filesystem context workspace.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.utils.OmicVerseAgent.get_context_stats" title="omicverse.utils.OmicVerseAgent.get_context_stats">get_context_stats</a></span>
<span class="mkapi-dash">—</span>
Get statistics about the filesystem context workspace.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.help_short">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.help_short" title="omicverse.utils.OmicVerseAgent.help_short">help_short</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>Return a short, non-expert help string with sample prompts.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.run_async">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">async method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.run_async" title="omicverse.utils.OmicVerseAgent.run_async">run_async</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">self</span><span class="mkapi-comma">, </span><span class="mkapi-arg">request</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Any">Any</span></span></span>
</p>
<div class="mkapi-document">
<p>Process a natural language request using priority-based execution strategy.</p>
<p>This method implements a two-tier priority system:
- Priority 1 (Fast): Registry-only workflow for simple tasks (60-70% faster)
- Priority 2 (Comprehensive): Skills-guided workflow for complex tasks</p>
<p>The system automatically:
1. Analyzes task complexity (simple vs complex)
2. Attempts Priority 1 if simple
3. Falls back to Priority 2 if needed or if complex</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">request</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Natural language description of what to do</p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Any">Any</span></span> <span class="mkapi-dash">—</span>
AnnData object to process</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Any">Any</span></span> <span class="mkapi-dash">—</span>
Processed adata object</p>
</li>
</ul>
</div>
<div class="mkapi-section-content">
<div class="admonition note">
<p class="admonition-title">Notes</p>
<p>Priority 1 is attempted for simple tasks and provides:
- Single LLM call for code generation
- 60-70% faster execution
- 50% lower token usage
- No skill loading overhead</p>
<p>Priority 2 is used for complex tasks or as fallback:
- LLM-based skill matching
- Full skill guidance injection
- Multi-step workflow generation
- More thorough but slower</p>
</div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<p>Simple task (Priority 1):
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"qc with nUMI&gt;500"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
</code></pre></div></p>
<div class="mkapi-example-output highlight"><pre><span></span><code># Output: Priority 1 used, ~2-3 seconds
</code></pre></div>
<p>Complex task (Priority 2):
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"complete bulk DEG pipeline"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
</code></pre></div></p>
<div class="mkapi-example-output highlight"><pre><span></span><code># Output: Priority 2 used, ~8-10 seconds
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.run_async_LEGACY">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">async method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.run_async_LEGACY" title="omicverse.utils.OmicVerseAgent.run_async_LEGACY">run_async_LEGACY</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">self</span><span class="mkapi-comma">, </span><span class="mkapi-arg">request</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Any">Any</span></span></span>
</p>
<div class="mkapi-document">
<p>[LEGACY] Original run_async implementation before priority system.</p>
<p>This method is preserved for reference but is no longer used.
The new run_async() implements the priority-based system.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">RuntimeError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.stream_async">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">async method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.stream_async" title="omicverse.utils.OmicVerseAgent.stream_async">stream_async</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">self</span><span class="mkapi-comma">, </span><span class="mkapi-arg">request</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Stream LLM response chunks as they arrive while processing a request.</p>
<p>This method is similar to run_async() but yields LLM response chunks
in real-time before executing the generated code.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">request</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Natural language description of what to do</p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Any">Any</span></span> <span class="mkapi-dash">—</span>
AnnData object to process</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle yields">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Yields</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Dictionary with 'type' and 'content' keys. Types include:</p>
<ul>
<li>'skill_match': Matched skills</li>
<li>'llm_chunk': Streaming LLM response chunks</li>
<li>'code': Generated code to execute</li>
<li>'result': Final result after execution</li>
<li>'usage': Token usage statistics (emitted as final event)</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-4o-mini"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream_async</span><span class="p">(</span><span class="s2">"qc with nUMI&gt;500"</span><span class="p">,</span> <span class="n">adata</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'llm_chunk'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s1">'content'</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">event</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'result'</span><span class="p">:</span>
        <span class="n">result_adata</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">event</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'usage'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Tokens used: </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="s1">'content'</span><span class="p">]</span><span class="o">.</span><span class="n">total_tokens</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">RuntimeError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.run">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.run" title="omicverse.utils.OmicVerseAgent.run">run</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">request</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Any">Any</span></span></span>
</p>
<div class="mkapi-document">
<p>Process a natural language request with the provided adata (main method).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">request</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Natural language description of what to do</p>
</li>
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Any">Any</span></span> <span class="mkapi-dash">—</span>
AnnData object to process</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">Any</span>
<span class="mkapi-dash">—</span>
Processed adata object (modified)</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span></p>
</li>
<li>
<p><span class="mkapi-item-name">--------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">```{.python .mkapi-example-input}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">agent = ov.Agent(model="gpt-4o-mini")</span></p>
</li>
<li>
<p><span class="mkapi-item-name">result = agent.run("quality control with nUMI&gt;500, mito&lt;0.2", adata)</span></p>
</li>
<li>
<p><span class="mkapi-item-name">```</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils.smart_agent.OmicVerseAgent.run.error_container">error_container</span>['error']</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.get_current_session_info">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.get_current_session_info" title="omicverse.utils.OmicVerseAgent.get_current_session_info">get_current_session_info</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span></span>
</p>
<div class="mkapi-document">
<p>Get information about current notebook session.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span> <span class="mkapi-dash">—</span>
Session information dictionary with keys:</p>
<ul>
<li>session_id: Session identifier</li>
<li>notebook_path: Path to session notebook</li>
<li>prompt_count: Number of prompts executed in session</li>
<li>max_prompts: Maximum prompts per session</li>
<li>remaining_prompts: Prompts remaining before restart</li>
<li>start_time: Session start time (ISO format)</li>
</ul>
<p>Returns None if notebook execution is disabled or no session exists.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gemini-2.5-flash"</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"preprocess data"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_current_session_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Session: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'session_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Prompts: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'prompt_count'</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">'max_prompts'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.restart_session">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.restart_session" title="omicverse.utils.OmicVerseAgent.restart_session">restart_session</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Manually restart notebook session (clear memory, start fresh).</p>
<p>This forces a new session to be created on the next execution,
useful for freeing memory or starting with a clean state.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gemini-2.5-flash"</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"step 1"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"step 2"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
<span class="c1"># Force new session</span>
<span class="n">agent</span><span class="o">.</span><span class="n">restart_session</span><span class="p">()</span>
<span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"step 3"</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>  <span class="c1"># Runs in new session</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.get_session_history">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.get_session_history" title="omicverse.utils.OmicVerseAgent.get_session_history">get_session_history</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span></span>
</p>
<div class="mkapi-document">
<p>Get history of all archived notebook sessions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span> <span class="mkapi-dash">—</span>
List of session history dictionaries, each containing:</p>
<ul>
<li>session_id: Session identifier</li>
<li>notebook_path: Path to archived notebook</li>
<li>prompt_count: Number of prompts executed</li>
<li>start_time: Session start time</li>
<li>end_time: Session end time</li>
<li>executions: List of execution records</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span> <span class="o">=</span> <span class="n">ov</span><span class="o">.</span><span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gemini-2.5-flash"</span><span class="p">)</span>
<span class="c1"># ... run several prompts causing session restarts ...</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_session_history</span><span class="p">()</span>
<span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">history</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">session</span><span class="p">[</span><span class="s1">'session_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">session</span><span class="p">[</span><span class="s1">'prompt_count'</span><span class="p">]</span><span class="si">}</span><span class="s2"> prompts"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.filesystem_context">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">property</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.filesystem_context" title="omicverse.utils.OmicVerseAgent.filesystem_context">filesystem_context</a></span><span class="mkapi-signature"><span class="mkapi-colon">: </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="omicverse.utils.filesystem_context.FilesystemContextManager">FilesystemContextManager</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Get the filesystem context manager.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.utils.filesystem_context.FilesystemContextManager">FilesystemContextManager</span> or None</span> <span class="mkapi-dash">—</span>
The context manager if enabled, None otherwise.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.write_note">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.write_note" title="omicverse.utils.OmicVerseAgent.write_note">write_note</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">content</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">category</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'notes'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">metadata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span></span>
</p>
<div class="mkapi-document">
<p>Write a note to the filesystem context workspace.</p>
<p>Use this to offload intermediate results, observations, or decisions
from the context window to persistent storage. This reduces token usage
and enables selective context retrieval.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Unique identifier for this note. Used for later retrieval.</p>
</li>
<li>
<p><span class="mkapi-item-name">content</span> : 
<span class="mkapi-item-type">str or dict</span> <span class="mkapi-dash">—</span>
The note content. Can be free-form text or structured data.</p>
</li>
<li>
<p><span class="mkapi-item-name">category</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Category for organizing notes (default: "notes").
Options: notes, results, decisions, snapshots, figures, errors</p>
</li>
<li>
<p><span class="mkapi-item-name">metadata</span> : 
<span class="mkapi-item-type">dict, optional</span> <span class="mkapi-dash">—</span>
Additional metadata to store with the note.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">str or None</span> <span class="mkapi-dash">—</span>
Path to the stored note, or None if filesystem context is disabled.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span><span class="o">.</span><span class="n">write_note</span><span class="p">(</span><span class="s2">"qc_stats"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"n_cells"</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s2">"mito_pct"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span> <span class="n">category</span><span class="o">=</span><span class="s2">"results"</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">write_note</span><span class="p">(</span><span class="s2">"observation"</span><span class="p">,</span> <span class="s2">"Cluster 3 shows high mitochondrial content"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.search_context">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.search_context" title="omicverse.utils.OmicVerseAgent.search_context">search_context</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pattern</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">match_type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'glob'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_results</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span></span>
</p>
<div class="mkapi-document">
<p>Search the filesystem context for relevant notes.</p>
<p>Use glob patterns to find notes by key, or grep patterns to search
within note content.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pattern</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Search pattern. For glob: "pca<em>", "cluster_</em>". For grep: regex pattern.</p>
</li>
<li>
<p><span class="mkapi-item-name">match_type</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Type of search: "glob" (filename pattern) or "grep" (content search).
Default: "glob".</p>
</li>
<li>
<p><span class="mkapi-item-name">max_results</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Maximum number of results to return (default: 10).</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">list of dict</span> <span class="mkapi-dash">—</span>
Matching results with key, category, and content preview.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">search_context</span><span class="p">(</span><span class="s2">"cluster*"</span><span class="p">,</span> <span class="n">match_type</span><span class="o">=</span><span class="s2">"glob"</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">search_context</span><span class="p">(</span><span class="s2">"resolution"</span><span class="p">,</span> <span class="n">match_type</span><span class="o">=</span><span class="s2">"grep"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.get_relevant_context">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.get_relevant_context" title="omicverse.utils.OmicVerseAgent.get_relevant_context">get_relevant_context</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">query</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_tokens</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1000</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>Get context relevant to a query, formatted for LLM injection.</p>
<p>This method searches the filesystem context for notes relevant to
the given query and formats them for inclusion in prompts.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">query</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The current task or query to find relevant context for.</p>
</li>
<li>
<p><span class="mkapi-item-name">max_tokens</span> : 
<span class="mkapi-item-type">int, optional</span> <span class="mkapi-dash">—</span>
Approximate maximum tokens to return (default: 1000).</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Formatted context string ready for LLM injection.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">context</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_relevant_context</span><span class="p">(</span><span class="s2">"clustering"</span><span class="p">)</span>
<span class="c1"># Use context in custom prompts</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.save_plan">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.save_plan" title="omicverse.utils.OmicVerseAgent.save_plan">save_plan</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">steps</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.List">List</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span></span>
</p>
<div class="mkapi-document">
<p>Save an execution plan to the filesystem context.</p>
<p>Plans are persisted and can be tracked across prompts.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">steps</span> : 
<span class="mkapi-item-type">list of dict</span> <span class="mkapi-dash">—</span>
List of step definitions. Each step should have:</p>
<ul>
<li>description: What this step does</li>
<li>status: pending, in_progress, completed, failed</li>
<li>optional: function, parameters, expected_output</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">str or None</span> <span class="mkapi-dash">—</span>
Path to the plan file, or None if filesystem context is disabled.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span><span class="o">.</span><span class="n">save_plan</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Run QC"</span><span class="p">,</span> <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"pending"</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Normalize data"</span><span class="p">,</span> <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"pending"</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"description"</span><span class="p">:</span> <span class="s2">"Cluster cells"</span><span class="p">,</span> <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"pending"</span><span class="p">},</span>
<span class="p">])</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.update_plan_step">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.update_plan_step" title="omicverse.utils.OmicVerseAgent.update_plan_step">update_plan_step</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">step_index</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-comma">, </span><span class="mkapi-arg">status</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">result</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">None</span></span>
</p>
<div class="mkapi-document">
<p>Update the status of a plan step.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">step_index</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Index of the step to update (0-based).</p>
</li>
<li>
<p><span class="mkapi-item-name">status</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
New status: pending, in_progress, completed, failed.</p>
</li>
<li>
<p><span class="mkapi-item-name">result</span> : 
<span class="mkapi-item-type">str, optional</span> <span class="mkapi-dash">—</span>
Result or notes for this step.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">agent</span><span class="o">.</span><span class="n">update_plan_step</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"completed"</span><span class="p">,</span> <span class="s2">"QC removed 500 low-quality cells"</span><span class="p">)</span>
<span class="n">agent</span><span class="o">.</span><span class="n">update_plan_step</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"in_progress"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.get_workspace_summary">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.get_workspace_summary" title="omicverse.utils.OmicVerseAgent.get_workspace_summary">get_workspace_summary</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>Get a summary of the filesystem context workspace.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Markdown-formatted workspace summary including:</p>
<ul>
<li>Session ID</li>
<li>Plan progress (if a plan exists)</li>
<li>Notes by category</li>
<li>Recent activity</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_workspace_summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.OmicVerseAgent.get_context_stats">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.utils.OmicVerseAgent" title="omicverse.utils.OmicVerseAgent">OmicVerseAgent</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.utils.OmicVerseAgent.get_context_stats" title="omicverse.utils.OmicVerseAgent.get_context_stats">get_context_stats</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Dict">Dict</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]</span></span>
</p>
<div class="mkapi-document">
<p>Get statistics about the filesystem context workspace.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">dict</span> <span class="mkapi-dash">—</span>
Workspace statistics including:</p>
<ul>
<li>session_id: Current session ID</li>
<li>workspace_dir: Path to workspace directory</li>
<li>categories: Notes count and size by category</li>
<li>total_notes: Total number of notes</li>
<li>total_size_bytes: Total size in bytes</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="n">stats</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_context_stats</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total notes: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">'total_notes'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.utils.list_supported_models">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.utils.list_supported_models" title="omicverse.utils.list_supported_models">list_supported_models</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">show_all</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">str</span></span>
</p>
<div class="mkapi-document">
<p>List all supported models for OmicVerse Smart Agent.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">show_all</span> : 
<span class="mkapi-item-type">bool, optional</span> <span class="mkapi-dash">—</span>
If True, show all models. If False, show top 3 per provider (default: False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span></p>
</li>
<li>
<p><span class="mkapi-item-name">-------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">str</span>
<span class="mkapi-dash">—</span>
Formatted list of supported models with API key status</p>
</li>
<li>
<p><span class="mkapi-item-name">Examples</span></p>
</li>
<li>
<p><span class="mkapi-item-name">--------</span></p>
</li>
<li>
<p><span class="mkapi-item-name">```{.python .mkapi-example-input}</span></p>
</li>
<li>
<p><span class="mkapi-item-name">import omicverse as ov</span></p>
</li>
<li>
<p><span class="mkapi-item-name">print(ov.list_supported_models())</span></p>
</li>
<li>
<p><span class="mkapi-item-name">print(ov.list_supported_models(show_all=True))</span></p>
</li>
<li>
<p><span class="mkapi-item-name">```</span></p>
</li>
</ul>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2019-2025, 112 Lab, USTB
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.fc8c2696.min.js"></script>
<script src="../../../javascript/mkapi.js"></script>
<script src="../../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>