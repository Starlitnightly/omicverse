
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Zehua Zeng" name="author"/>
<link href="../datasets/" rel="prev"/>
<link href="../pp/" rel="next"/>
<link href="../../../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.1.2" name="generator"/>
<title>pl - omicverse Readthedocs</title>
<link href="../../../assets/stylesheets/main.7bf56d0a.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/mkapi-common.css" rel="stylesheet"/>
<link href="../../../css/mkapi-material.css" rel="stylesheet"/>
<link href="../../../css/tags.css" rel="stylesheet"/>
<link href="../../../css/custom.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#omicverse.pl">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="omicverse Readthedocs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            omicverse Readthedocs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              pl
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="omicverse Readthedocs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="omicverse Readthedocs">
<img alt="logo" src="../../../img/ico.png"/>
</a>
    omicverse Readthedocs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Starlitnightly/omicverse" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Index
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Installation_guild/">
        Installation
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Bulk
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
          Bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_1">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_bulk_combat/">
        Batch correction in Bulk RNA-seq or microarray data
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_2">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deg/">
        Different Expression Analysis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_deseq2/">
        Different Expression Analysis with DEseq2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_network/">
        Protein-Protein interaction (PPI) analysis by String-db
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_wgcna/">
        WGCNA (Weighted gene co-expression network analysis) analysis
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_3">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_decov_bulk/">
        Bulk deconvolution with reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
          Others
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_1_4">
<span class="md-nav__icon md-icon"></span>
          Others
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk/t_tcga/">
        TCGA database preprocess
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          Alignment
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_1">
<span class="md-nav__icon md-icon"></span>
          Alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_1k/">
        Alignment and analysis of single-cell RNA-seq data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_alignment_velocity/">
        Alignment and RNA velocity analysis of single-cell RNA-seq data.
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          Preprocessing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_2">
<span class="md-nav__icon md-icon"></span>
          Preprocessing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_cpu/">
        Preprocessing the data of scRNA-seq with omicverse[CPU-GPU-mixed]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_preprocess_gpu/">
        Preprocessing the data of scRNA-seq with omicverse[GPU]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cluster/">
        Clustering space
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_single_batch/">
        Data integration and batch correction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cnmf/">
        GeneModule Identified
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_lazy/">
        Lazy analysis of scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
          Annotation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_3">
<span class="md-nav__icon md-icon"></span>
          Annotation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_noref/">
        Reference-free automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_ref/">
        Reference automated single-cell cell type annotation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_gptanno/">
        Automatic cell type annotation with GPT/Other
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellmatch/">
        Mapping Cell Names to the Cell Ontology/Taxonomy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellanno/">
        Celltype auto annotation with SCSA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metatime/">
        Celltype auto annotation with MetaTiME
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_tosica/">
        Celltype annotation migration(mapping) with TOSICA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scmulan/">
        Celltype auto annotation with scMulan
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellvote/">
        Consensus annotation with CellVote
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
          Trajectory
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
          Trajectory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cytotrace/">
        Prediction of absolute developmental potential using CytoTrace2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_traj/">
        Basic Trajectory Inference
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_stavia/">
        Trajectory Inference with StaVIA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate_gene/">
        Timing-associated genes analysis with TimeFateKernel
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellfate/">
        Identify the driver regulators of cell fate decisions
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
          Cell Structure
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_5">
<span class="md-nav__icon md-icon"></span>
          Cell Structure
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_metacells/">
        Inference of MetaCell from Single-Cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_deg_single/">
        Differential expression and celltype analysis [All Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdeg/">
        Differential expression analysis [Meta Cell]
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scenic/">
        Gene Regulatory Network Analysis with SCENIC
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_aucell/">
        Pathway analysis with AUCell
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_cellphonedb/">
        Cell-cell communication using CellPhoneDBViz
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_scdrug/">
        Drug response predict with scDrug
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_simba/">
        Data integration and batch correction with SIMBA
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
          Velocity
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_6">
<span class="md-nav__icon md-icon"></span>
          Velocity
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_velo/">
        Velocity Basic Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-velo/t_graphvelo/">
        Velocity Optimization
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_7" id="__nav_3_2_7_label" tabindex="0">
          Multi omics
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_7">
<span class="md-nav__icon md-icon"></span>
          Multi omics
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa/">
        Multi omics analysis by MOFA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_mofa_glue/">
        Multi omics analysis by MOFA and GLUE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-single/t_anno_trans/">
        Celltype annotation transfer in multi-omics
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Bulk2Single
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          Bulk2Single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulktrajblend/">
        Bulk RNA-seq generate 'interrupted' cells to interpolate scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_bulk2single/">
        Bulk RNA-seq to Single RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-bulk2single/t_single2spatial/">
        Single RNA-seq to Spatial RNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Space
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
          Space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
          Preprocess
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_1">
<span class="md-nav__icon md-icon"></span>
          Preprocess
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_crop_rotate/">
        Crop and Rotation of spatial transcriptomic data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cellpose/">
        Cell Segmemtation (10x HD)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_cluster_space/">
        Spatial clustering and denoising expressions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_staligner/">
        Spatial integration and clustering
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
          Deconvolution
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_2">
<span class="md-nav__icon md-icon"></span>
          Deconvolution
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_spaceflow/">
        Identifying Pseudo-Spatial Map
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_decov/">
        Spatial deconvolution with reference scRNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_flashdeconv/">
        FlashDeconv: Fast Spatial Deconvolution via Structure-Preserving Sketching
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_starfysh_new/">
        Spatial deconvolution without reference scRNA-seq
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
          Downstream
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_4_3">
<span class="md-nav__icon md-icon"></span>
          Downstream
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_stt/">
        Spatial transition tensor of single cells
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_commot_flowsig/">
        Spatial Communication
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_gaston/">
        Spatial IsoDepth Calculation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-space/t_slat/">
        Single cell spatial alignment tools
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          LLM
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          LLM
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr/">
        Domain Research (dr): Comprehensive Report Tutorial
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_dr_web/">
        Domain Research (dr) — Live Web
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_ov_agent_pbmc3k/">
        ov.Agent with Skills: Natural‑Language Single‑Cell Analysis (PBMC3k)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_uce/">
        UCE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scgpt/">
        scGPT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_scfoundation/">
        scFoundation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_geneformer/">
        GeneFormer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-llm/t_cellplm/">
        CellPLM
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Plotting
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
          Plotting
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_single/">
        Visualization of single cell RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_bulk/">
        Visualization of Bulk RNA-seq
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Tutorials-plotting/t_visualize_colorsystem/">
        Color system
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../GPU_supported_registry_functions/">
        GPU Support
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">API documentation</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../agent/">agent</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          agent
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../alignment/">alignment</a>
<label for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
          alignment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../alignment/kb_api/">
        kb_api
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk/">bulk</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          bulk
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../bulk2single/">bulk2single</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
          bulk2single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../datasets/">datasets</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_6">
<span class="md-nav__icon md-icon"></span>
          datasets
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index md-nav__link--active">
<a href="./">pl</a>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_7">
<span class="md-nav__icon md-icon"></span>
          pl
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/">pp</a>
<label for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
          pp
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_8_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../pp/experimental/">experimental</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_8_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_8_2">
<span class="md-nav__icon md-icon"></span>
          experimental
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pp/pyg_knn_implementation/">
        pyg_knn_implementation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_9" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../single/">single</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_9">
<span class="md-nav__icon md-icon"></span>
          single
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_10" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../space/">space</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_10">
<span class="md-nav__icon md-icon"></span>
          space
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_11" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../utils/">utils</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_11">
<span class="md-nav__icon md-icon"></span>
          utils
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Release_notes/">
        Release notes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Developer_guild/">
        Developer guild
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity">
    ForbiddenCity
  </a>
<nav aria-label="ForbiddenCity" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity.get_cmap">
    get_cmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity.get_color">
    get_color
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity.get_color_rgb">
    get_color_rgb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity.get_cmap_seg">
    get_cmap_seg
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ForbiddenCity.visual_color">
    visual_color
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.Forbidden_Cmap">
    Forbidden_Cmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.colormaps_palette">
    colormaps_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.get_forbidden">
    get_forbidden
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.optim_palette">
    optim_palette
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ConvexHull">
    ConvexHull
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_arrow">
    add_arrow
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.bardotplot">
    bardotplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cellproportion">
    cellproportion
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cellstackarea">
    cellstackarea
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.contour">
    contour
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.dotplot_doublegroup">
    dotplot_doublegroup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding">
    embedding
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding_adjust">
    embedding_adjust
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding_celltype">
    embedding_celltype
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding_density">
    embedding_density
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.mde">
    mde
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.pca">
    pca
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_boxplots">
    plot_boxplots
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.single_group_boxplot">
    single_group_boxplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.tsne">
    tsne
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.umap">
    umap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.violin_box">
    violin_box
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.violin_old">
    violin_old
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_palue">
    add_palue
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.create_custom_colormap">
    create_custom_colormap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.create_transparent_gradient_colormap">
    create_transparent_gradient_colormap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.check_pycomplexheatmap">
    check_pycomplexheatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.complexheatmap">
    complexheatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.global_imports">
    global_imports
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.marker_heatmap">
    marker_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding_multi">
    embedding_multi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.boxplot">
    boxplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_grouped_fractions">
    plot_grouped_fractions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.venn">
    venn
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.volcano">
    volcano
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_pie2spatial">
    add_pie2spatial
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_pie_charts_to_spatial">
    add_pie_charts_to_spatial
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.create_colormap">
    create_colormap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.get_rgb_function">
    get_rgb_function
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.html_to_rgb">
    html_to_rgb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_spatial">
    plot_spatial
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_spatial_general">
    plot_spatial_general
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.rgb_to_ryb">
    rgb_to_ryb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.ryb_to_rgb">
    ryb_to_rgb
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.spatial_value">
    spatial_value
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_chord">
    cpdb_chord
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_group_heatmap">
    cpdb_group_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_heatmap">
    cpdb_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_interacting_heatmap">
    cpdb_interacting_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_interacting_network">
    cpdb_interacting_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.cpdb_network">
    cpdb_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.curved_graph">
    curved_graph
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.curved_line">
    curved_line
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_curve_network">
    plot_curve_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.plot_flowsig_network">
    plot_flowsig_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.embedding_atlas">
    embedding_atlas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_density_contour">
    add_density_contour
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.calculate_gene_density">
    calculate_gene_density
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz">
    CellChatViz
  </a>
<nav aria-label="CellChatViz" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.compute_aggregated_network">
    compute_aggregated_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_circle">
    netVisual_circle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.get_ligand_receptor_pairs">
    get_ligand_receptor_pairs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.mean">
    mean
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.pvalue">
    pvalue
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.analyze_pathway_statistics">
    analyze_pathway_statistics
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.compute_pathway_communication">
    compute_pathway_communication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.get_significant_pathways_v2">
    get_significant_pathways_v2
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.demo_curved_arrows">
    demo_curved_arrows
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_circle_focused">
    netVisual_circle_focused
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_individual_circle">
    netVisual_individual_circle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_individual_circle_incoming">
    netVisual_individual_circle_incoming
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_heatmap">
    netVisual_heatmap
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea">
    netVisual_heatmap_marsilea
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused">
    netVisual_heatmap_marsilea_focused
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_chord">
    netVisual_chord
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_hierarchy">
    netVisual_hierarchy
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_bubble">
    netVisual_bubble
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.compute_pathway_network">
    compute_pathway_network
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.identify_signaling_role">
    identify_signaling_role
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.compute_network_similarity">
    compute_network_similarity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netEmbedding">
    netEmbedding
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_single_circle">
    netVisual_single_circle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_aggregate">
    netVisual_aggregate
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.get_signaling_pathways">
    get_signaling_pathways
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.plot_all_visualizations">
    plot_all_visualizations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_chord_cell">
    netVisual_chord_cell
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.CellChatViz.netVisual_chord_LR">
    netVisual_chord_LR
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.dotplot">
    dotplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.rank_genes_groups_dotplot">
    rank_genes_groups_dotplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.rank_genes_groups_df">
    rank_genes_groups_df
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.spatial_segment">
    spatial_segment
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.spatial_segment_overlay">
    spatial_segment_overlay
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.violin">
    violin
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.Streamlines">
    Streamlines
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.add_streamplot">
    add_streamplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.animate_streamplot">
    animate_streamplot
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.compute_velocity_on_grid">
    compute_velocity_on_grid
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omicverse.pl.nan_helper">
    nan_helper
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 style="display: none;">omicverse.pl<a class="headerlink" href="#omicverse.pl" title="Permanent link">¶</a></h1><p class="mkapi-object mkapi-page-source" id="omicverse.pl">
<span class="mkapi-object-link">
<a href="../../../src/omicverse/pl/#omicverse.pl" title="Go to source">source</a>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">package</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl" title="omicverse.pl">omicverse.pl</a></span>
</p>
<div class="mkapi-document">
<p>Plotting utilities for omics data visualization.</p>
<p>This module provides comprehensive plotting functions for visualizing various types
of omics data including single-cell, bulk, spatial transcriptomics, multi-omics,
and network data. It offers publication-ready plots with customizable aesthetics.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle visualization categories">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Visualization categories</span>
</p>
<div class="mkapi-section-content">
<div class="highlight"><pre><span></span><code>Single-cell plots: UMAP, t-SNE, PCA, violin plots, dot plots
Bulk data plots: Heatmaps, volcano plots, MA plots, PCA plots
Spatial plots: Spatial feature plots, domain visualization
Multi-omics plots: Factor plots, integration visualizations
Network plots: Protein-protein interactions, pathway networks
General plots: Heatmaps, scatter plots, bar plots
</code></pre></div>
<p>Key modules:
    _single: Single-cell specific plotting functions
    _bulk: Bulk RNA-seq plotting functions<br/>
    _space: Spatial transcriptomics visualizations
    _multi: Multi-omics integration plots
    _heatmap: Heatmap and clustering visualizations
    _general: General-purpose plotting utilities
    _palette: Color palette and aesthetic functions
    _cpdb: Cell-cell communication network plots
    _flowsig: Flow cytometry-style visualizations
    _embedding: Dimensionality reduction visualizations
    _density: Density and distribution plots</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle features">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Features</span>
</p>
<div class="mkapi-section-content">
<ul>
<li>Publication-ready figures with customizable aesthetics</li>
<li>Integration with matplotlib and seaborn</li>
<li>Support for interactive plots</li>
<li>Consistent color schemes and themes</li>
<li>Export capabilities for various formats</li>
<li>Integration with AnnData objects</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">omicverse</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ov</span>
<span class="c1"># Single-cell visualization</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'umap'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'cell_type'</span><span class="p">)</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">violin</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'CD3D'</span><span class="p">,</span> <span class="s1">'CD8A'</span><span class="p">],</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">'cell_type'</span><span class="p">)</span>

<span class="c1"># Bulk data visualization</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">volcano</span><span class="p">(</span><span class="n">deg_results</span><span class="p">,</span> <span class="n">pval_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="n">marker_genes</span><span class="p">)</span>

<span class="c1"># Spatial visualization</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'total_counts'</span><span class="p">)</span>
<span class="n">ov</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial_domains</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'domain'</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle classes">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Classes</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a></span>
<span class="mkapi-dash">—</span>
CellChat-like visualization for CellPhoneDB AnnData</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.Streamlines" title="omicverse.pl.Streamlines">Streamlines</a></span>
<span class="mkapi-dash">—</span>
Copyright (c) 2011 Raymond Speth.
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the "Software"),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
See: http://web.mit.edu/speth/Public/streamlines.py</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle functions">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Functions</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.Forbidden_Cmap" title="omicverse.pl.Forbidden_Cmap">Forbidden_Cmap</a></span>
<span class="mkapi-dash">—</span>
Create a colormap or color list from the Forbidden City color palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.colormaps_palette" title="omicverse.pl.colormaps_palette">colormaps_palette</a></span>
<span class="mkapi-dash">—</span>
Returns a colormap palette.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.get_forbidden" title="omicverse.pl.get_forbidden">get_forbidden</a></span>
<span class="mkapi-dash">—</span>
Get the complete Forbidden City color palette dictionary.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.optim_palette" title="omicverse.pl.optim_palette">optim_palette</a></span>
<span class="mkapi-dash">—</span>
Optimized palette for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ConvexHull" title="omicverse.pl.ConvexHull">ConvexHull</a></span>
<span class="mkapi-dash">—</span>
Plot the ConvexHull for a cluster in embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_arrow" title="omicverse.pl.add_arrow">add_arrow</a></span>
<span class="mkapi-dash">—</span>
Add arrow and label to the axis
Args:
    ax: matplotlib.axes.Axes
        The axis to add the arrow and label to.
    adata: AnnData
        The AnnData object to add the arrow and label to.
    basis: str
        The basis to add the arrow and label to.
    fontsize: int
        The fontsize of the label.
    arrow_scale: float
        The scale of the arrow.
    arrow_width: float
        The width of the arrow.
    x_label: str
        The label of the x-axis.
    y_label: str
        The label of the y-axis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.bardotplot" title="omicverse.pl.bardotplot">bardotplot</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cellproportion" title="omicverse.pl.cellproportion">cellproportion</a></span>
<span class="mkapi-dash">—</span>
Plot cell proportion of each cell type in each visual cluster.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cellstackarea" title="omicverse.pl.cellstackarea">cellstackarea</a></span>
<span class="mkapi-dash">—</span>
Plot the cell type percentage in each groupby category</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.contour" title="omicverse.pl.contour">contour</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.dotplot_doublegroup" title="omicverse.pl.dotplot_doublegroup">dotplot_doublegroup</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding" title="omicverse.pl.embedding">embedding</a></span>
<span class="mkapi-dash">—</span>
Scatter plot for user specified embedding basis (e.g. umap, pca, etc).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding_adjust" title="omicverse.pl.embedding_adjust">embedding_adjust</a></span>
<span class="mkapi-dash">—</span>
Get locations of cluster median and adjust text labels accordingly.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding_celltype" title="omicverse.pl.embedding_celltype">embedding_celltype</a></span>
<span class="mkapi-dash">—</span>
Plot embedding with celltype color by omicverse.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding_density" title="omicverse.pl.embedding_density">embedding_density</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.mde" title="omicverse.pl.mde">mde</a></span>
<span class="mkapi-dash">—</span>
Plot MDE embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.pca" title="omicverse.pl.pca">pca</a></span>
<span class="mkapi-dash">—</span>
Plot PCA embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_boxplots" title="omicverse.pl.plot_boxplots">plot_boxplots</a></span>
<span class="mkapi-dash">—</span>
Grouped boxplot visualization.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.single_group_boxplot" title="omicverse.pl.single_group_boxplot">single_group_boxplot</a></span>
<span class="mkapi-dash">—</span>
adata (AnnData object): The data object containing the information for plotting.
groupby (str): The variable used for grouping the data.
color (str): The variable used for coloring the data points.
type_color_dict (dict): A dictionary mapping group categories to specific colors.
title (str): The title for the plot.
ylabel (str): The label for the y-axis.
kruskal_test (bool): Whether to perform a Kruskal-Wallis test and display the p-value on the plot.
figsize (tuple): The size of the plot figure in inches (width, height).
x_ticks_plot (bool): Whether to display x-axis tick labels.
legend_plot (bool): Whether to display a legend for the groups.
bbox_to_anchor (tuple): The position of the legend bbox (x, y) in axes coordinates.
save (bool): Whether to save the plot to a file.
point_number (int): The number of data points to be plotted for each group.
save_pathway (str): The file path for saving the plot (if save is True).
sort (bool): Whether to sort the groups based on their mean values.
scatter_kwargs (dict): Additional keyword arguments for customizing the scatter plot.
ax (matplotlib.axes.Axes): A pre-existing axes object for plotting (optional).</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.tsne" title="omicverse.pl.tsne">tsne</a></span>
<span class="mkapi-dash">—</span>
Plot t-SNE embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.umap" title="omicverse.pl.umap">umap</a></span>
<span class="mkapi-dash">—</span>
Plot UMAP embedding.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.violin_box" title="omicverse.pl.violin_box">violin_box</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.violin_old" title="omicverse.pl.violin_old">violin_old</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_palue" title="omicverse.pl.add_palue">add_palue</a></span>
<span class="mkapi-dash">—</span>
Add p-value annotation with connecting line to a matplotlib plot.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.create_custom_colormap" title="omicverse.pl.create_custom_colormap">create_custom_colormap</a></span>
<span class="mkapi-dash">—</span>
Create a custom colormap based on cell type color.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.create_transparent_gradient_colormap" title="omicverse.pl.create_transparent_gradient_colormap">create_transparent_gradient_colormap</a></span>
<span class="mkapi-dash">—</span>
Create a gradient colormap from transparent color1 to opaque color2.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.check_pycomplexheatmap" title="omicverse.pl.check_pycomplexheatmap">check_pycomplexheatmap</a></span>
<span class="mkapi-dash">—</span>
Check if PyComplexHeatmap is installed and available.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.complexheatmap" title="omicverse.pl.complexheatmap">complexheatmap</a></span>
<span class="mkapi-dash">—</span>
Generate a complex annotated heatmap from single-cell RNA-seq data using PyComplexHeatmap.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.global_imports" title="omicverse.pl.global_imports">global_imports</a></span>
<span class="mkapi-dash">—</span>
Import a module into the global namespace with optional short name.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.marker_heatmap" title="omicverse.pl.marker_heatmap">marker_heatmap</a></span>
<span class="mkapi-dash">—</span>
Create a dot plot heatmap showing marker gene expression across cell types.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding_multi" title="omicverse.pl.embedding_multi">embedding_multi</a></span>
<span class="mkapi-dash">—</span>
Create embedding scatter plots for multi-modal data (MuData) or single-cell data.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.boxplot" title="omicverse.pl.boxplot">boxplot</a></span>
<span class="mkapi-dash">—</span>
Create a boxplot with jittered points to visualize data distribution across categories.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_grouped_fractions" title="omicverse.pl.plot_grouped_fractions">plot_grouped_fractions</a></span>
<span class="mkapi-dash">—</span>
res: 行为 sample、列为 cell type 的预测比例表（你现在的 res）
obs: bulk_ad.obs
group_key: 例如 'severity' / 'disease_state' / 'gender' / 任意 obs 列
agg: 'mean' / 'median' / 'sum'
normalize: 是否把每组的细胞类型比例归一化到和为1</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.venn" title="omicverse.pl.venn">venn</a></span>
<span class="mkapi-dash">—</span>
Create a Venn diagram to visualize set overlaps.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.volcano" title="omicverse.pl.volcano">volcano</a></span>
<span class="mkapi-dash">—</span>
Create a volcano plot for differential expression analysis.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_pie2spatial" title="omicverse.pl.add_pie2spatial">add_pie2spatial</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_pie_charts_to_spatial" title="omicverse.pl.add_pie_charts_to_spatial">add_pie_charts_to_spatial</a></span>
<span class="mkapi-dash">—</span>
在现有 spatial 图上叠加细胞比例饼图（高效 &amp; 兼容）</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.create_colormap" title="omicverse.pl.create_colormap">create_colormap</a></span>
<span class="mkapi-dash">—</span>
Create a matplotlib colormap from RGB values with alpha gradient.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.get_rgb_function" title="omicverse.pl.get_rgb_function">get_rgb_function</a></span>
<span class="mkapi-dash">—</span>
Generate a function to map continuous values to RGB using colormap.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.html_to_rgb" title="omicverse.pl.html_to_rgb">html_to_rgb</a></span>
<span class="mkapi-dash">—</span>
Convert HTML hex color code to RGB tuple.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_spatial" title="omicverse.pl.plot_spatial">plot_spatial</a></span>
<span class="mkapi-dash">—</span>
Create spatial plot from Visium data with color gradient and interpolation.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_spatial_general" title="omicverse.pl.plot_spatial_general">plot_spatial_general</a></span>
<span class="mkapi-dash">—</span>
Create spatial plot with color gradient and interpolation for cell type abundances.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.rgb_to_ryb" title="omicverse.pl.rgb_to_ryb">rgb_to_ryb</a></span>
<span class="mkapi-dash">—</span>
Convert colors from RGB colorspace to RYB (red-yellow-blue) colorspace.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ryb_to_rgb" title="omicverse.pl.ryb_to_rgb">ryb_to_rgb</a></span>
<span class="mkapi-dash">—</span>
Convert colors from RYB (red-yellow-blue) colorspace to RGB colorspace.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.spatial_value" title="omicverse.pl.spatial_value">spatial_value</a></span>
<span class="mkapi-dash">—</span>
Plot spatial expression values for a single gene or feature on tissue image.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_chord" title="omicverse.pl.cpdb_chord">cpdb_chord</a></span>
<span class="mkapi-dash">—</span>
Create a chord diagram visualization of CellPhoneDB interactions.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_group_heatmap" title="omicverse.pl.cpdb_group_heatmap">cpdb_group_heatmap</a></span>
<span class="mkapi-dash">—</span>
Create a grouped heatmap showing ligand and receptor expression by cell type.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_heatmap" title="omicverse.pl.cpdb_heatmap">cpdb_heatmap</a></span>
<span class="mkapi-dash">—</span>
Create a dot heatmap of CellPhoneDB interaction counts between cell types.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_interacting_heatmap" title="omicverse.pl.cpdb_interacting_heatmap">cpdb_interacting_heatmap</a></span>
<span class="mkapi-dash">—</span>
Create a detailed heatmap of specific interacting pairs with significance.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_interacting_network" title="omicverse.pl.cpdb_interacting_network">cpdb_interacting_network</a></span>
<span class="mkapi-dash">—</span>
Create a detailed network showing ligand-receptor interactions between cell types.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.cpdb_network" title="omicverse.pl.cpdb_network">cpdb_network</a></span>
<span class="mkapi-dash">—</span>
Create a circular network plot of CellPhoneDB cell-cell interactions.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.curved_graph" title="omicverse.pl.curved_graph">curved_graph</a></span>
<span class="mkapi-dash">—</span>
Draw a network graph with curved edges and arrows.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.curved_line" title="omicverse.pl.curved_line">curved_line</a></span>
<span class="mkapi-dash">—</span>
Generate points for a curved line between two coordinates using Bezier curves.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_curve_network" title="omicverse.pl.plot_curve_network">plot_curve_network</a></span>
<span class="mkapi-dash">—</span>
Create a network plot with curved edges and customizable node styling.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.plot_flowsig_network" title="omicverse.pl.plot_flowsig_network">plot_flowsig_network</a></span>
<span class="mkapi-dash">—</span>
Create a flowsig network visualization showing GEM modules and gene flows.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.embedding_atlas" title="omicverse.pl.embedding_atlas">embedding_atlas</a></span>
<span class="mkapi-dash">—</span>
Create high-resolution embedding plots using Datashader for large datasets.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_density_contour" title="omicverse.pl.add_density_contour">add_density_contour</a></span>
<span class="mkapi-dash">—</span>
Add KDE-based density contours to an existing matplotlib plot.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.calculate_gene_density" title="omicverse.pl.calculate_gene_density">calculate_gene_density</a></span>
<span class="mkapi-dash">—</span>
Calculate weighted kernel density estimates for gene expression on 2D embeddings.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.dotplot" title="omicverse.pl.dotplot">dotplot</a></span>
<span class="mkapi-dash">—</span>
Make a dot plot of the expression values of <code>var_names</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.rank_genes_groups_dotplot" title="omicverse.pl.rank_genes_groups_dotplot">rank_genes_groups_dotplot</a></span>
<span class="mkapi-dash">—</span>
Create a dot plot from rank_genes_groups results.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.rank_genes_groups_df" title="omicverse.pl.rank_genes_groups_df">rank_genes_groups_df</a></span>
<span class="mkapi-dash">—</span>
Return a DataFrame with the results of rank_genes_groups.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.spatial_segment" title="omicverse.pl.spatial_segment">spatial_segment</a></span>
<span class="mkapi-dash">—</span>
Plot spatial omics data with segmentation masks on top.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.spatial_segment_overlay" title="omicverse.pl.spatial_segment_overlay">spatial_segment_overlay</a></span>
<span class="mkapi-dash">—</span>
Plot multiple genes overlaid on the same spatial segmentation plot.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.violin" title="omicverse.pl.violin">violin</a></span>
<span class="mkapi-dash">—</span>
Enhanced violin plot compatible with scanpy's interface.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.add_streamplot" title="omicverse.pl.add_streamplot">add_streamplot</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.animate_streamplot" title="omicverse.pl.animate_streamplot">animate_streamplot</a></span>
<span class="mkapi-dash">—</span>
Create an animated streamplot visualization.</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.compute_velocity_on_grid" title="omicverse.pl.compute_velocity_on_grid">compute_velocity_on_grid</a></span>
<span class="mkapi-dash">—</span>
Compute velocity on a grid from embedded coordinates and velocities.
Adapted from scVelo Volker Bergen Nature Biotechnology 2020</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.nan_helper" title="omicverse.pl.nan_helper">nan_helper</a></span>
<span class="mkapi-dash">—</span>
Helper to handle indices and logical indices of NaNs</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity.get_cmap" title="omicverse.pl.ForbiddenCity.get_cmap">get_cmap</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity.get_color" title="omicverse.pl.ForbiddenCity.get_color">get_color</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity.get_color_rgb" title="omicverse.pl.ForbiddenCity.get_color_rgb">get_color_rgb</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity.get_cmap_seg" title="omicverse.pl.ForbiddenCity.get_cmap_seg">get_cmap_seg</a></span></p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.ForbiddenCity.visual_color" title="omicverse.pl.ForbiddenCity.visual_color">visual_color</a></span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity.get_cmap">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity.get_cmap" title="omicverse.pl.ForbiddenCity.get_cmap">get_cmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">color_range</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity.get_color">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity.get_color" title="omicverse.pl.ForbiddenCity.get_color">get_color</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">name</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity.get_color_rgb">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity.get_color_rgb" title="omicverse.pl.ForbiddenCity.get_color_rgb">get_color_rgb</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">name</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity.get_cmap_seg">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity.get_cmap_seg" title="omicverse.pl.ForbiddenCity.get_cmap_seg">get_cmap_seg</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">colors</span><span class="mkapi-comma">, </span><span class="mkapi-arg">N</span><span class="mkapi-equal">=</span><span class="mkapi-default">256</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ForbiddenCity.visual_color">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.ForbiddenCity" title="omicverse.pl.ForbiddenCity">ForbiddenCity</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.ForbiddenCity.visual_color" title="omicverse.pl.ForbiddenCity.visual_color">visual_color</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">loc_range</span><span class="mkapi-equal">=</span><span class="mkapi-default">(0, 385)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_per_row</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.Forbidden_Cmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.Forbidden_Cmap" title="omicverse.pl.Forbidden_Cmap">Forbidden_Cmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">color_range</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a colormap or color list from the Forbidden City color palette.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">color_range</span>
<span class="mkapi-dash">—</span>
list or sequence
Range of color indices to select from the Forbidden City palette</p>
</li>
<li>
<p><span class="mkapi-item-name">return_cmap</span>
<span class="mkapi-dash">—</span>
bool, optional (default=False)
Whether to return a matplotlib colormap object or HTML color codes</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>If return_cmap is True, returns matplotlib.colors.ListedColormap
If return_cmap is False, returns list of HTML color codes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.colormaps_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.colormaps_palette" title="omicverse.pl.colormaps_palette">colormaps_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">map_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">list</span></span>
</p>
<div class="mkapi-document">
<p>Returns a colormap palette.</p>
<p>colormap's name could be found in <code>https://pratiman-91.github.io/colormaps/</code></p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">map_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the colormap</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
List of hex color codes for the colormap</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.get_forbidden">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.get_forbidden" title="omicverse.pl.get_forbidden">get_forbidden</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get the complete Forbidden City color palette dictionary.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">dict</span>
<span class="mkapi-dash">—</span>
Dictionary containing traditional Chinese color names and their RGB/HTML values
Each color entry contains: num, name, name_en, color_rgb, color_html</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.optim_palette">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.optim_palette" title="omicverse.pl.optim_palette">optim_palette</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Optimized palette for plotting</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span>
<span class="mkapi-dash">—</span>
basis for plotting, which is the key of adata.obsm</p>
</li>
<li>
<p><span class="mkapi-item-name">colors</span>
<span class="mkapi-dash">—</span>
key of adata.obs for color</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
palette for plotting</p>
</li>
<li>
<p><span class="mkapi-item-name">kwargs</span>
<span class="mkapi-dash">—</span>
kwargs for spaco.colorize</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._palette.optim_palette.palette_spaco">palette_spaco</span></span> <span class="mkapi-dash">—</span>
palette for plotting</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ConvexHull">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.ConvexHull" title="omicverse.pl.ConvexHull">ConvexHull</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cluster_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hull_cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.2</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot the ConvexHull for a cluster in embedding.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str
Embedding method in adata.obsm</p>
</li>
<li>
<p><span class="mkapi-item-name">cluster_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str
Cluster key in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">hull_cluster</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str
Cluster to plot for ConvexHull</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
matplotlib.axes.Axes
Axes object</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span>
<span class="mkapi-dash">—</span>
str, optional (default=None)
Color for ConvexHull</p>
</li>
<li>
<p><span class="mkapi-item-name">alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, optional (default=0.2)
Alpha for ConvexHull</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax</span> <span class="mkapi-dash">—</span>
matplotlib.axes.Axes
    Modified axes object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_arrow">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_arrow" title="omicverse.pl.add_arrow">add_arrow</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_label</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_label</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrow_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrow_width</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Add arrow and label to the axis
Args:
    ax: matplotlib.axes.Axes
        The axis to add the arrow and label to.
    adata: AnnData
        The AnnData object to add the arrow and label to.
    basis: str
        The basis to add the arrow and label to.
    fontsize: int
        The fontsize of the label.
    arrow_scale: float
        The scale of the arrow.
    arrow_width: float
        The width of the arrow.
    x_label: str
        The label of the x-axis.
    y_label: str
        The label of the y-axis.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.bardotplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.bardotplot" title="omicverse.pl.bardotplot">bardotplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_values</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlabel</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylabel</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xticks_rotation</span><span class="mkapi-equal">=</span><span class="mkapi-default">90</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bar_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scatter_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cellproportion">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cellproportion" title="omicverse.pl.cellproportion">cellproportion</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_clusters</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby_li</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_awargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">transpose</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot cell proportion of each cell type in each visual cluster.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object.</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_clusters</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Cell type clusters.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Visual clusters.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby_li</span>
<span class="mkapi-dash">—</span>
Visual cluster list. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
Figure size. ((4,6))</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Ticks fontsize. (12)</p>
</li>
<li>
<p><span class="mkapi-item-name">labels_fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Labels fontsize. (12)</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
Matplotlib axes object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">legend</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to show legend. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_awargs</span>
<span class="mkapi-dash">—</span>
Legend arguments. ({'ncol':1})</p>
</li>
<li>
<p><span class="mkapi-item-name">transpose</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Whether to transpose the plot (horizontal bars). (False)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p>None</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cellstackarea">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cellstackarea" title="omicverse.pl.cellstackarea">cellstackarea</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_clusters</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby_li</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_awargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_show</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot the cell type percentage in each groupby category</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.contour">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.contour" title="omicverse.pl.contour">contour</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">clusters</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">grid_density</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">contour_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.dotplot_doublegroup">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.dotplot_doublegroup" title="omicverse.pl.dotplot_doublegroup">dotplot_doublegroup</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">'group'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding" title="omicverse.pl.embedding">embedding</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort_order</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'grey'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">neighbors_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrows</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrows_kwds</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">components</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dimensions</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">projection</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Literal">Literal</span>['2d', '3d']</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'2d'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_map</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], <span class="mkapi-tooltip" title="cycler.Cycler">Cycler</span>, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="scanpy.plotting._utils.ColorLike">ColorLike</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">'lightgray'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_in_legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">frameon</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'small'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, float, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontSize">_FontSize</span>, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontWeight">_FontWeight</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'right margin'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontoutline</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'right'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmin</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vcenter</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">norm</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_outline</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">outline_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.3, 0.05)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">outline_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[str, str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">('black', 'white')</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hspace</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">wspace</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">marker</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'.'</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span>, <span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, None]</span></span>
</p>
<div class="mkapi-document">
<p>Scatter plot for user specified embedding basis (e.g. umap, pca, etc).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Name of the <code>obsm</code> basis to use.</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span> <span class="mkapi-dash">—</span>
Keys for annotations of observations/cells or variables/genes. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_symbols</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Key for field in <code>.var</code> that stores gene symbols. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Use <code>.raw</code> attribute of <code>adata</code> if present. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">sort_order</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
For continuous annotations used as color parameter, plot data points with higher values on top of others. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Show edges between cells. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges_width</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Width of edges. (0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges_color</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Color of edges. ('grey')</p>
</li>
<li>
<p><span class="mkapi-item-name">neighbors_key</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Key to use for neighbors. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">arrows</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Show arrows for velocity. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">arrows_kwds</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span> <span class="mkapi-dash">—</span>
Keyword arguments for arrow plots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">groups</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Groups to highlight. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">components</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Components to plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">dimensions</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int], <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]]]]</span> <span class="mkapi-dash">—</span>
Dimensions to plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Name of the layer to use for coloring. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">projection</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Literal">Literal</span>['2d', '3d']</span> <span class="mkapi-dash">—</span>
Type of projection ('2d' or '3d'). ('2d')</p>
</li>
<li>
<p><span class="mkapi-item-name">scale_factor</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
Scaling factor for sizes. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">color_map</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span> <span class="mkapi-dash">—</span>
Colormap to use for continuous variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span> <span class="mkapi-dash">—</span>
Colormap to use for continuous variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], <span class="mkapi-tooltip" title="cycler.Cycler">Cycler</span>, None]</span> <span class="mkapi-dash">—</span>
Colors to use for categorical variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">na_color</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="scanpy.plotting._utils.ColorLike">ColorLike</span></span> <span class="mkapi-dash">—</span>
Color to use for NaN values. ('lightgray')</p>
</li>
<li>
<p><span class="mkapi-item-name">na_in_legend</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
Include NaN values in legend. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">size</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[float], None]</span> <span class="mkapi-dash">—</span>
Size of the dots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">frameon</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Draw a frame around the plot. ('small')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, float, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontSize">_FontSize</span>, None]</span> <span class="mkapi-dash">—</span>
Font size for legend. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontweight</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[int, <span class="mkapi-tooltip" title="scanpy.plotting._utils._FontWeight">_FontWeight</span>]</span> <span class="mkapi-dash">—</span>
Font weight for legend. ('bold')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_loc</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
Location of legend. ('right margin')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontoutline</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span> <span class="mkapi-dash">—</span>
Outline width for legend text. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">colorbar_loc</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
Location of colorbar. ('right')</p>
</li>
<li>
<p><span class="mkapi-item-name">vmax</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span> <span class="mkapi-dash">—</span>
Maximum value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">vmin</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span> <span class="mkapi-dash">—</span>
Minimum value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">vcenter</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="scanpy.plotting._utils.VBound">VBound</span>], None]</span> <span class="mkapi-dash">—</span>
Center value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">norm</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>], None]</span> <span class="mkapi-dash">—</span>
Normalization for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">add_outline</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Add outline to points. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">outline_width</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]</span> <span class="mkapi-dash">—</span>
Width of outline. ((0.3, 0.05))</p>
</li>
<li>
<p><span class="mkapi-item-name">outline_color</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[str, str]</span> <span class="mkapi-dash">—</span>
Color of outline. (('black', 'white'))</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
Number of columns for subplots. (4)</p>
</li>
<li>
<p><span class="mkapi-item-name">hspace</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
Height spacing between subplots. (0.25)</p>
</li>
<li>
<p><span class="mkapi-item-name">wspace</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
Width spacing between subplots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], None]</span> <span class="mkapi-dash">—</span>
Title for the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Show the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, None]</span> <span class="mkapi-dash">—</span>
Save the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span> <span class="mkapi-dash">—</span>
Matplotlib axes object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">return_fig</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
Return figure object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">marker</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Marker style. ('.')</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax</span> <span class="mkapi-dash">—</span>
If <code>show==False</code> a :class:<code>~matplotlib.axes.Axes</code> or a list of it.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding_adjust">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding_adjust" title="omicverse.pl.embedding_adjust">embedding_adjust</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">exclude</span><span class="mkapi-equal">=</span><span class="mkapi-default">()</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get locations of cluster median and adjust text labels accordingly.</p>
<p>Borrowed from scanpy github forum.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span>
<span class="mkapi-dash">—</span>
str
Key in adata.obs for grouping</p>
</li>
<li>
<p><span class="mkapi-item-name">exclude</span>
<span class="mkapi-dash">—</span>
tuple, optional (default=())
Groups to exclude from labeling</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span>
<span class="mkapi-dash">—</span>
str, optional (default='X_umap')
Embedding basis key in adata.obsm</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
matplotlib.axes.Axes, optional (default=None)
Axes object to plot on</p>
</li>
<li>
<p><span class="mkapi-item-name">adjust_kwargs</span>
<span class="mkapi-dash">—</span>
dict, optional (default=None)
Arguments for adjust_text function</p>
</li>
<li>
<p><span class="mkapi-item-name">text_kwargs</span>
<span class="mkapi-dash">—</span>
dict, optional (default=None)
Arguments for text annotation</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._single.embedding_adjust.medians">medians</span></span> <span class="mkapi-dash">—</span>
dict
    Dictionary of median positions for each group</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding_celltype">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding_celltype" title="omicverse.pl.embedding_celltype">embedding_celltype</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(6, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'major_celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(2, 9)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embedding_range</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(3, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlim</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1000</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return">tuple</span></span>
</p>
<div class="mkapi-document">
<p>Plot embedding with celltype color by omicverse.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData object</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, optional (default=(6,4))
Figure size</p>
</li>
<li>
<p><span class="mkapi-item-name">basis</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, optional (default='umap')
Embedding method</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, optional (default='major_celltype')
Celltype key in adata.obs</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str, optional (default=None)
Figure title</p>
</li>
<li>
<p><span class="mkapi-item-name">celltype_range</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, optional (default=(2,9))
Celltype range to plot</p>
</li>
<li>
<p><span class="mkapi-item-name">embedding_range</span> : 
<span class="mkapi-item-type">tuple</span> <span class="mkapi-dash">—</span>
tuple, optional (default=(3,10))
Embedding range to plot</p>
</li>
<li>
<p><span class="mkapi-item-name">xlim</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, optional (default=-1000)
X axis limit</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._single.embedding_celltype.fig">fig</span></span> <span class="mkapi-dash">—</span>
figure and axis
ax: axis</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding_density">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding_density" title="omicverse.pl.embedding_density">embedding_density</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_clusters</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.mde">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.mde" title="omicverse.pl.mde">mde</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot MDE embedding.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
figure and axis
ax: axis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.pca">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.pca" title="omicverse.pl.pca">pca</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot PCA embedding.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_boxplots">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_boxplots" title="omicverse.pl.plot_boxplots">plot_boxplots</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">feature_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">modality_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'coda'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_scale</span><span class="mkapi-equal">=</span><span class="mkapi-default">'relative'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_facets</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_dots</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_types</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">args_boxplot</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">args_swarmplot</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_legend</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">level_order</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Grouped boxplot visualization.</p>
<p>The cell counts for each cell type are shown as a group of boxplots
 with intra--group separation by a covariate from data.obs.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span>
<span class="mkapi-dash">—</span>
AnnData object or MuData object</p>
</li>
<li>
<p><span class="mkapi-item-name">feature_name</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
The name of the feature in data.obs to plot</p>
</li>
<li>
<p><span class="mkapi-item-name">modality_key</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
If data is a MuData object, specify which modality to use.</p>
</li>
<li>
<p><span class="mkapi-item-name">y_scale</span>
<span class="mkapi-dash">—</span>
Transformation to of cell counts. Options: "relative" - Relative abundance, "log" - log(count),
"log10" - log10(count), "count" - absolute abundance (cell counts).</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_facets</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If False, plot cell types on the x-axis. If True, plot as facets.</p>
</li>
<li>
<p><span class="mkapi-item-name">add_dots</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
If True, overlay a scatterplot with one dot for each data point.</p>
</li>
<li>
<p><span class="mkapi-item-name">cell_types</span>
<span class="mkapi-dash">—</span>
Subset of cell types that should be plotted.</p>
</li>
<li>
<p><span class="mkapi-item-name">args_boxplot</span>
<span class="mkapi-dash">—</span>
Arguments passed to sns.boxplot.</p>
</li>
<li>
<p><span class="mkapi-item-name">args_swarmplot</span>
<span class="mkapi-dash">—</span>
Arguments passed to sns.swarmplot.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
Figure size.</p>
</li>
<li>
<p><span class="mkapi-item-name">dpi</span>
<span class="mkapi-dash">—</span>
Dpi setting.</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
The seaborn color map for the barplot.</p>
</li>
<li>
<p><span class="mkapi-item-name">show_legend</span>
<span class="mkapi-dash">—</span>
If True, adds a legend.</p>
</li>
<li>
<p><span class="mkapi-item-name">level_order</span>
<span class="mkapi-dash">—</span>
Custom ordering of bars on the x-axis.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">Depending on <code>plot\_facets</code>, returns a</span> <span class="mkapi-dash">—</span>
class:<code>~matplotlib.axes.Axes</code> (<code>plot_facets = False</code>)
or: class:<code>~sns.axisgrid.FacetGrid</code> (<code>plot_facets = True</code>) object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pertpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pt</span>
<span class="n">haber_cells</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">haber_2017_regions</span><span class="p">()</span>
<span class="n">sccoda</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">Sccoda</span><span class="p">()</span>
<span class="n">mdata</span> <span class="o">=</span> <span class="n">sccoda</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">haber_cells</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"cell_level"</span><span class="p">,</span> <span class="n">generate_sample_level</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_type_identifier</span><span class="o">=</span><span class="s2">"cell_label"</span><span class="p">,</span>                 <span class="n">sample_identifier</span><span class="o">=</span><span class="s2">"batch"</span><span class="p">,</span> <span class="n">covariate_obs</span><span class="o">=</span><span class="p">[</span><span class="s2">"condition"</span><span class="p">])</span>
<span class="n">sccoda</span><span class="o">.</span><span class="n">plot_boxplots</span><span class="p">(</span><span class="n">mdata</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s2">"condition"</span><span class="p">,</span> <span class="n">add_dots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>Preview:
    .. image:: /_static/docstring_previews/sccoda_boxplots.png</p>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.single_group_boxplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.single_group_boxplot" title="omicverse.pl.single_group_boxplot">single_group_boxplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">type_color_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">kruskal_test</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_ticks_plot</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_plot</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bbox_to_anchor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(1, 0.55)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">point_number</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_pathway</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scatter_kwargs</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>adata (AnnData object): The data object containing the information for plotting.
groupby (str): The variable used for grouping the data.
color (str): The variable used for coloring the data points.
type_color_dict (dict): A dictionary mapping group categories to specific colors.
title (str): The title for the plot.
ylabel (str): The label for the y-axis.
kruskal_test (bool): Whether to perform a Kruskal-Wallis test and display the p-value on the plot.
figsize (tuple): The size of the plot figure in inches (width, height).
x_ticks_plot (bool): Whether to display x-axis tick labels.
legend_plot (bool): Whether to display a legend for the groups.
bbox_to_anchor (tuple): The position of the legend bbox (x, y) in axes coordinates.
save (bool): Whether to save the plot to a file.
point_number (int): The number of data points to be plotted for each group.
save_pathway (str): The file path for saving the plot (if save is True).
sort (bool): Whether to sort the groups based on their mean values.
scatter_kwargs (dict): Additional keyword arguments for customizing the scatter plot.
ax (matplotlib.axes.Axes): A pre-existing axes object for plotting (optional).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<p>ov.pl.single_group_boxplot(adata,groupby='clusters',
     color='Sox_aucell',
     type_color_dict=dict(zip(pd.Categorical(adata.obs['clusters']).categories, adata.uns['clusters_colors'])),
     x_ticks_plot=True,
     figsize=(5,4),
     kruskal_test=True,
     ylabel='Sox_aucell',
     legend_plot=False,
     bbox_to_anchor=(1,1),
     title='Expression',
     scatter_kwargs={'alpha':0.8,'s':10,'marker':'o'},
         point_number=15,
         sort=False,
         save=False,
         )</p>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.tsne">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.tsne" title="omicverse.pl.tsne">tsne</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot t-SNE embedding.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
figure and axis
ax: axis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.umap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.umap" title="omicverse.pl.umap">umap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot UMAP embedding.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">color</span>
<span class="mkapi-dash">—</span>
Keys for annotations of observations/cells or variables/genes. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_symbols</span>
<span class="mkapi-dash">—</span>
Key for field in <code>.var</code> that stores gene symbols. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span>
<span class="mkapi-dash">—</span>
Use <code>.raw</code> attribute of <code>adata</code> if present. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">sort_order</span>
<span class="mkapi-dash">—</span>
For continuous annotations used as color parameter, plot data points with higher values on top of others. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges</span>
<span class="mkapi-dash">—</span>
Show edges between cells. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges_width</span>
<span class="mkapi-dash">—</span>
Width of edges. (0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">edges_color</span>
<span class="mkapi-dash">—</span>
Color of edges. ('grey')</p>
</li>
<li>
<p><span class="mkapi-item-name">neighbors_key</span>
<span class="mkapi-dash">—</span>
Key to use for neighbors. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">arrows</span>
<span class="mkapi-dash">—</span>
Show arrows for velocity. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">arrows_kwds</span>
<span class="mkapi-dash">—</span>
Keyword arguments for arrow plots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">groups</span>
<span class="mkapi-dash">—</span>
Groups to highlight. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">components</span>
<span class="mkapi-dash">—</span>
Components to plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">dimensions</span>
<span class="mkapi-dash">—</span>
Dimensions to plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span>
<span class="mkapi-dash">—</span>
Name of the layer to use for coloring. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">projection</span>
<span class="mkapi-dash">—</span>
Type of projection ('2d' or '3d'). ('2d')</p>
</li>
<li>
<p><span class="mkapi-item-name">scale_factor</span>
<span class="mkapi-dash">—</span>
Scaling factor for sizes. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">color_map</span>
<span class="mkapi-dash">—</span>
Colormap to use for continuous variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
Colormap to use for continuous variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
Colors to use for categorical variables. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">na_color</span>
<span class="mkapi-dash">—</span>
Color to use for NaN values. ('lightgray')</p>
</li>
<li>
<p><span class="mkapi-item-name">na_in_legend</span>
<span class="mkapi-dash">—</span>
Include NaN values in legend. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">size</span>
<span class="mkapi-dash">—</span>
Size of the dots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">frameon</span>
<span class="mkapi-dash">—</span>
Draw a frame around the plot. ('small')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontsize</span>
<span class="mkapi-dash">—</span>
Font size for legend. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontweight</span>
<span class="mkapi-dash">—</span>
Font weight for legend. ('bold')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_loc</span>
<span class="mkapi-dash">—</span>
Location of legend. ('right margin')</p>
</li>
<li>
<p><span class="mkapi-item-name">legend_fontoutline</span>
<span class="mkapi-dash">—</span>
Outline width for legend text. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">colorbar_loc</span>
<span class="mkapi-dash">—</span>
Location of colorbar. ('right')</p>
</li>
<li>
<p><span class="mkapi-item-name">vmax</span>
<span class="mkapi-dash">—</span>
Maximum value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">vmin</span>
<span class="mkapi-dash">—</span>
Minimum value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">vcenter</span>
<span class="mkapi-dash">—</span>
Center value for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">norm</span>
<span class="mkapi-dash">—</span>
Normalization for colorbar. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">add_outline</span>
<span class="mkapi-dash">—</span>
Add outline to points. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">outline_width</span>
<span class="mkapi-dash">—</span>
Width of outline. ((0.3, 0.05))</p>
</li>
<li>
<p><span class="mkapi-item-name">outline_color</span>
<span class="mkapi-dash">—</span>
Color of outline. (('black', 'white'))</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span>
<span class="mkapi-dash">—</span>
Number of columns for subplots. (4)</p>
</li>
<li>
<p><span class="mkapi-item-name">hspace</span>
<span class="mkapi-dash">—</span>
Height spacing between subplots. (0.25)</p>
</li>
<li>
<p><span class="mkapi-item-name">wspace</span>
<span class="mkapi-dash">—</span>
Width spacing between subplots. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
Title for the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span>
<span class="mkapi-dash">—</span>
Show the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span>
<span class="mkapi-dash">—</span>
Save the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
Matplotlib axes object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">return_fig</span>
<span class="mkapi-dash">—</span>
Return figure object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">marker</span>
<span class="mkapi-dash">—</span>
Marker style. ('.')</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwargs</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
figure and axis
ax: axis</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.violin_box">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.violin_box" title="omicverse.pl.violin_box">violin_box</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keys</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_strip_points</span><span class="mkapi-equal">=</span><span class="mkapi-default">1000</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.violin_old">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.violin_old" title="omicverse.pl.violin_old">violin_old</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">keys</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">13</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotation</span><span class="mkapi-equal">=</span><span class="mkapi-default">90</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_palue">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_palue" title="omicverse.pl.add_palue">add_palue</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_x1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_x2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">line_y</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_y</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">11</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontcolor</span><span class="mkapi-equal">=</span><span class="mkapi-default">'#000000'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">horizontalalignment</span><span class="mkapi-equal">=</span><span class="mkapi-default">'center'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Add p-value annotation with connecting line to a matplotlib plot.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
matplotlib.axes.Axes object to add annotation to
line_x1: Starting x-coordinate of connecting line
line_x2: Ending x-coordinate of connecting line
line_y: Y-coordinate of connecting line
text_y: Y-offset for text placement above line
text: Text to display (typically p-value)
fontsize: Font size for text (11)
fontcolor: Color for line and text ('#000000')
horizontalalignment: Text horizontal alignment ('center')</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None: Adds annotation directly to the axes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.create_custom_colormap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.create_custom_colormap" title="omicverse.pl.create_custom_colormap">create_custom_colormap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_color</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a custom colormap based on cell type color.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_color</span>
<span class="mkapi-dash">—</span>
str
Base color for the cell type</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._general.create_custom_colormap.cmap">cmap</span></span> <span class="mkapi-dash">—</span>
matplotlib.colors.LinearSegmentedColormap
    Custom colormap</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.create_transparent_gradient_colormap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.create_transparent_gradient_colormap" title="omicverse.pl.create_transparent_gradient_colormap">create_transparent_gradient_colormap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">color1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">N</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a gradient colormap from transparent color1 to opaque color2.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">color1</span>
<span class="mkapi-dash">—</span>
Starting color (transparent)</p>
</li>
<li>
<p><span class="mkapi-item-name">color2</span>
<span class="mkapi-dash">—</span>
Ending color (opaque)</p>
</li>
<li>
<p><span class="mkapi-item-name">N</span>
<span class="mkapi-dash">—</span>
Number of color steps (default: 100)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">matplotlib.<span class="mkapi-tooltip" title="matplotlib.colors">colors</span>.<span class="mkapi-tooltip" title="matplotlib.colors.LinearSegmentedColormap">LinearSegmentedColormap</span></span> <span class="mkapi-dash">—</span>
Gradient colormap</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.check_pycomplexheatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.check_pycomplexheatmap" title="omicverse.pl.check_pycomplexheatmap">check_pycomplexheatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Check if PyComplexHeatmap is installed and available.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">None</span> <span class="mkapi-dash">—</span>
Prints version information or raises ImportError</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.complexheatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.complexheatmap" title="omicverse.pl.complexheatmap">complexheatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_names</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_color_bars</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_color_labels</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">left_color_bars</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">left_color_labels</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">right_color_bars</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">right_color_labels</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">marker_genes_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">index_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">value_name</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'parula'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_pathway</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_gap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">7</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_hpad</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">left_add_text</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_split_gap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">row_split_gap</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_height</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">left_height</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">right_height</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">row_cluster</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">row_split</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">col_split</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_legend</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">right_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate a complex annotated heatmap from single-cell RNA-seq data using PyComplexHeatmap.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object containing expression data
groupby: Grouping variable for cell categorization ('')
figsize: Figure dimensions as (width, height) ((6,10))
layer: Data layer to use for expression values (None)
use_raw: Whether to use raw expression data (False)
var_names: List of genes to include in heatmap (None, uses all)
gene_symbols: Gene symbol column name (None)
standard_scale: Standardization method - 'obs', 'var', or None (None)
col_color_bars: Color mapping dictionary for column annotations (None)
col_color_labels: Color mapping for column labels (None)
left_color_bars: Color mapping for left annotations (None)
left_color_labels: Color mapping for left labels (None)
right_color_bars: Color mapping for right annotations (None)
right_color_labels: Color mapping for right labels (None)
marker_genes_dict: Dictionary mapping cell types to marker genes (None)
index_name: Name for index column in melted data ('')
value_name: Name for value column in melted data ('')
cmap: Colormap for heatmap values ('parula')
xlabel: X-axis label (None)
ylabel: Y-axis label (None)
label: Plot label ('')
save: Whether to save the plot (False)
save_pathway: File path for saving ('')
legend_gap: Gap between legend items (7)
legend_hpad: Horizontal padding for legend (0)
show: Whether to display the plot (False)
left_add_text: Whether to add text to left annotations (False)
col_split_gap: Gap between column splits (1)
row_split_gap: Gap between row splits (1)
col_height: Height of column annotations (4)
left_height: Height of left annotations (4)
right_height: Height of right annotations (4)
col_cluster: Whether to cluster columns (False)
row_cluster: Whether to cluster rows (False)
row_split: Row splitting variable (None)
col_split: Column splitting variable (None)
legend: Whether to show legend (True)
plot_legend: Whether to plot legend (True)
right_fontsize: Font size for right annotations (12)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
cm: PyComplexHeatmap ClusterMapPlotter object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.global_imports">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.global_imports" title="omicverse.pl.global_imports">global_imports</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">modulename</span><span class="mkapi-comma">, </span><span class="mkapi-arg">shortname</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">asfunction</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Import a module into the global namespace with optional short name.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">modulename</span>
<span class="mkapi-dash">—</span>
Name of the module to import
shortname: Short name for the module (None, uses modulename)
asfunction: Whether to import as function (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None: Imports module into global namespace</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.marker_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.marker_heatmap" title="omicverse.pl.marker_heatmap">marker_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">marker_genes_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_map</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'RdBu_r'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'var'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expression_cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bbox_to_anchor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(5, -0.5)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(8, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spines</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_rownames</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_colnames</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_path</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a dot plot heatmap showing marker gene expression across cell types.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data object with expression data
marker_genes_dict: Dictionary mapping cell types to marker genes (None)
groupby: Column name for cell type grouping (None)
color_map: Colormap for expression values ('RdBu_r')
use_raw: Whether to use raw expression data (True)
standard_scale: Expression standardization method - 'var', 'group', or None ('var')
expression_cutoff: Minimum expression threshold for dot display (0.0)
bbox_to_anchor: Legend position as (x, y) coordinates ((5, -0.5))
figsize: Figure dimensions as (width, height) ((8,4))
spines: Whether to show plot spines (False)
fontsize: Font size for labels and text (12)
show_rownames: Whether to display row names (True)
show_colnames: Whether to display column names (True)
save_path: File path for saving plot (None)
ax: Existing matplotlib axes object (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding_multi">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding_multi" title="omicverse.pl.embedding_multi">embedding_multi</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create embedding scatter plots for multi-modal data (MuData) or single-cell data.</p>
<p>Produces scatter plots on specified embeddings, supporting cross-modality feature visualization.
For modality-specific embeddings, use format 'modality:embedding' (e.g., 'rna:X_pca').</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData or MuData object containing embedding and feature data
basis: Name of embedding in obsm (e.g., 'X_umap') or modality-specific ('rna:X_pca')
color: Gene names or obs columns to color points by (None)
use_raw: Whether to use .raw attribute for features (None, auto-determined)
layer: Specific data layer to use for coloring (None)
**kwargs: Additional arguments passed to embedding plotting function</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
Plot axes or figure depending on underlying plotting function</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">TypeError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.boxplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.boxplot" title="omicverse.pl.boxplot">boxplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">data</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hue</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_value</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y_value</span><span class="mkapi-comma">, </span><span class="mkapi-arg">width</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-equal">=</span><span class="mkapi-default">(1, 0.55)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">hue_order</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a boxplot with jittered points to visualize data distribution across categories.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">data</span>
<span class="mkapi-dash">—</span>
DataFrame containing the data to plot
hue: Column name for grouping variable (color coding)
x_value: Column name for x-axis categories
y_value: Column name for y-axis values
width: Width of each boxplot (0.3)
title: Plot title ('')
figsize: Figure dimensions as (width, height) ((6,3))
palette: Color palette for groups (None, uses default)
fontsize: Font size for labels and ticks (10)
legend_bbox: Legend position as (x, y) ((1, 0.55))
legend_ncol: Number of legend columns (1)
hue_order: Custom order for hue categories (None, uses alphabetical)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_grouped_fractions">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_grouped_fractions" title="omicverse.pl.plot_grouped_fractions">plot_grouped_fractions</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">res</span><span class="mkapi-comma">, </span><span class="mkapi-arg">obs</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">agg</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mean'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normalize</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>res: 行为 sample、列为 cell type 的预测比例表（你现在的 res）
obs: bulk_ad.obs
group_key: 例如 'severity' / 'disease_state' / 'gender' / 任意 obs 列
agg: 'mean' / 'median' / 'sum'
normalize: 是否把每组的细胞类型比例归一化到和为1</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.venn">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.venn" title="omicverse.pl.venn">venn</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">sets</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">out</span><span class="mkapi-equal">=</span><span class="mkapi-default">'./'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">'bgrc'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ext</span><span class="mkapi-equal">=</span><span class="mkapi-default">'png'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-equal">=</span><span class="mkapi-default">300</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">3.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bbox_to_anchor</span><span class="mkapi-equal">=</span><span class="mkapi-default">(0.5, 0.99)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nc</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cs</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a Venn diagram to visualize set overlaps.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">sets</span>
<span class="mkapi-dash">—</span>
Dictionary with set names as keys and sets as values ({})
out: Output directory path ('./')
palette: Color palette for sets ('bgrc')
ax: Matplotlib axes object or False to create new (False)
ext: File extension for output ('png')
dpi: Resolution for output image (300)
fontsize: Font size for text (3.5)
bbox_to_anchor: Legend position ((.5, .99))
nc: Number of legend columns (2)
cs: Font size for legend (4)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.volcano">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.volcano" title="omicverse.pl.volcano">volcano</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">result</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'qvalue'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fc_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">'log2FC'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">FC_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">titlefont</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-equal"> = </span><span class="mkapi-default">{'weight': 'normal', 'size': 14}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">up_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#e25d5d'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">down_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#7388c1'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normal_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#d7d7d7'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">up_fontcolor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#e25d5d'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">down_fontcolor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#7388c1'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normal_fontcolor</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#d7d7d7'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.8, -0.2)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann">list</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_genes_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_genes_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pval_threshold</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fc_max</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fc_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">-1.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a volcano plot for differential expression analysis.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">result</span>
<span class="mkapi-dash">—</span>
pandas.DataFrame
    Dataframe containing differential expression results with 'sig' column
pval_name: str, optional (default='qvalue')
    Column name for p-values/q-values
fc_name: str, optional (default='log2FC')
    Column name for fold change values<br/>
pval_max: float, optional (default=None)
    Maximum p-value for y-axis scaling
FC_max: float, optional (default=None)
    Maximum fold change for x-axis scaling
figsize: tuple, optional (default=(4,4))
    Figure size (width, height)
title: str, optional (default='')
    Plot title
titlefont: dict, optional (default={'weight':'normal','size':14})
    Font settings for title and axis labels
up_color: str, optional (default='#e25d5d')
    Color for upregulated genes
down_color: str, optional (default='#7388c1')
    Color for downregulated genes
normal_color: str, optional (default='#d7d7d7')
    Color for non-significant genes
up_fontcolor: str, optional (default='#e25d5d')
    Font color for upregulated gene labels
down_fontcolor: str, optional (default='#7388c1')
    Font color for downregulated gene labels
normal_fontcolor: str, optional (default='#d7d7d7')
    Font color for normal gene labels
legend_bbox: tuple, optional (default=(0.8, -0.2))
    Legend bounding box position
legend_ncol: int, optional (default=2)
    Number of legend columns
legend_fontsize: int, optional (default=12)
    Legend font size
plot_genes: list, optional (default=None)
    Specific genes to label on plot
plot_genes_num: int, optional (default=10)
    Number of top genes to label automatically
plot_genes_fontsize: int, optional (default=10)
    Font size for gene labels
ticks_fontsize: int, optional (default=12)
    Font size for axis ticks
pval_threshold: float, optional (default=0.05)
    P-value threshold for significance
fc_max: float, optional (default=1.5)
    Upper fold change threshold
fc_min: float, optional (default=-1.5)
    Lower fold change threshold
ax: matplotlib.axes, optional (default=None)
    Existing axes to plot on</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes
    The plot axes object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_pie2spatial">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_pie2spatial" title="omicverse.pl.add_pie2spatial">add_pie2spatial</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_columns</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pie_radius</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'hires'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spatial_coords</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pie_radius_px</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_proportion</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.9</span><span class="mkapi-comma">, </span><span class="mkapi-arg">remainder</span><span class="mkapi-equal">=</span><span class="mkapi-default">'gap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">remainder_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'lightgray'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">remainder_alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">renormalize_if_sum_gt1</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zorder</span><span class="mkapi-equal">=</span><span class="mkapi-default">80</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-equal">=</span><span class="mkapi-default">(1.05, 1.0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_pie_charts_to_spatial">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_pie_charts_to_spatial" title="omicverse.pl.add_pie_charts_to_spatial">add_pie_charts_to_spatial</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cell_type_columns</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spatial_coords</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pie_radius</span><span class="mkapi-equal">=</span><span class="mkapi-default">15</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pie_radius_px</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_proportion</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.01</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_gray_remainder</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">renormalize_if_sum_gt1</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zorder</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>在现有 spatial 图上叠加细胞比例饼图（高效 &amp; 兼容）</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">KeyError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.create_colormap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.create_colormap" title="omicverse.pl.create_colormap">create_colormap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">R</span><span class="mkapi-comma">, </span><span class="mkapi-arg">G</span><span class="mkapi-comma">, </span><span class="mkapi-arg">B</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a matplotlib colormap from RGB values with alpha gradient.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">R</span>
<span class="mkapi-dash">—</span>
Red component (0-255)
G: Green component (0-255)
B: Blue component (0-255)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
colormap: matplotlib.colors.ListedColormap object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.get_rgb_function">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.get_rgb_function" title="omicverse.pl.get_rgb_function">get_rgb_function</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cmap</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_value</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_value</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate a function to map continuous values to RGB using colormap.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
Matplotlib colormap object
min_value: Minimum value for color mapping
max_value: Maximum value for color mapping</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
func: Function that maps values to RGB colors</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.html_to_rgb">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.html_to_rgb" title="omicverse.pl.html_to_rgb">html_to_rgb</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">html_color</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert HTML hex color code to RGB tuple.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">html_color</span>
<span class="mkapi-dash">—</span>
HTML hex color string (e.g., '#FF0000' or 'FF0000')</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
rgb_color: RGB tuple with values 0-255</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_spatial">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_spatial" title="omicverse.pl.plot_spatial">plot_spatial</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'hires'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_img</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create spatial plot from Visium data with color gradient and interpolation.</p>
<p>Supports up to 7 cell types with default colors: yellow, orange, blue, green, purple, grey, white.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object with spatial coordinates in adata.obsm['spatial']
color: List of column names from adata.obs to plot
img_key: Image resolution key - 'hires' or 'lowres' ('hires')
show_img: Whether to display background tissue image (True)
**kwargs: Additional arguments passed to plot_spatial_general</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_spatial_general">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_spatial_general" title="omicverse.pl.plot_spatial_general">plot_spatial_general</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">value_df</span><span class="mkapi-comma">, </span><span class="mkapi-arg">coords</span><span class="mkapi-comma">, </span><span class="mkapi-arg">labels</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">circle_diameter</span><span class="mkapi-equal">=</span><span class="mkapi-default">4.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha_scaling</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_col</span><span class="mkapi-equal">=</span><span class="mkapi-default">(<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>, <span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.inf">inf</span>)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">max_color_quantile</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.98</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_img</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_text</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plt_axis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'off'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">axis_y_flipped</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x_y_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">('', '')</span><span class="mkapi-comma">, </span><span class="mkapi-arg">crop_x</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">crop_y</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">text_box_alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.9</span><span class="mkapi-comma">, </span><span class="mkapi-arg">reorder_cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">range(7)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">style</span><span class="mkapi-equal">=</span><span class="mkapi-default">'fast'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_position</span><span class="mkapi-equal">=</span><span class="mkapi-default">'bottom'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_label_kw</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_shape</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_tick_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_grid</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">image_cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Greys_r'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">white_spacing</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_title_fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create spatial plot with color gradient and interpolation for cell type abundances.</p>
<p>Supports up to 7 cell types with default colors: yellow, orange, blue, green, purple, grey, white.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object
value_df: DataFrame with cell abundances or features (max 7 columns) across locations
coords: Array with x,y coordinates for plotting spots
labels: List of cell type labels
text: DataFrame with x,y coordinates and text for annotations (None)
circle_diameter: Diameter of spot circles (4.0)
alpha_scaling: Color transparency adjustment factor (1.0)
max_col: Maximum colorscale values for each column ((np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf))
max_color_quantile: Quantile threshold for colorscale cropping (0.98)
show_img: Whether to display background image (True)
img: Background tissue image array (None)
img_alpha: Transparency of background image (1.0)
adjust_text: Whether to adjust text labels to prevent overlap (False)
plt_axis: Axis display setting ('off')
axis_y_flipped: Whether to flip y-axis to match image coordinates (True)
x_y_labels: Axis labels as (x_label, y_label) (('', ''))
crop_x: X-axis cropping limits as (min, max) (None)
crop_y: Y-axis cropping limits as (min, max) (None)
text_box_alpha: Transparency of text boxes (0.9)
reorder_cmap: Color order indices for categories (range(7))
style: Plot style - 'fast' or 'dark_background' ('fast')
colorbar_position: Colorbar position - 'bottom', 'right', or None ('bottom')
colorbar_label_kw: Keyword arguments for colorbar labels ({})
colorbar_shape: Colorbar shape parameters ({})
colorbar_tick_size: Colorbar tick label size (12)
colorbar_grid: Colorbar grid dimensions as (rows, cols) (None, auto-determined)
image_cmap: Colormap for grayscale background image ('Greys_r')
white_spacing: Percentage of colorbar hidden as white space (20)
palette: Custom color palette as list or dict (None, uses defaults)
legend_title_fontsize: Font size for legend titles (12)
return_ax: Whether to return axes object (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object, or (fig, ax) if return_ax=True</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.rgb_to_ryb">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.rgb_to_ryb" title="omicverse.pl.rgb_to_ryb">rgb_to_ryb</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">rgb</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert colors from RGB colorspace to RYB (red-yellow-blue) colorspace.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">rgb</span>
<span class="mkapi-dash">—</span>
RGB color array with shape (N, 3) or (3,)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ryb: RYB color array with same shape as input</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.ryb_to_rgb">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.ryb_to_rgb" title="omicverse.pl.ryb_to_rgb">ryb_to_rgb</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ryb</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Convert colors from RYB (red-yellow-blue) colorspace to RGB colorspace.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ryb</span>
<span class="mkapi-dash">—</span>
RYB color array with shape (N, 3) or (3,)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
rgb: RGB color array with same shape as input</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.spatial_value">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.spatial_value" title="omicverse.pl.spatial_value">spatial_value</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-comma">, </span><span class="mkapi-arg">library_id</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dot_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">white_spacing</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_show</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_tick_size</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default"><span class="mkapi-tooltip" title="omicverse.pl._space.create_colormap">create_colormap</span>(255, 0, 0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_title_fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_title_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_label_kw</span><span class="mkapi-equal">=</span><span class="mkapi-default">{}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">res</span><span class="mkapi-equal">=</span><span class="mkapi-default">'hires'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_show</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha_img</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Plot spatial expression values for a single gene or feature on tissue image.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData object with spatial data
color: Gene name or obs column to visualize
library_id: Spatial library identifier
dot_size: Size of spots on the plot (4)
white_spacing: White space percentage in colormap (20)
colorbar_show: Whether to display colorbar (True)
colorbar_tick_size: Font size for colorbar ticks (12)
cmap: Colormap for values (create_colormap(255, 0, 0))
legend_title_fontsize: Font size for legend title (12)
legend_title_color: Color for legend title (None, auto-determined)
colorbar_label_kw: Additional colorbar label arguments ({})
res: Image resolution - 'hires' or 'lowres' ('hires')
img_show: Whether to show background tissue image (True)
ax: Existing matplotlib axes object (None)
alpha_img: Transparency of background image (1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_chord">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_chord" title="omicverse.pl.cpdb_chord">cpdb_chord</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">interaction_edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">padding</span><span class="mkapi-equal">=</span><span class="mkapi-default">80</span><span class="mkapi-comma">, </span><span class="mkapi-arg">radius</span><span class="mkapi-equal">=</span><span class="mkapi-default">100</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">'chord.svg'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotation</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bg_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'#ffffff'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bg_transparancy</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.0</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a chord diagram visualization of CellPhoneDB interactions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data object with cell type information
interaction_edges: DataFrame with SOURCE, TARGET, and COUNT columns
celltype_key: Column name for cell type annotation
count_min: Minimum interaction count threshold (50)
nodecolor_dict: Custom color mapping for cell types (None, uses default)
fontsize: Font size for labels (12)
padding: Padding around chord diagram (80)
radius: Radius of the chord diagram (100)
save: File path to save SVG output ('chord.svg')
rotation: Rotation angle for the diagram (0)
bg_color: Background color ('#ffffff')
bg_transparancy: Background transparency (1.0)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: OpenChord figure object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_group_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_group_heatmap" title="omicverse.pl.cpdb_group_heatmap">cpdb_group_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_means</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(2, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_secret</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">{'Target': 'Blues', 'Source': 'Reds'}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_table</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a grouped heatmap showing ligand and receptor expression by cell type.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object with expression and cell type data
celltype_key: Column name for cell type annotation
means: CellPhoneDB means DataFrame with interaction data
source_cells: List of source cell types
target_cells: List of target cell types
min_means: Minimum mean expression threshold (3)
nodecolor_dict: Custom color mapping for cell types (None, uses default)
ax: Existing matplotlib axes object (None)
figsize: Figure dimensions as (width, height) ((2,6))
fontsize: Font size for labels (12)
plot_secret: Whether to show secreted/non-secreted annotation (True)
cmap: Colormap dictionary for Target and Source ({'Target':'Blues','Source':'Reds'})
return_table: Whether to return data table instead (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object or DataFrame if return_table=True</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_heatmap" title="omicverse.pl.cpdb_heatmap">cpdb_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">interaction_edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">11</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotate</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_kws</span><span class="mkapi-equal">=</span><span class="mkapi-default">{'fontsize': 8, 'bbox_to_anchor': (5, -0.5), 'loc': 'center left'}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_table</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a dot heatmap of CellPhoneDB interaction counts between cell types.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data object with cell type information
interaction_edges: DataFrame with SOURCE, TARGET, and COUNT columns
celltype_key: Column name for cell type annotation
nodecolor_dict: Custom color mapping for cell types (None, uses default)
ax: Existing matplotlib axes object (None)
source_cells: List of source cell types to include (None, uses all)
target_cells: List of target cell types to include (None, uses all)
figsize: Figure dimensions as (width, height) ((3,3))
fontsize: Font size for labels (11)
rotate: Whether to rotate the heatmap layout (False)
legend: Whether to show legend (True)
legend_kws: Legend keyword arguments ({'fontsize':8,'bbox_to_anchor':(5, -0.5),'loc':'center left',})
return_table: Whether to return data table instead (False)
**kwargs: Additional arguments passed to DotClustermapPlotter</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object or DataFrame if return_table=True</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_interacting_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_interacting_heatmap" title="omicverse.pl.cpdb_interacting_heatmap">cpdb_interacting_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalues</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_means</span><span class="mkapi-equal">=</span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(2, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_secret</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_table</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">transpose</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a detailed heatmap of specific interacting pairs with significance.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object with cell type information
celltype_key: Column name for cell type annotation
means: CellPhoneDB means DataFrame with interaction data
pvalues: CellPhoneDB pvalues DataFrame with significance data
source_cells: List of source cell types
target_cells: List of target cell types
min_means: Minimum mean expression threshold (3)
nodecolor_dict: Custom color mapping for cell types (None, uses default)
ax: Existing matplotlib axes object (None)
figsize: Figure dimensions as (width, height) ((2,6))
fontsize: Font size for labels (12)
plot_secret: Whether to show secreted/non-secreted annotation (True)
return_table: Whether to return data table instead (False)
transpose: Whether to transpose the heatmap layout (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object or DataFrame if return_table=True</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_interacting_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_interacting_network" title="omicverse.pl.cpdb_interacting_network">cpdb_interacting_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">means_sum_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(6, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_graph</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a detailed network showing ligand-receptor interactions between cell types.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object with cell type information
celltype_key: Column name for cell type annotation
means: CellPhoneDB means DataFrame with interaction data
source_cells: List of source cell types
target_cells: List of target cell types
means_min: Minimum interaction strength threshold (1)
means_sum_min: Minimum sum threshold for individual interactions (1)
nodecolor_dict: Custom color mapping for cell types (None, uses default)
ax: Existing matplotlib axes object (None)
figsize: Figure dimensions as (width, height) ((6,6))
fontsize: Font size for node labels (10)
return_graph: Whether to return NetworkX graph object (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object or NetworkX graph if return_graph=True</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.cpdb_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.cpdb_network" title="omicverse.pl.cpdb_network">cpdb_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">interaction_edges</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">celltype_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodecolor_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">source_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">target_cells</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edgeswidth_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">nodesize_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_graph</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a circular network plot of CellPhoneDB cell-cell interactions.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata">anndata</span>.<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
Annotated data object with cell type information
interaction_edges: DataFrame with SOURCE, TARGET, and COUNT columns
celltype_key: Column name for cell type annotation
nodecolor_dict: Custom color mapping for cell types (None, uses default)
count_min: Minimum interaction count threshold (50)
source_cells: List of source cell types to include (None, uses all)
target_cells: List of target cell types to include (None, uses all)
edgeswidth_scale: Scale factor for edge widths (1)
nodesize_scale: Scale factor for node sizes (1)
figsize: Figure dimensions as (width, height) ((4,4))
title: Plot title ('')
fontsize: Font size for labels (12)
ax: Existing matplotlib axes object (None)
return_graph: Whether to return NetworkX graph object (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object or NetworkX graph if return_graph=True</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.curved_graph">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.curved_graph" title="omicverse.pl.curved_graph">curved_graph</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">_graph</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eps</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pointn</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_dict</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw a network graph with curved edges and arrows.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">_graph</span>
<span class="mkapi-dash">—</span>
NetworkX graph object
pos: Node position dictionary (None)
eps: Curve control parameter (0.2)
pointn: Number of points along each curve (30)
linewidth: Width of edge lines (2)
alpha: Transparency of edges (0.3)
color_dict: Color mapping for edges (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None: Draws on current matplotlib axes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.curved_line">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.curved_line" title="omicverse.pl.curved_line">curved_line</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">x0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">x1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">y1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">eps</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pointn</span><span class="mkapi-equal">=</span><span class="mkapi-default">30</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate points for a curved line between two coordinates using Bezier curves.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">x0</span>
<span class="mkapi-dash">—</span>
Starting x coordinate
y0: Starting y coordinate
x1: Ending x coordinate
y1: Ending y coordinate
eps: Curve control parameter (0.8)
pointn: Number of points along the curve (30)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
x: Array of x coordinates along the curve
y: Array of y coordinates along the curve</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_curve_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_curve_network" title="omicverse.pl.plot_curve_network">plot_curve_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">G</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="networkx">nx</span>.<span class="mkapi-tooltip" title="networkx.classes.graph.Graph">Graph</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">G_type_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">G_color_dict</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'spring'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_dim</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_k</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pos_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.6</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_linewidths</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_node</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_node_num</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_shape</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_verticalalignment</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'center_baseline'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontfamily</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Arial'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">label_bbox</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_bbox</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0.7, 0.05)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_ncol</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_awarg</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylim</span><span class="mkapi-equal">=</span><span class="mkapi-default">(-0.5, 0.5)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlim</span><span class="mkapi-equal">=</span><span class="mkapi-default">(-3, 3)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a network plot with curved edges and customizable node styling.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">G</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="networkx">nx</span>.<span class="mkapi-tooltip" title="networkx.classes.graph.Graph">Graph</span></span> <span class="mkapi-dash">—</span>
NetworkX graph object
G_type_dict: Dictionary mapping nodes to types
G_color_dict: Dictionary mapping nodes to colors
pos_type: Layout algorithm - 'spring', 'kamada_kawai', or custom positions ('spring')
pos_dim: Dimensionality for layout algorithm (2)
figsize: Figure dimensions as (width, height) ((4, 4))
pos_scale: Scale factor for node positions (10)
pos_k: Optimal distance parameter for spring layout (None)
pos_alpha: Transparency for position calculation (0.4)
node_size: Base size for nodes (50)
node_alpha: Transparency for nodes (0.6)
node_linewidths: Width of node borders (1)
plot_node: Specific nodes to label (None, uses top degree nodes)
plot_node_num: Number of top nodes to label (20)
node_shape: Dictionary mapping node types to shapes (None)
label_verticalalignment: Vertical alignment for labels ('center_baseline')
label_fontsize: Font size for node labels (12)
label_fontfamily: Font family for labels ('Arial')
label_fontweight: Font weight for labels ('bold')
label_bbox: Bounding box properties for labels (None)
legend_bbox: Legend position as (x, y) ((0.7, 0.05))
legend_ncol: Number of legend columns (3)
legend_fontsize: Legend font size (12)
legend_fontweight: Legend font weight ('bold')
curve_awarg: Additional arguments for curved edges (None)
ylim: Y-axis limits as (min, max) ((-0.5,0.5))
xlim: X-axis limits as (min, max) ((-3,3))
ax: Existing matplotlib axes object (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.plot_flowsig_network">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.plot_flowsig_network" title="omicverse.pl.plot_flowsig_network">plot_flowsig_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">flow_network</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gem_plot</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_awarg</span><span class="mkapi-equal">=</span><span class="mkapi-default">{'eps': 2}</span><span class="mkapi-comma">, </span><span class="mkapi-arg">node_shape</span><span class="mkapi-equal">=</span><span class="mkapi-default">{'GEM': '^', 'Sender': 'o', 'Receptor': 'o'}</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create a flowsig network visualization showing GEM modules and gene flows.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">flow_network</span>
<span class="mkapi-dash">—</span>
NetworkX graph with flow connections
gem_plot: List of GEM modules to include in plot
figsize: Figure dimensions as (width, height) ((8,4))
curve_awarg: Arguments for curved edge drawing ({'eps':2})
node_shape: Dictionary mapping node types to shapes ({'GEM':'^','Sender':'o','Receptor':'o'})
**kwargs: Additional arguments passed to plot_curve_network</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure object
ax: matplotlib.axes.Axes object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.embedding_atlas">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.embedding_atlas" title="omicverse.pl.embedding_atlas">embedding_atlas</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'RdBu'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-equal">=</span><span class="mkapi-default">'right margin'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">frameon</span><span class="mkapi-equal">=</span><span class="mkapi-default">'small'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create high-resolution embedding plots using Datashader for large datasets.</p>
<p>Uses Datashader to render embeddings at high resolution, suitable for datasets
with millions of cells where standard scatter plots become ineffective.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object with embedding coordinates
basis: Key in adata.obsm containing embedding coordinates (e.g., 'X_umap')
color: Gene name or obs column to color cells by
title: Plot title (None, uses color name)
figsize: Figure dimensions as (width, height) ((4,4))
ax: Existing matplotlib axes object (None)
cmap: Colormap for continuous values ('RdBu')
legend_loc: Legend position ('right margin')
frameon: Frame style - False, 'small', or True ('small')
fontsize: Font size for labels and title (12)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
ax: matplotlib.axes.Axes object with rendered embedding</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_density_contour">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_density_contour" title="omicverse.pl.add_density_contour">add_density_contour</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ax</span><span class="mkapi-comma">, </span><span class="mkapi-arg">embeddings</span><span class="mkapi-comma">, </span><span class="mkapi-arg">weights</span><span class="mkapi-comma">, </span><span class="mkapi-arg">levels</span><span class="mkapi-equal">=</span><span class="mkapi-default">'quantile'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_quantiles</span><span class="mkapi-equal">=</span><span class="mkapi-default">5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">bw_adjust</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap_contour</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Greys'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">zorder</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fill</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.4</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Add KDE-based density contours to an existing matplotlib plot.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ax</span>
<span class="mkapi-dash">—</span>
matplotlib.axes.Axes object to draw contours on
embeddings: 2D coordinate array with shape (n_cells, 2)
weights: 1D weight array for KDE, will be min-max normalized
levels: Contour level specification - 'quantile' or list of values ('quantile')
n_quantiles: Number of quantile levels when levels='quantile' (5)
bw_adjust: Bandwidth adjustment factor for KDE (0.3)
cmap_contour: Colormap for contour lines ('Greys')
linewidth: Width of contour lines (1.0)
zorder: Drawing order for contours (10)
fill: Whether to fill contours (False for lines, True for filled)
alpha: Transparency for filled contours (0.4)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
cs: matplotlib contour object for potential colorbar addition</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.calculate_gene_density">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.calculate_gene_density" title="omicverse.pl.calculate_gene_density">calculate_gene_density</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">features</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dims</span><span class="mkapi-equal">=</span><span class="mkapi-default">(0, 1)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_expr</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate weighted kernel density estimates for gene expression on 2D embeddings.</p>
<p>Computes KDE for each feature using expression values as weights and stores
density values in adata.obs as 'density_{feature}' columns.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
Annotated data object with embedding coordinates
features: List of gene names or feature names to process
basis: Key in adata.obsm containing 2D embedding coordinates ('X_umap')
dims: Embedding dimensions to use as (x_dim, y_dim) ((0, 1))
adjust: Bandwidth scaling factor for KDE (1)
min_expr: Minimum expression threshold for including cells (0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
None: Updates adata.obs with density_{feature} columns</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz_plus.CellChatVizPlus">CellChatVizPlus</span></span></p></p>
<p>CellChat-like visualization for CellPhoneDB AnnData</p>
<p>Initialize with CellPhoneDB AnnData object</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span>
<span class="mkapi-dash">—</span>
AnnData
AnnData object with CellPhoneDB results</p>
<ul>
<li>obs: 'sender', 'receiver'</li>
<li>var: interaction information including 'classification'</li>
<li>layers: 'pvalues', 'means'</li>
</ul>
</li>
<li>
<p><span class="mkapi-item-name">palette</span>
<span class="mkapi-dash">—</span>
dict or list, optional
Color palette for cell types. Can be:</p>
<ul>
<li>dict: mapping cell type names to colors</li>
<li>list: list of colors (will be mapped to cell types in alphabetical order)</li>
<li>None: use default color scheme</li>
</ul>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle methods">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Methods</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.compute_aggregated_network" title="omicverse.pl.CellChatViz.compute_aggregated_network">compute_aggregated_network</a></span>
<span class="mkapi-dash">—</span>
Compute aggregated cell communication network</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_circle" title="omicverse.pl.CellChatViz.netVisual_circle">netVisual_circle</a></span>
<span class="mkapi-dash">—</span>
Circular network visualization (similar to CellChat's circle plot)
Uses sender cell type colors as edge gradient colors</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.get_ligand_receptor_pairs" title="omicverse.pl.CellChatViz.get_ligand_receptor_pairs">get_ligand_receptor_pairs</a></span>
<span class="mkapi-dash">—</span>
Get all significant ligand-receptor pair lists</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.mean" title="omicverse.pl.CellChatViz.mean">mean</a></span>
<span class="mkapi-dash">—</span>
Compute mean expression matrix for cell-cell interactions (like CellChat)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.pvalue" title="omicverse.pl.CellChatViz.pvalue">pvalue</a></span>
<span class="mkapi-dash">—</span>
Compute p-value matrix for cell-cell interactions (like CellChat)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.analyze_pathway_statistics" title="omicverse.pl.CellChatViz.analyze_pathway_statistics">analyze_pathway_statistics</a></span>
<span class="mkapi-dash">—</span>
Analyze and display detailed pathway statistics</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.compute_pathway_communication" title="omicverse.pl.CellChatViz.compute_pathway_communication">compute_pathway_communication</a></span>
<span class="mkapi-dash">—</span>
Calculate pathway-level cell communication strength (similar to CellChat methods)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.get_significant_pathways_v2" title="omicverse.pl.CellChatViz.get_significant_pathways_v2">get_significant_pathways_v2</a></span>
<span class="mkapi-dash">—</span>
Determine significant pathways based on pathway-level communication strength (more aligned with CellChat logic)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.demo_curved_arrows" title="omicverse.pl.CellChatViz.demo_curved_arrows">demo_curved_arrows</a></span>
<span class="mkapi-dash">—</span>
Demo function to show curved arrow effects</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_circle_focused" title="omicverse.pl.CellChatViz.netVisual_circle_focused">netVisual_circle_focused</a></span>
<span class="mkapi-dash">—</span>
Draw focused circular network diagram, showing only cell types with actual interactions</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_individual_circle" title="omicverse.pl.CellChatViz.netVisual_individual_circle">netVisual_individual_circle</a></span>
<span class="mkapi-dash">—</span>
Draw individual circular network diagrams for each cell type, showing its outgoing signals
Mimics CellChat functionality, using sender cell type colors as edge gradients</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_individual_circle_incoming" title="omicverse.pl.CellChatViz.netVisual_individual_circle_incoming">netVisual_individual_circle_incoming</a></span>
<span class="mkapi-dash">—</span>
Draw individual circular network diagrams for each cell type, showing its incoming signals
Uses sender cell type colors as edge gradients</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap" title="omicverse.pl.CellChatViz.netVisual_heatmap">netVisual_heatmap</a></span>
<span class="mkapi-dash">—</span>
Heatmap visualization of cell-cell communication</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea" title="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea">netVisual_heatmap_marsilea</a></span>
<span class="mkapi-dash">—</span>
Use marsilea package to draw cell-cell communication heatmap (mimicking CellChat's netVisual_heatmap function)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused" title="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused">netVisual_heatmap_marsilea_focused</a></span>
<span class="mkapi-dash">—</span>
Use marsilea package to draw focused cell-cell communication heatmap, showing only cell types with actual interactions</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord" title="omicverse.pl.CellChatViz.netVisual_chord">netVisual_chord</a></span>
<span class="mkapi-dash">—</span>
Chord diagram visualization</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_hierarchy" title="omicverse.pl.CellChatViz.netVisual_hierarchy">netVisual_hierarchy</a></span>
<span class="mkapi-dash">—</span>
Hierarchy plot visualization</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_bubble" title="omicverse.pl.CellChatViz.netVisual_bubble">netVisual_bubble</a></span>
<span class="mkapi-dash">—</span>
Bubble plot visualization</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.compute_pathway_network" title="omicverse.pl.CellChatViz.compute_pathway_network">compute_pathway_network</a></span>
<span class="mkapi-dash">—</span>
Compute pathway-level communication networks</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.identify_signaling_role" title="omicverse.pl.CellChatViz.identify_signaling_role">identify_signaling_role</a></span>
<span class="mkapi-dash">—</span>
Identify cellular signaling roles (sender, receiver, mediator, influencer)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.compute_network_similarity" title="omicverse.pl.CellChatViz.compute_network_similarity">compute_network_similarity</a></span>
<span class="mkapi-dash">—</span>
Compute pathway similarity (functional or structural similarity)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netEmbedding" title="omicverse.pl.CellChatViz.netEmbedding">netEmbedding</a></span>
<span class="mkapi-dash">—</span>
Pathway embedding and clustering visualization (UMAP)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_single_circle" title="omicverse.pl.CellChatViz.netVisual_single_circle">netVisual_single_circle</a></span>
<span class="mkapi-dash">—</span>
Draw circular network diagram for a single specified cell type
Uses sender cell type colors as edge gradients</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_aggregate" title="omicverse.pl.CellChatViz.netVisual_aggregate">netVisual_aggregate</a></span>
<span class="mkapi-dash">—</span>
Draw aggregated network diagram for specific signaling pathways (mimicking CellChat's netVisual_aggregate function)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.get_signaling_pathways" title="omicverse.pl.CellChatViz.get_signaling_pathways">get_signaling_pathways</a></span>
<span class="mkapi-dash">—</span>
Get all significant signaling pathway lists using statistically more reliable methods to combine p-values from multiple L-R pairs</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.plot_all_visualizations" title="omicverse.pl.CellChatViz.plot_all_visualizations">plot_all_visualizations</a></span>
<span class="mkapi-dash">—</span>
Generate all major visualization plots</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord_cell" title="omicverse.pl.CellChatViz.netVisual_chord_cell">netVisual_chord_cell</a></span>
<span class="mkapi-dash">—</span>
Create chord diagram visualization using mpl-chord-diagram (mimicking CellChat's netVisual_chord_cell function)</p>
</li>
<li>
<p><span class="mkapi-item-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord_LR" title="omicverse.pl.CellChatViz.netVisual_chord_LR">netVisual_chord_LR</a></span>
<span class="mkapi-dash">—</span>
Create chord diagram visualization for specific ligand-receptor pairs (mimicking CellChat's ligand-receptor level analysis)</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.compute_aggregated_network">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.compute_aggregated_network" title="omicverse.pl.CellChatViz.compute_aggregated_network">compute_aggregated_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_means</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute aggregated cell communication network</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold for significant interactions</p>
</li>
<li>
<p><span class="mkapi-item-name">use_means</span>
<span class="mkapi-dash">—</span>
bool
Whether to use mean expression values as weights</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz.CellChatViz.compute_aggregated_network.count_matrix">count_matrix</span></span> <span class="mkapi-dash">—</span>
np.array
    Number of interactions between cell types
weight_matrix: np.array
    Sum of interaction strengths between cell types</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_circle">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_circle" title="omicverse.pl.CellChatViz.netVisual_circle">netVisual_circle</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">matrix</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Cell-Cell Communication Network'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(10, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_curved_arrows</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_strength</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_text</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Circular network visualization (similar to CellChat's circle plot)
Uses sender cell type colors as edge gradient colors</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">matrix</span>
<span class="mkapi-dash">—</span>
np.array
Interaction matrix (count or weight)</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
str
Plot title</p>
</li>
<li>
<p><span class="mkapi-item-name">edge_width_max</span>
<span class="mkapi-dash">—</span>
float
Maximum edge width</p>
</li>
<li>
<p><span class="mkapi-item-name">vertex_size_max</span>
<span class="mkapi-dash">—</span>
float
Maximum vertex size</p>
</li>
<li>
<p><span class="mkapi-item-name">show_labels</span>
<span class="mkapi-dash">—</span>
bool
Whether to show cell type labels</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
str
Colormap for edges (used when use_sender_colors=False)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
tuple
Figure size</p>
</li>
<li>
<p><span class="mkapi-item-name">use_sender_colors</span>
<span class="mkapi-dash">—</span>
bool
Whether to use different colors for different sender cell types (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_curved_arrows</span>
<span class="mkapi-dash">—</span>
bool
Whether to use curved arrows like CellChat (default: True)</p>
</li>
<li>
<p><span class="mkapi-item-name">curve_strength</span>
<span class="mkapi-dash">—</span>
float
Strength of the curve (0 = straight, higher = more curved)</p>
</li>
<li>
<p><span class="mkapi-item-name">adjust_text</span>
<span class="mkapi-dash">—</span>
bool
Whether to use adjust_text library to prevent label overlapping (default: False)
If True, uses plt.text instead of nx.draw_networkx_labels</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.get_ligand_receptor_pairs">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.get_ligand_receptor_pairs" title="omicverse.pl.CellChatViz.get_ligand_receptor_pairs">get_ligand_receptor_pairs</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">min_interactions</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get all significant ligand-receptor pair lists</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">min_interactions</span>
<span class="mkapi-dash">—</span>
int
Minimum interaction count threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold for significance</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz.CellChatViz.get_ligand_receptor_pairs.lr_pairs">lr_pairs</span></span> <span class="mkapi-dash">—</span>
list
    Significant ligand-receptor pair list
lr_stats: dict
    Statistics for each ligand-receptor pair</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.mean">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.mean" title="omicverse.pl.CellChatViz.mean">mean</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute mean expression matrix for cell-cell interactions (like CellChat)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">count_min</span>
<span class="mkapi-dash">—</span>
int
Minimum count threshold to filter interactions (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
mean_matrix: pd.DataFrame
    Mean expression matrix with senders as index and receivers as columns</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.pvalue">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.pvalue" title="omicverse.pl.CellChatViz.pvalue">pvalue</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute p-value matrix for cell-cell interactions (like CellChat)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">count_min</span>
<span class="mkapi-dash">—</span>
int
Minimum count threshold to filter interactions (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
pvalue_matrix: pd.DataFrame
    Average p-value matrix with senders as index and receivers as columns</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.analyze_pathway_statistics">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.analyze_pathway_statistics" title="omicverse.pl.CellChatViz.analyze_pathway_statistics">analyze_pathway_statistics</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pathway_stats</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_details</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Analyze and display detailed pathway statistics</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pathway_stats</span>
<span class="mkapi-dash">—</span>
dict
Dictionary returned from get_signaling_pathways</p>
</li>
<li>
<p><span class="mkapi-item-name">show_details</span>
<span class="mkapi-dash">—</span>
bool
Whether to show detailed statistics for each pathway</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz.CellChatViz.analyze_pathway_statistics.summary_df">summary_df</span></span> <span class="mkapi-dash">—</span>
pd.DataFrame
    Summary statistics for all pathways</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.compute_pathway_communication">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.compute_pathway_communication" title="omicverse.pl.CellChatViz.compute_pathway_communication">compute_pathway_communication</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'mean'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_lr_pairs</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_expression</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Calculate pathway-level cell communication strength (similar to CellChat methods)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">method</span>
<span class="mkapi-dash">—</span>
str
    Aggregation method: 'mean', 'sum', 'max', 'median' (default: 'mean')
min_lr_pairs: int
    Minimum L-R pair count in pathway (default: 1)<br/>
min_expression: float
    Minimum expression threshold (default: 0.1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
pathway_communication: dict
    Contains communication matrix and statistics for each pathway</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.get_significant_pathways_v2">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.get_significant_pathways_v2" title="omicverse.pl.CellChatViz.get_significant_pathways_v2">get_significant_pathways_v2</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pathway_communication</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">strength_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_significant_pairs</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Determine significant pathways based on pathway-level communication strength (more aligned with CellChat logic)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pathway_communication</span>
<span class="mkapi-dash">—</span>
dict or None
    Pathway communication results, if None then recalculate
strength_threshold: float
    Pathway strength threshold (default: 0.1)
pvalue_threshold: float<br/>
    p-value threshold (default: 0.05)
min_significant_pairs: int
    Minimum significant cell pair count (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
significant_pathways: list
    Significant pathway list
pathway_summary: pd.DataFrame
    Pathway statistics summary</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.demo_curved_arrows">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.demo_curved_arrows" title="omicverse.pl.CellChatViz.demo_curved_arrows">demo_curved_arrows</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">signaling_pathway</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_strength</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(12, 10)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Demo function to show curved arrow effects</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">signaling_pathway</span>
<span class="mkapi-dash">—</span>
str or None
Signaling pathway to visualize, if None use aggregated network</p>
</li>
<li>
<p><span class="mkapi-item-name">curve_strength</span>
<span class="mkapi-dash">—</span>
float
Arrow curvature strength (0-1), 0 for straight lines, higher values for more curvature</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
tuple
Figure size</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_circle_focused">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_circle_focused" title="omicverse.pl.CellChatViz.netVisual_circle_focused">netVisual_circle_focused</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">matrix</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Cell-Cell Communication Network'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(10, 10)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_interaction_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_curved_arrows</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_strength</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw focused circular network diagram, showing only cell types with actual interactions</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">matrix</span>
<span class="mkapi-dash">—</span>
np.array
    Interaction matrix (count or weight)
title: str
    Plot title
edge_width_max: float
    Maximum edge width
vertex_size_max: float
    Maximum vertex size
show_labels: bool
    Whether to show cell type labels
cmap: str
    Colormap for edges (used when use_sender_colors=False)
figsize: tuple
    Figure size
min_interaction_threshold: float
    Minimum interaction strength to include cell type
use_sender_colors: bool
    Whether to use different colors for different sender cell types
use_curved_arrows: bool
    Whether to use curved arrows like CellChat (default: True)
curve_strength: float
    Strength of the curve (0 = straight, higher = more curved)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_individual_circle">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_individual_circle" title="omicverse.pl.CellChatViz.netVisual_individual_circle">netVisual_individual_circle</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(20, 15)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw individual circular network diagrams for each cell type, showing its outgoing signals
Mimics CellChat functionality, using sender cell type colors as edge gradients</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold for significant interactions</p>
</li>
<li>
<p><span class="mkapi-item-name">vertex_size_max</span>
<span class="mkapi-dash">—</span>
float
Maximum vertex size</p>
</li>
<li>
<p><span class="mkapi-item-name">edge_width_max</span>
<span class="mkapi-dash">—</span>
float
Maximum edge width (consistent across all plots for comparison)</p>
</li>
<li>
<p><span class="mkapi-item-name">show_labels</span>
<span class="mkapi-dash">—</span>
bool
Whether to show cell type labels</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
str
Colormap for edges (used when use_sender_colors=False)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
tuple
Figure size</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span>
<span class="mkapi-dash">—</span>
int
Number of columns in subplot layout</p>
</li>
<li>
<p><span class="mkapi-item-name">use_sender_colors</span>
<span class="mkapi-dash">—</span>
bool
Whether to use sender cell type colors for edges (default: True)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.figure.Figure
    Figure containing all subplots</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_individual_circle_incoming">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_individual_circle_incoming" title="omicverse.pl.CellChatViz.netVisual_individual_circle_incoming">netVisual_individual_circle_incoming</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(20, 15)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ncols</span><span class="mkapi-equal">=</span><span class="mkapi-default">4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw individual circular network diagrams for each cell type, showing its incoming signals
Uses sender cell type colors as edge gradients</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold for significant interactions</p>
</li>
<li>
<p><span class="mkapi-item-name">vertex_size_max</span>
<span class="mkapi-dash">—</span>
float
Maximum vertex size</p>
</li>
<li>
<p><span class="mkapi-item-name">edge_width_max</span>
<span class="mkapi-dash">—</span>
float
Maximum edge width</p>
</li>
<li>
<p><span class="mkapi-item-name">show_labels</span>
<span class="mkapi-dash">—</span>
bool
Whether to show cell type labels</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
str
Colormap for edges (used when use_sender_colors=False)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
tuple
Figure size</p>
</li>
<li>
<p><span class="mkapi-item-name">ncols</span>
<span class="mkapi-dash">—</span>
int
Number of columns in subplot layout</p>
</li>
<li>
<p><span class="mkapi-item-name">use_sender_colors</span>
<span class="mkapi-dash">—</span>
bool
Whether to use sender cell type colors for edges (default: True)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.figure.Figure
    Figure containing all subplots</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_heatmap">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap" title="omicverse.pl.CellChatViz.netVisual_heatmap">netVisual_heatmap</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">matrix</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Communication Heatmap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(10, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_values</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Heatmap visualization of cell-cell communication</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">matrix</span>
<span class="mkapi-dash">—</span>
np.array
Interaction matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
str
Plot title</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
str
Colormap</p>
</li>
<li>
<p><span class="mkapi-item-name">show_values</span>
<span class="mkapi-dash">—</span>
bool
Whether to show values in cells</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea" title="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea">netVisual_heatmap_marsilea</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">signaling</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_heatmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_dendrogram</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_row_sum</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_col_sum</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Communication Heatmap'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Use marsilea package to draw cell-cell communication heatmap (mimicking CellChat's netVisual_heatmap function)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">signaling</span>
<span class="mkapi-dash">—</span>
str, list or None
    Specific signaling pathway names. If None, show aggregated results of all pathways
pvalue_threshold: float
    P-value threshold for significant interactions
color_heatmap: str
    Heatmap colormap
add_dendrogram: bool
    Whether to add dendrogram
add_row_sum: bool
    Whether to show row sums on the left
add_col_sum: bool
    Whether to show column sums on top<br/>
linewidth: float
    Grid line width
figsize: tuple
    Figure size
title: str
    Heatmap title</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
h: marsilea heatmap object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused" title="omicverse.pl.CellChatViz.netVisual_heatmap_marsilea_focused">netVisual_heatmap_marsilea_focused</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">signaling</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_interaction_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color_heatmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_dendrogram</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_row_sum</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">add_col_sum</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 6)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Communication Heatmap'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Use marsilea package to draw focused cell-cell communication heatmap, showing only cell types with actual interactions</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">signaling</span>
<span class="mkapi-dash">—</span>
str, list or None
    Specific signaling pathway names
pvalue_threshold: float
    P-value threshold for significant interactions
min_interaction_threshold: float
    Minimum interaction strength threshold for filtering cell types
color_heatmap: str
    Heatmap colormap
add_dendrogram: bool
    Whether to add dendrogram
add_row_sum: bool
    Whether to show row sums on the left
add_col_sum: bool
    Whether to show column sums on top
linewidth: float
    Grid line width
figsize: tuple
    Figure size
title: str
    Heatmap title</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
h: marsilea heatmap object</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_chord">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord" title="omicverse.pl.CellChatViz.netVisual_chord">netVisual_chord</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">matrix</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Chord Diagram'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'tab20'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(12, 12)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Chord diagram visualization</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">matrix</span>
<span class="mkapi-dash">—</span>
np.array
Interaction matrix</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span>
<span class="mkapi-dash">—</span>
str
Plot title</p>
</li>
<li>
<p><span class="mkapi-item-name">threshold</span>
<span class="mkapi-dash">—</span>
float
Minimum value to show connection</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_hierarchy">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_hierarchy" title="omicverse.pl.CellChatViz.netVisual_hierarchy">netVisual_hierarchy</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pathway_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sources</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">targets</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(14, 10)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Hierarchy plot visualization</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pathway_name</span>
<span class="mkapi-dash">—</span>
str
Specific pathway to visualize (from classification)</p>
</li>
<li>
<p><span class="mkapi-item-name">sources</span>
<span class="mkapi-dash">—</span>
list
Source cell types to show</p>
</li>
<li>
<p><span class="mkapi-item-name">targets</span>
<span class="mkapi-dash">—</span>
list
Target cell types to show</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_bubble">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_bubble" title="omicverse.pl.CellChatViz.netVisual_bubble">netVisual_bubble</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">sources</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">targets</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathways</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(12, 10)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Bubble plot visualization</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">sources</span>
<span class="mkapi-dash">—</span>
list
Source cell types to include</p>
</li>
<li>
<p><span class="mkapi-item-name">targets</span>
<span class="mkapi-dash">—</span>
list
Target cell types to include</p>
</li>
<li>
<p><span class="mkapi-item-name">pathways</span>
<span class="mkapi-dash">—</span>
list
Pathways to include</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.compute_pathway_network">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.compute_pathway_network" title="omicverse.pl.CellChatViz.compute_pathway_network">compute_pathway_network</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute pathway-level communication networks</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz.CellChatViz.compute_pathway_network.pathway_networks">pathway_networks</span></span> <span class="mkapi-dash">—</span>
dict
    Dictionary with pathway names as keys and communication matrices as values</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.identify_signaling_role">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.identify_signaling_role" title="omicverse.pl.CellChatViz.identify_signaling_role">identify_signaling_role</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pattern</span><span class="mkapi-equal">=</span><span class="mkapi-default">'all'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Identify cellular signaling roles (sender, receiver, mediator, influencer)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pattern</span>
<span class="mkapi-dash">—</span>
str
"outgoing" for sender, "incoming" for receiver, "all" for overall</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.compute_network_similarity">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.compute_network_similarity" title="omicverse.pl.CellChatViz.compute_network_similarity">compute_network_similarity</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'functional'</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute pathway similarity (functional or structural similarity)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">method</span>
<span class="mkapi-dash">—</span>
str
'functional' or 'structural'</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netEmbedding">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netEmbedding" title="omicverse.pl.CellChatViz.netEmbedding">netEmbedding</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'functional'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_components</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(10, 8)</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Pathway embedding and clustering visualization (UMAP)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">method</span>
<span class="mkapi-dash">—</span>
str
'functional' or 'structural'</p>
</li>
<li>
<p><span class="mkapi-item-name">n_components</span>
<span class="mkapi-dash">—</span>
int
Number of UMAP components</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_single_circle">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_single_circle" title="omicverse.pl.CellChatViz.netVisual_single_circle">netVisual_single_circle</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">cell_type</span><span class="mkapi-comma">, </span><span class="mkapi-arg">direction</span><span class="mkapi-equal">=</span><span class="mkapi-default">'outgoing'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw circular network diagram for a single specified cell type
Uses sender cell type colors as edge gradients</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">cell_type</span>
<span class="mkapi-dash">—</span>
str
Cell type name to draw</p>
</li>
<li>
<p><span class="mkapi-item-name">direction</span>
<span class="mkapi-dash">—</span>
str
'outgoing' shows signals sent by this cell type, 'incoming' shows signals received</p>
</li>
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold for significant interactions</p>
</li>
<li>
<p><span class="mkapi-item-name">vertex_size_max</span>
<span class="mkapi-dash">—</span>
float
Maximum vertex size</p>
</li>
<li>
<p><span class="mkapi-item-name">edge_width_max</span>
<span class="mkapi-dash">—</span>
float
Maximum edge width</p>
</li>
<li>
<p><span class="mkapi-item-name">show_labels</span>
<span class="mkapi-dash">—</span>
bool
Whether to show cell type labels</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span>
<span class="mkapi-dash">—</span>
str
Colormap for edges (used when use_sender_colors=False)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span>
<span class="mkapi-dash">—</span>
tuple
Figure size</p>
</li>
<li>
<p><span class="mkapi-item-name">use_sender_colors</span>
<span class="mkapi-dash">—</span>
bool
Whether to use sender cell type colors for edges (default: True)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">fig</span> <span class="mkapi-dash">—</span>
matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_aggregate">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_aggregate" title="omicverse.pl.CellChatViz.netVisual_aggregate">netVisual_aggregate</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">signaling</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layout</span><span class="mkapi-equal">=</span><span class="mkapi-default">'circle'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_receiver</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_sender</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vertex_size_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">50</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edge_width_max</span><span class="mkapi-equal">=</span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_labels</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(10, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">focused_view</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_sender_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_curved_arrows</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">curve_strength</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.3</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_text</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Draw aggregated network diagram for specific signaling pathways (mimicking CellChat's netVisual_aggregate function)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">signaling</span>
<span class="mkapi-dash">—</span>
str or list
    Signaling pathway names (from adata.var['classification'])
layout: str
    Layout type: 'circle' or 'hierarchy'
vertex_receiver: list or None
    Receiver cell type names list (for hierarchy layout)
vertex_sender: list or None
    Sender cell type names list (for hierarchy layout)
pvalue_threshold: float
    P-value threshold for significant interactions
vertex_size_max: float
    Maximum vertex size
edge_width_max: float
    Maximum edge width
show_labels: bool
    Whether to show cell type labels
cmap: str
    Colormap for edges (used when use_sender_colors=False)
figsize: tuple
    Figure size
focused_view: bool
    Whether to use focused view (only show cell types with interactions) for circle layout
use_sender_colors: bool
    Whether to use different colors for different sender cell types
use_curved_arrows: bool
    Whether to use curved arrows like CellChat (default: True)
curve_strength: float
    Strength of the curve (0 = straight, higher = more curved)
adjust_text: bool
    Whether to use adjust_text library to prevent label overlapping (default: False)
    If True, uses plt.text instead of nx.draw_networkx_labels</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.get_signaling_pathways">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.get_signaling_pathways" title="omicverse.pl.CellChatViz.get_signaling_pathways">get_signaling_pathways</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">min_interactions</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pathway_pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'fisher'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">correction_method</span><span class="mkapi-equal">=</span><span class="mkapi-default">'fdr_bh'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_expression</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.1</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Get all significant signaling pathway lists using statistically more reliable methods to combine p-values from multiple L-R pairs</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">min_interactions</span>
<span class="mkapi-dash">—</span>
int
Minimum L-R pair count threshold per pathway (default: 1)</p>
</li>
<li>
<p><span class="mkapi-item-name">pathway_pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
Pathway-level p-value threshold (default: 0.05)</p>
</li>
<li>
<p><span class="mkapi-item-name">method</span>
<span class="mkapi-dash">—</span>
str
P-value combination method: 'fisher', 'stouffer', 'min', 'mean' (default: 'fisher')</p>
</li>
<li>
<p><span class="mkapi-item-name">correction_method</span>
<span class="mkapi-dash">—</span>
str
Multiple testing correction method: 'fdr_bh', 'bonferroni', 'holm', None (default: 'fdr_bh')</p>
</li>
<li>
<p><span class="mkapi-item-name">min_expression</span>
<span class="mkapi-dash">—</span>
float
Minimum expression threshold (default: 0.1)</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._cpdbviz.CellChatViz.get_signaling_pathways.pathways">pathways</span></span> <span class="mkapi-dash">—</span>
list
    Significant signaling pathway list
pathway_stats: dict
    Detailed statistics for each pathway</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.plot_all_visualizations">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.plot_all_visualizations" title="omicverse.pl.CellChatViz.plot_all_visualizations">plot_all_visualizations</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save_prefix</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Generate all major visualization plots</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">pvalue_threshold</span>
<span class="mkapi-dash">—</span>
float
P-value threshold</p>
</li>
<li>
<p><span class="mkapi-item-name">save_prefix</span>
<span class="mkapi-dash">—</span>
str
If provided, save figures with this prefix</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_chord_cell">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord_cell" title="omicverse.pl.CellChatViz.netVisual_chord_cell">netVisual_chord_cell</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">signaling</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">group_celltype</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sources</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">targets</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gap</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.03</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_gradient</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort</span><span class="mkapi-equal">=</span><span class="mkapi-default">'size'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">directed</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">chord_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotate_names</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontcolor</span><span class="mkapi-equal">=</span><span class="mkapi-default">'black'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start_at</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">extent</span><span class="mkapi-equal">=</span><span class="mkapi-default">360</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_chord_width</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normalize_to_sender</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create chord diagram visualization using mpl-chord-diagram (mimicking CellChat's netVisual_chord_cell function)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">signaling</span>
<span class="mkapi-dash">—</span>
str, list or None
    Specific signaling pathway names. If None, show aggregated results of all pathways
group_celltype: dict or None
    Cell type grouping mapping, e.g., {'CellA': 'GroupX', 'CellB': 'GroupX', 'CellC': 'GroupY'}
    If None, each cell type is shown individually
sources: list or None
    Specified sender cell type list. If None, include all cell types
targets: list or None
    Specified receiver cell type list. If None, include all cell types
pvalue_threshold: float
    P-value threshold for significant interactions
count_min: int
    Minimum interaction count threshold
gap: float
    Gap between chord diagram segments (0.03)
use_gradient: bool
    Whether to use gradient effects (True)
sort: str or None
    Sorting method: "size", "distance", None ("size")
directed: bool
    Whether to show directionality (True)
cmap: str or None
    Colormap name (None, use cell type colors)
chord_colors: str or None
    Chord colors (None)
rotate_names: bool
    Whether to rotate names (False)
fontcolor: str
    Font color ("black")
fontsize: int
    Font size (12)
start_at: int
    Starting angle (0)
extent: int
    Angle range covered by chord diagram (360)
min_chord_width: int
    Minimum chord width (0)
colors: list or None
    Custom color list (None, use cell type colors)
ax: matplotlib.axes.Axes or None
    Matplotlib axes object (None, create new plot)
figsize: tuple
    Figure size (8, 8)
title_name: str or None
    Plot title (None)
save: str or None
    Save file path (None)
normalize_to_sender: bool
    Whether to normalize to sender for equal arc widths (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.CellChatViz.netVisual_chord_LR">
<span class="mkapi-object-link">
<span class="mkapi-parent-toggle" title="Toggle class names">
<i class="fa-solid fa-square-plus"></i>
</span>
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">method</span>
<span class="mkapi-object-parent">
<a href="./#omicverse.pl.CellChatViz" title="omicverse.pl.CellChatViz">CellChatViz</a><span class="mkapi-dot">.</span></span><span class="mkapi-object-name"><a href="./#omicverse.pl.CellChatViz.netVisual_chord_LR" title="omicverse.pl.CellChatViz.netVisual_chord_LR">netVisual_chord_LR</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">ligand_receptor_pairs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sources</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">targets</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">pvalue_threshold</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.05</span><span class="mkapi-comma">, </span><span class="mkapi-arg">count_min</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gap</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.03</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_gradient</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">sort</span><span class="mkapi-equal">=</span><span class="mkapi-default">'size'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">directed</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">chord_colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotate_names</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontcolor</span><span class="mkapi-equal">=</span><span class="mkapi-default">'black'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">start_at</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">extent</span><span class="mkapi-equal">=</span><span class="mkapi-default">360</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_chord_width</span><span class="mkapi-equal">=</span><span class="mkapi-default">0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(8, 8)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title_name</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">normalize_to_sender</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create chord diagram visualization for specific ligand-receptor pairs (mimicking CellChat's ligand-receptor level analysis)</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">ligand_receptor_pairs</span>
<span class="mkapi-dash">—</span>
str, list or None
    Specific ligand-receptor pair names. Supports following formats:
    - Single string: "LIGAND_RECEPTOR" (e.g.: "TGFB1_TGFBR1")<br/>
    - String list: ["LIGAND1_RECEPTOR1", "LIGAND2_RECEPTOR2"]
    - If None, show aggregated results of all ligand-receptor pairs
sources: list or None
    Specified sender cell type list. If None, include all cell types
targets: list or None
    Specified receiver cell type list. If None, include all cell types
pvalue_threshold: float
    P-value threshold for significant interactions
count_min: int
    Minimum interaction count threshold
gap: float
    Gap between chord diagram segments
use_gradient: bool
    Whether to use gradient effects
sort: str or None
    Sorting method: "size", "distance", None
directed: bool
    Whether to show directionality
cmap: str or None
    Colormap name
chord_colors: str or None
    Chord colors
rotate_names: bool
    Whether to rotate names
fontcolor: str
    Font color
fontsize: int
    Font size
start_at: int
    Starting angle
extent: int
    Angle range covered by chord diagram
min_chord_width: int
    Minimum chord width
colors: list or None
    Custom color list
ax: matplotlib.axes.Axes or None
    Matplotlib axes object
figsize: tuple
    Figure size
title_name: str or None
    Plot title
save: str or None
    Save file path
normalize_to_sender: bool
    Whether to hide names of cell types without received signals (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
fig: matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.dotplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.dotplot" title="omicverse.pl.dotplot">dotplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_names</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="omicverse.pl._dotplot._VarNames">_VarNames</span>, <span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="omicverse.pl._dotplot._VarNames">_VarNames</span>]]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">num_categories</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">7</span><span class="mkapi-comma">, </span><span class="mkapi-arg">categories_order</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">expression_cutoff</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">mean_only_expressed</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">standard_scale</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Literal">Literal</span>['var', 'group']]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Mean expression\nin group'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size_title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Fraction of cells\nin group (%)'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dendrogram</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_group_positions</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_group_labels</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_group_rotation</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">swap_axes</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dot_color_df</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, bool]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">_AxesSubplot</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmin</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vmax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">vcenter</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">norm</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'Reds'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dot_max</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dot_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">smallest_dot</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">preserve_dict_order</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwds</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>, 'DotPlot']]</span></span>
</p>
<div class="mkapi-document">
<p>Make a dot plot of the expression values of <code>var_names</code>.</p>
<p>For each var_name and each <code>groupby</code> category a dot is plotted.
Each dot represents two values: mean expression within each category
(visualized by color) and fraction of cells expressing the <code>var_name</code> in the
category (visualized by the size of the dot).</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">var_names</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="omicverse.pl._dotplot._VarNames">_VarNames</span>, <span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="omicverse.pl._dotplot._VarNames">_VarNames</span>]]</span> <span class="mkapi-dash">—</span>
str or list of str or dict
Variables to plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
str or list of str
The key of the observation grouping to consider.</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional (default=None)
Use <code>raw</code> attribute of <code>adata</code> if present.</p>
</li>
<li>
<p><span class="mkapi-item-name">log</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, optional (default=False)
Whether to log-transform the data.</p>
</li>
<li>
<p><span class="mkapi-item-name">num_categories</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, optional (default=7)
Number of categories to show.</p>
</li>
<li>
<p><span class="mkapi-item-name">categories_order</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
list of str, optional (default=None)
Order of categories to display.</p>
</li>
<li>
<p><span class="mkapi-item-name">expression_cutoff</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, optional (default=0.0)
Expression cutoff for calculating fraction of expressing cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">mean_only_expressed</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, optional (default=False)
Whether to calculate mean only for expressing cells.</p>
</li>
<li>
<p><span class="mkapi-item-name">standard_scale</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Literal">Literal</span>['var', 'group']]</span> <span class="mkapi-dash">—</span>
{'var', 'group'} or None, optional (default=None)
Whether to standardize data.</p>
</li>
<li>
<p><span class="mkapi-item-name">title</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional (default=None)
Title for the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">colorbar_title</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional (default='Mean expression\nin group')
Title for the color bar.</p>
</li>
<li>
<p><span class="mkapi-item-name">size_title</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional (default='Fraction of cells\nin group (%)')
Title for the size legend.</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[float, float]]</span> <span class="mkapi-dash">—</span>
tuple, optional (default=None)
Figure size (width, height) in inches. If provided, the plot dimensions will be scaled accordingly.</p>
</li>
<li>
<p><span class="mkapi-item-name">dendrogram</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str]</span> <span class="mkapi-dash">—</span>
bool or str, optional (default=False)
Whether to add dendrogram to the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_symbols</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional (default=None)
Key for gene symbols in <code>adata.var</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">var_group_positions</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="typing.Tuple">Tuple</span>[int, int]]]</span> <span class="mkapi-dash">—</span>
list of tuples, optional (default=None)
Positions for variable groups.</p>
</li>
<li>
<p><span class="mkapi-item-name">var_group_labels</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
list of str, optional (default=None)
Labels for variable groups.</p>
</li>
<li>
<p><span class="mkapi-item-name">var_group_rotation</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Rotation angle for variable group labels.</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional (default=None)
Layer to use for expression data.</p>
</li>
<li>
<p><span class="mkapi-item-name">swap_axes</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional (default=False)
Whether to swap x and y axes.</p>
</li>
<li>
<p><span class="mkapi-item-name">dot_color_df</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span>]</span> <span class="mkapi-dash">—</span>
pandas.DataFrame, optional (default=None)
DataFrame for dot colors.</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional (default=None)
Whether to show the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, bool]]</span> <span class="mkapi-dash">—</span>
str or bool, optional (default=None)
Whether to save the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">_AxesSubplot</span>]</span> <span class="mkapi-dash">—</span>
matplotlib.axes.Axes, optional (default=None)
Axes object to plot on.</p>
</li>
<li>
<p><span class="mkapi-item-name">return_fig</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional (default=False)
Whether to return the figure object.</p>
</li>
<li>
<p><span class="mkapi-item-name">vmin</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Minimum value for color scaling.</p>
</li>
<li>
<p><span class="mkapi-item-name">vmax</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Maximum value for color scaling.</p>
</li>
<li>
<p><span class="mkapi-item-name">vcenter</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Center value for diverging colormap.</p>
</li>
<li>
<p><span class="mkapi-item-name">norm</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Normalize">Normalize</span>]</span> <span class="mkapi-dash">—</span>
matplotlib.colors.Normalize, optional (default=None)
Normalization object for colors.</p>
</li>
<li>
<p><span class="mkapi-item-name">cmap</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span>, str, None]</span> <span class="mkapi-dash">—</span>
str or matplotlib.colors.Colormap, optional (default='Reds')
Colormap for the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">dot_max</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Maximum dot size.</p>
</li>
<li>
<p><span class="mkapi-item-name">dot_min</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional (default=None)
Minimum dot size.</p>
</li>
<li>
<p><span class="mkapi-item-name">smallest_dot</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float, optional (default=0.0)
Size of the smallest dot.</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int, optional (default=12)
Font size for labels and legends. Titles will be one point larger.</p>
</li>
<li>
<p><span class="mkapi-item-name">preserve_dict_order</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool, optional (default=False)
When var_names is a dictionary, whether to preserve the original dictionary order.
If True, genes will be ordered according to the dictionary's insertion order.
If False (default), genes will be ordered according to cell type categories.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>, 'DotPlot']]</span> <span class="mkapi-dash">—</span>
If <code>return_fig</code> is True, returns the figure object.
If <code>show</code> is False, returns axes dictionary.</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.rank_genes_groups_dotplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.rank_genes_groups_dotplot" title="omicverse.pl.rank_genes_groups_dotplot">rank_genes_groups_dotplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">plot_type</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'dotplot'</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_genes</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">values_to_plot</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">var_names</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], <span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_logfoldchange</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwds</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span></span>
</p>
<div class="mkapi-document">
<p>Create a dot plot from rank_genes_groups results.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData
Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">plot_type</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str
Currently only 'dotplot' is supported.</p>
</li>
<li>
<p><span class="mkapi-item-name">groups</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]</span> <span class="mkapi-dash">—</span>
str or list of str, optional
Groups to include in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">n_genes</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[int]</span> <span class="mkapi-dash">—</span>
int, optional
Number of genes to include in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional
Key in <code>adata.obs</code> to group by.</p>
</li>
<li>
<p><span class="mkapi-item-name">values_to_plot</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional
Key in rank_genes_groups results to plot (e.g. 'logfoldchanges', 'scores').</p>
</li>
<li>
<p><span class="mkapi-item-name">var_names</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str], <span class="mkapi-tooltip" title="typing.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]]</span> <span class="mkapi-dash">—</span>
str or list of str or dict, optional
Variables to include in the plot. Can be:</p>
<ul>
<li>A list of gene names: ['gene1', 'gene2', ...]</li>
<li>A dictionary mapping group names to gene lists: {'group1': ['gene1', 'gene2'], 'group2': ['gene3', 'gene4']}</li>
</ul>
<p>When a dictionary is provided, genes will be grouped and labeled accordingly in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">min_logfoldchange</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float, optional
Minimum log fold change to include in the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">key</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional
Key in <code>adata.uns</code> to use for rank_genes_groups results.</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional
Whether to show the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool, optional
Whether to save the plot.</p>
</li>
<li>
<p><span class="mkapi-item-name">return_fig</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool
Whether to return the figure object.</p>
</li>
<li>
<p><span class="mkapi-item-name">gene_symbols</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str, optional
Key for gene symbols in <code>adata.var</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwds</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Any">Any</span></span> <span class="mkapi-dash">—</span>
dict
Additional keyword arguments to pass to dotplot.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="typing.Dict">Dict</span>, <span class="mkapi-tooltip" title="typing.Any">Any</span>]]</span> <span class="mkapi-dash">—</span>
If <code>return_fig</code> is True, returns the figure object.
If <code>show</code> is False, returns axes dictionary.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="c1"># Basic usage with top genes</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_groups_dotplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_genes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="c1"># Using logfoldchanges for coloring</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_groups_dotplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_genes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">values_to_plot</span><span class="o">=</span><span class="s1">'logfoldchanges'</span><span class="p">)</span>
</code></pre></div>
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="c1"># Grouping genes manually</span>
<span class="n">gene_groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Group1'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'gene1'</span><span class="p">,</span> <span class="s1">'gene2'</span><span class="p">],</span>
    <span class="s1">'Group2'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'gene3'</span><span class="p">,</span> <span class="s1">'gene4'</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_groups_dotplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="n">gene_groups</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.rank_genes_groups_df">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.rank_genes_groups_df" title="omicverse.pl.rank_genes_groups_df">rank_genes_groups_df</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">group</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'rank_genes_groups'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">gene_symbols</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log2fc_min</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="pandas">pd</span>.<span class="mkapi-tooltip" title="pandas.core.frame.DataFrame">DataFrame</span></span></span>
</p>
<div class="mkapi-document">
<p>Return a DataFrame with the results of rank_genes_groups.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.spatial_segment">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.spatial_segment" title="omicverse.pl.spatial_segment">spatial_segment</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_cell_id</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'segmentation'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_contourpx</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_outline</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span> | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>] | None</span></span>
</p>
<div class="mkapi-document">
<p>Plot spatial omics data with segmentation masks on top.</p>
<p>Argument <code>seg_cell_id</code> in :attr:<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData.obs"><code>anndata.AnnData.obs</code></span> controls unique segmentation mask's ids to be plotted.
By default, <code>'segmentation'</code>, <code>seg_key</code> for the segmentation and <code>'hires'</code> for the image is attempted.</p>
<div class="highlight"><pre><span></span><code>- Use ``seg_key`` to display the image in the background.
- Use ``seg_contourpx`` or ``seg_outline`` to control how the segmentation mask is displayed.
</code></pre></div>
<p>%(spatial_plot.summary_ext)s</p>
<p>.. seealso::
    - :func:<code>squidpy.pl.spatial_scatter</code> on how to plot spatial data with overlayed data on top.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">%(adata)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(plotting_segment)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(color)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(groups)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(library_id)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(library_key)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(spatial_key)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(plotting_image)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">%(plotting_features)s</span></p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span> | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>] | None</span> <span class="mkapi-dash">—</span>
%(spatial_plot.returns)s</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.spatial_segment_overlay">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.spatial_segment_overlay" title="omicverse.pl.spatial_segment_overlay">spatial_segment_overlay</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_cell_id</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[str]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'segmentation'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_contourpx</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">seg_outline</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmaps</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[str] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">library_id</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqStr">_SeqStr</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">library_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spatial_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'spatial'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="numpy">np</span>.<span class="mkapi-tooltip" title="numpy.core.multiarray.ndarray">ndarray</span>] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_res_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'hires'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_cmap</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="matplotlib.colors.Colormap">Colormap</span> | str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">img_channel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | list[int] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alt_var</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groups</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqStr">_SeqStr</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial.Palette_t">Palette_t</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">norm</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._Normalize">_Normalize</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">na_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | tuple[float, ...]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">(0, 0, 0, 0)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqFloat">_SeqFloat</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'spot_diameter_fullres'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scale_factor</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqFloat">_SeqFloat</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">crop_coord</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._CoordTuple">_CoordTuple</span> | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[<span class="mkapi-tooltip" title="omicverse.pl._spatial._CoordTuple">_CoordTuple</span>] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">connectivity_key</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1.0</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[str] | <span class="mkapi-tooltip" title="collections.abc.Sequence">Sequence</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'grey'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">frameon</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_loc</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'right margin'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | float | <span class="mkapi-tooltip" title="omicverse.pl._spatial._FontSize">_FontSize</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontweight</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | <span class="mkapi-tooltip" title="omicverse.pl._spatial._FontWeight">_FontWeight</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bold'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_fontoutline</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">legend_na</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_position</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'bottom'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_grid</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple[int, int] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_tick_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">10</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_title_size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">12</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_width</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_height</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">colorbar_spacing</span><span class="mkapi-colon">: </span><span class="mkapi-ann">dict[str, float] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scalebar_dx</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqFloat">_SeqFloat</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scalebar_units</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqStr">_SeqStr</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">title</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqStr">_SeqStr</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">axis_label</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._spatial._SeqStr">_SeqStr</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fig</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="matplotlib.figure.Figure">Figure</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">return_ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann">tuple[float, float] | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">dpi</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str | <span class="mkapi-tooltip" title="pathlib.Path">Path</span> | None</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">scalebar_kwargs</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="collections.abc.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="types.MappingProxyType">MappingProxyType</span>({})</span><span class="mkapi-comma">, </span><span class="mkapi-arg">edges_kwargs</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="collections.abc.Mapping">Mapping</span>[str, <span class="mkapi-tooltip" title="typing.Any">Any</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default"><span class="mkapi-tooltip" title="types.MappingProxyType">MappingProxyType</span>({})</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwargs</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Any">Any</span></span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span> | None</span></span>
</p>
<div class="mkapi-document">
<p>Plot multiple genes overlaid on the same spatial segmentation plot.</p>
<p>This function allows visualization of multiple genes in the same spatial context,
using different colors and transparency to show expression overlap and co-localization.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">%(adata)s</span></p>
</li>
<li>
<p><span class="mkapi-item-name">seg_cell_id</span> : 
<span class="mkapi-item-type">str</span></p>
</li>
<li>
<p><span class="mkapi-item-name">Key in</span>
<span class="mkapi-dash">—</span>
attr:<span class="mkapi-tooltip" title="anndata._core.anndata.AnnData.obs"><code>anndata.AnnData.obs</code></span> that contains unique cell IDs for segmentation.
color
Gene names or features to plot. Can be a single gene or list of genes.
seg
Segmentation mask. If <code>True</code>, uses segmentation from <code>adata.uns['spatial']</code>.
seg_key
Key for segmentation mask in <code>adata.uns['spatial'][library_id]['images']</code>.
seg_contourpx
Contour width in pixels. If specified, segmentation boundaries will be eroded.
seg_outline
If <code>True</code>, show segmentation boundaries.
alpha
Transparency level for gene expression overlay (0-1).
cmaps
Colormap(s) for each gene. If single string, uses same colormap for all genes.
If list, should match length of <span class="mkapi-tooltip" title="omicverse.pl._spatial.spatial_segment_overlay.color"><code>color</code></span> parameter.
%(library_id)s
%(library_key)s<br/>
%(spatial_key)s
%(plotting_image)s
%(plotting_features)s
groups
Categories to plot for categorical features.
palette
Color palette for categorical features.
norm
Colormap normalization.
na_color
Color for NA/missing values.
colorbar
Whether to show colorbars for each gene.
colorbar_position</p>
</li>
<li>
<p><span class="mkapi-item-name">Position of colorbars</span>
<span class="mkapi-dash">—</span>
'bottom', 'right', or 'none'.
colorbar_grid
Grid layout for colorbars as (rows, cols). If None, auto-determined.
colorbar_tick_size
Font size for colorbar tick labels.
colorbar_title_size
Font size for colorbar titles.
colorbar_width
Width of individual colorbars. If None, uses default values.
colorbar_height
Height of individual colorbars. If None, uses default values.
colorbar_spacing</p>
</li>
<li>
<p><span class="mkapi-item-name">Dictionary with spacing parameters</span>
<span class="mkapi-dash">—</span>
'hspace' (vertical gaps), 'wspace' (horizontal gaps).
If None, uses default spacing.
title
Plot title.
ax
Matplotlib axes object to plot on.
return_ax
Whether to return the axes object.
figsize
Figure size (width, height).
save
Path to save the figure.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type"><span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span> | None</span> <span class="mkapi-dash">—</span>
If <code>return_ax</code> is <code>True</code>, returns matplotlib axes object, otherwise <code>None</code>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle examples">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Examples</span>
</p>
<div class="mkapi-section-content">
<div class="mkapi-example-input highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">squidpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sq</span>
<span class="c1"># Overlay two genes with different colors</span>
<span class="n">sq</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial_segment_overlay</span><span class="p">(</span>
    <span class="n">adata</span><span class="p">,</span> 
    <span class="n">seg_cell_id</span><span class="o">=</span><span class="s1">'cell_id'</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">'gene1'</span><span class="p">,</span> <span class="s1">'gene2'</span><span class="p">],</span>
    <span class="n">cmaps</span><span class="o">=</span><span class="p">[</span><span class="s1">'Reds'</span><span class="p">,</span> <span class="s1">'Blues'</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.violin">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.violin" title="omicverse.pl.violin">violin</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span><span class="mkapi-comma">, </span><span class="mkapi-arg">keys</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-comma">, </span><span class="mkapi-arg">groupby</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">*</span><span class="mkapi-comma">, </span><span class="mkapi-arg">log</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">use_raw</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">stripplot</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">jitter</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">size</span><span class="mkapi-colon">: </span><span class="mkapi-ann">int</span><span class="mkapi-equal"> = </span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">layer</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">density_norm</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="omicverse.pl._violin.DensityNorm">DensityNorm</span></span><span class="mkapi-equal"> = </span><span class="mkapi-default">'width'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">order</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">multi_panel</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">xlabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">''</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ylabel</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">rotation</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">save</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">enhanced_style</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_means</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_boxplot</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">jitter_method</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'uniform'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">jitter_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.4</span><span class="mkapi-comma">, </span><span class="mkapi-arg">violin_alpha</span><span class="mkapi-colon">: </span><span class="mkapi-ann">float</span><span class="mkapi-equal"> = </span><span class="mkapi-default">0.8</span><span class="mkapi-comma">, </span><span class="mkapi-arg">background_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'white'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spine_color</span><span class="mkapi-colon">: </span><span class="mkapi-ann">str</span><span class="mkapi-equal"> = </span><span class="mkapi-default">'#b4aea9'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">grid_lines</span><span class="mkapi-colon">: </span><span class="mkapi-ann">bool</span><span class="mkapi-equal"> = </span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">statistical_tests</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, <span class="mkapi-tooltip" title="typing.List">List</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">False</span><span class="mkapi-comma">, </span><span class="mkapi-arg">custom_colors</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-colon">: </span><span class="mkapi-ann"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[tuple]</span><span class="mkapi-equal"> = </span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">13</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ticks_fontsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-star">**</span><span class="mkapi-arg">kwds</span><span class="mkapi-paren">)</span><span class="mkapi-arrow"> → </span><span class="mkapi-return"><span class="mkapi-tooltip" title="typing.Union">Union</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>, None]</span></span>
</p>
<div class="mkapi-document">
<p>Enhanced violin plot compatible with scanpy's interface.</p>
<p>This function provides all the functionality of scanpy's violin plot
with additional customization options for enhanced visualization,
implemented using pure matplotlib.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">adata</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="anndata._core.anndata.AnnData">AnnData</span></span> <span class="mkapi-dash">—</span>
AnnData. Annotated data matrix.</p>
</li>
<li>
<p><span class="mkapi-item-name">keys</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
str | Sequence[str]. Keys for accessing variables of <code>.var_names</code> or fields of <code>.obs</code>.</p>
</li>
<li>
<p><span class="mkapi-item-name">groupby</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str | None. The key of the observation grouping to consider. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">log</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Plot on logarithmic axis. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">use_raw</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool | None. Whether to use <code>raw</code> attribute of <code>adata</code>. Defaults to <code>True</code> if <code>.raw</code> is present. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">stripplot</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Add a stripplot on top of the violin plot. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">jitter</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[float, bool]</span> <span class="mkapi-dash">—</span>
float | bool. Add jitter to the stripplot (only when stripplot is True). (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">size</span> : 
<span class="mkapi-item-type">int</span> <span class="mkapi-dash">—</span>
int. Size of the jitter points. (1)</p>
</li>
<li>
<p><span class="mkapi-item-name">layer</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[str]</span> <span class="mkapi-dash">—</span>
str | None. Name of the AnnData object layer that wants to be plotted. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">density_norm</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="omicverse.pl._violin.DensityNorm">DensityNorm</span></span> <span class="mkapi-dash">—</span>
str. The method used to scale the width of each violin. If 'width' (the default), each violin will have the same width. If 'area', each violin will have the same area. If 'count', a violin's width corresponds to the number of observations. ('width')</p>
</li>
<li>
<p><span class="mkapi-item-name">order</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Sequence[str] | None. Order in which to show the categories. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">multi_panel</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool | None. Display keys in multiple panels also when <code>groupby is not None</code>. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">xlabel</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str. Label of the x axis. ('')</p>
</li>
<li>
<p><span class="mkapi-item-name">ylabel</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[str, <span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]]</span> <span class="mkapi-dash">—</span>
str | Sequence[str] | None. Label of the y axis. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">rotation</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[float]</span> <span class="mkapi-dash">—</span>
float | None. Rotation of xtick labels. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">show</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[bool]</span> <span class="mkapi-dash">—</span>
bool | None. Whether to show the plot. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">save</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str]]</span> <span class="mkapi-dash">—</span>
bool | str | None. Path to save the figure. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">ax</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="matplotlib.axes._axes.Axes">Axes</span>]</span> <span class="mkapi-dash">—</span>
Axes | None. A matplotlib axes object. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">enhanced_style</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Whether to apply enhanced styling. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">show_means</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Whether to show mean values with annotations. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">show_boxplot</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Whether to overlay box plots on violins. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">jitter_method</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str. Method for jittering: 'uniform' or 't_dist'. ('uniform')</p>
</li>
<li>
<p><span class="mkapi-item-name">jitter_alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float. Transparency of jittered points. (0.4)</p>
</li>
<li>
<p><span class="mkapi-item-name">violin_alpha</span> : 
<span class="mkapi-item-type">float</span> <span class="mkapi-dash">—</span>
float. Transparency of violin plots. (0.8)</p>
</li>
<li>
<p><span class="mkapi-item-name">background_color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str. Background color of the plot. ('white')</p>
</li>
<li>
<p><span class="mkapi-item-name">spine_color</span> : 
<span class="mkapi-item-type">str</span> <span class="mkapi-dash">—</span>
str. Color of plot spines. ('#b4aea9')</p>
</li>
<li>
<p><span class="mkapi-item-name">grid_lines</span> : 
<span class="mkapi-item-type">bool</span> <span class="mkapi-dash">—</span>
bool. Whether to show horizontal grid lines. (True)</p>
</li>
<li>
<p><span class="mkapi-item-name">statistical_tests</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Union">Union</span>[bool, str, <span class="mkapi-tooltip" title="typing.List">List</span>[str]]</span> <span class="mkapi-dash">—</span>
bool | str | List[str]. Statistical tests to perform. Options: False (no tests), True (auto-select), 'wilcox', 'ttest', 'anova', 'kruskal', 'mannwhitney', or list of methods. (False)</p>
</li>
<li>
<p><span class="mkapi-item-name">custom_colors</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[<span class="mkapi-tooltip" title="typing.Sequence">Sequence</span>[str]]</span> <span class="mkapi-dash">—</span>
Sequence[str] | None. Custom colors for groups. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">figsize</span> : 
<span class="mkapi-item-type"><span class="mkapi-tooltip" title="typing.Optional">Optional</span>[tuple]</span> <span class="mkapi-dash">—</span>
tuple | None. Figure size (width, height). (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">fontsize</span>
<span class="mkapi-dash">—</span>
int. Font size for labels and ticks. (13)</p>
</li>
<li>
<p><span class="mkapi-item-name">ticks_fontsize</span>
<span class="mkapi-dash">—</span>
int | None. Font size for axis ticks. If None, uses fontsize-1. (None)</p>
</li>
<li>
<p><span class="mkapi-item-name">**kwds</span>
<span class="mkapi-dash">—</span>
Additional keyword arguments passed to violinplot.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle returns">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Returns</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ax</span> <span class="mkapi-dash">—</span>
matplotlib.axes.Axes | None. A matplotlib axes object if <code>ax</code> is <code>None</code> else <code>None</code>.</p>
</li>
</ul>
</div>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle raises">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Raises</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-type">ImportError</span></p>
</li>
<li>
<p><span class="mkapi-item-type">ValueError</span></p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.Streamlines">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span><span class="mkapi-object-kind">class</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.Streamlines" title="omicverse.pl.Streamlines">Streamlines</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X</span><span class="mkapi-comma">, </span><span class="mkapi-arg">Y</span><span class="mkapi-comma">, </span><span class="mkapi-arg">U</span><span class="mkapi-comma">, </span><span class="mkapi-arg">V</span><span class="mkapi-comma">, </span><span class="mkapi-arg">res</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.125</span><span class="mkapi-comma">, </span><span class="mkapi-arg">spacing</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">maxLen</span><span class="mkapi-equal">=</span><span class="mkapi-default">2500</span><span class="mkapi-comma">, </span><span class="mkapi-arg">detectLoops</span><span class="mkapi-equal">=</span><span class="mkapi-default">False</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p><p class="mkapi-bases" markdown="1">Bases :
<span class="mkapi-base">object</span></p></p>
<p>Copyright (c) 2011 Raymond Speth.
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the "Software"),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
See: http://web.mit.edu/speth/Public/streamlines.py</p>
<p>Compute a set of streamlines covering the given velocity field.
X and Y - 1D or 2D (e.g. generated by np.meshgrid) arrays of the
          grid points. The mesh spacing is assumed to be uniform
          in each dimension.
U and V - 2D arrays of the velocity field.
res - Sets the distance between successive points in each
      streamline (same units as X and Y)
spacing - Sets the minimum density of streamlines, in grid points.
maxLen - The maximum length of an individual streamline segment.
detectLoops - Determines whether an attempt is made to stop extending
              a given streamline before reaching maxLen points if
              it forms a closed loop or reaches a velocity node.
Plots are generated with the 'plot' or 'plotArrows' methods.</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.add_streamplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.add_streamplot" title="omicverse.pl.add_streamplot">add_streamplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">adata</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">velocity_key</span><span class="mkapi-equal">=</span><span class="mkapi-default">'velocity_S'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">density</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">smooth</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_mass</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">autoscale</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_for_stream</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">ax</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">arrow_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'k'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">stream_kwargs</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document"></div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.animate_streamplot">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.animate_streamplot" title="omicverse.pl.animate_streamplot">animate_streamplot</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X_grid</span><span class="mkapi-comma">, </span><span class="mkapi-arg">V_grid</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adata</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_frames</span><span class="mkapi-equal">=</span><span class="mkapi-default">20</span><span class="mkapi-comma">, </span><span class="mkapi-arg">interval</span><span class="mkapi-equal">=</span><span class="mkapi-default">40</span><span class="mkapi-comma">, </span><span class="mkapi-arg">fps</span><span class="mkapi-equal">=</span><span class="mkapi-default">25</span><span class="mkapi-comma">, </span><span class="mkapi-arg">alpha_animate</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.7</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cmap_stream</span><span class="mkapi-equal">=</span><span class="mkapi-default">'Blues'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">linewidth</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.5</span><span class="mkapi-comma">, </span><span class="mkapi-arg">segment_length</span><span class="mkapi-equal">=</span><span class="mkapi-default">1</span><span class="mkapi-comma">, </span><span class="mkapi-arg">figsize</span><span class="mkapi-equal">=</span><span class="mkapi-default">(4, 4)</span><span class="mkapi-comma">, </span><span class="mkapi-arg">basis</span><span class="mkapi-equal">=</span><span class="mkapi-default">'X_umap'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'celltype'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">palette</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">background_color</span><span class="mkapi-equal">=</span><span class="mkapi-default">'black'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">saveto</span><span class="mkapi-equal">=</span><span class="mkapi-default">'animation.gif'</span><span class="mkapi-comma">, </span><span class="mkapi-arg">show_plot</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">streamline_res</span><span class="mkapi-equal">=</span><span class="mkapi-default">0.125</span><span class="mkapi-comma">, </span><span class="mkapi-arg">streamline_spacing</span><span class="mkapi-equal">=</span><span class="mkapi-default">2</span><span class="mkapi-comma">, </span><span class="mkapi-arg">streamline_maxLen</span><span class="mkapi-equal">=</span><span class="mkapi-default">2500</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Create an animated streamplot visualization.</p>
<p class="mkapi-section">
<span class="mkapi-object-link">
<span class="mkapi-section-toggle" title="Toggle parameters">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-section-name">Parameters</span>
</p>
<div class="mkapi-section-content">
<ul class="mkapi-item-list">
<li>
<p><span class="mkapi-item-name">X_grid</span>
<span class="mkapi-dash">—</span>
array-like
    Grid coordinates [X, Y] where X and Y are 2D arrays
V_grid: array-like<br/>
    Velocity field [U, V] where U and V are 2D arrays
adata: AnnData object, optional
    Annotated data object for background scatter plot
n_frames: int, default=20
    Number of animation frames
interval: int, default=40
    Delay between frames in milliseconds
fps: int, default=25
    Frames per second for saved animation
alpha_animate: float, default=0.7
    Alpha transparency for streamlines
cmap_stream: str, default='Blues'
    Colormap for streamlines
linewidth: float, default=0.5
    Width of streamlines
segment_length: float, default=1
    Length scaling for streamline segments
figsize: tuple, default=(4, 4)
    Figure size
basis: str, default='X_umap'
    Basis for background scatter plot
color: str, default='celltype'
    Color variable for background scatter plot
palette: dict, optional
    Color palette for background scatter plot
saveto: str, default='animation.gif'
    Output filename for animation
show_plot: bool, default=True
    Whether to display the plot
streamline_res: float, default=0.125
    Resolution for streamline computation
streamline_spacing: int, default=2
    Spacing for streamline computation
streamline_maxLen: int, default=2500
    Maximum length for streamlines</p>
</li>
<li>
<p><span class="mkapi-item-name">Returns</span>
<span class="mkapi-dash">—</span>
animation: FuncAnimation
    The matplotlib animation object</p>
</li>
</ul>
</div>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.compute_velocity_on_grid">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.compute_velocity_on_grid" title="omicverse.pl.compute_velocity_on_grid">compute_velocity_on_grid</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">X_emb</span><span class="mkapi-comma">, </span><span class="mkapi-arg">V_emb</span><span class="mkapi-comma">, </span><span class="mkapi-arg">density</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">smooth</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">n_neighbors</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">min_mass</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-comma">, </span><span class="mkapi-arg">autoscale</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">adjust_for_stream</span><span class="mkapi-equal">=</span><span class="mkapi-default">True</span><span class="mkapi-comma">, </span><span class="mkapi-arg">cutoff_perc</span><span class="mkapi-equal">=</span><span class="mkapi-default">None</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Compute velocity on a grid from embedded coordinates and velocities.
Adapted from scVelo Volker Bergen Nature Biotechnology 2020</p>
</div>
<p class="mkapi-object mkapi-page-source" id="omicverse.pl.nan_helper">
<span class="mkapi-object-link">
<span class="mkapi-definition-link"></span>
<span class="mkapi-document-toggle" title="Toggle all docs">
<i class="fa-regular fa-square-minus"></i>
</span>
</span>
<span class="mkapi-object-name"><a href="./#omicverse.pl.nan_helper" title="omicverse.pl.nan_helper">nan_helper</a></span><span class="mkapi-signature"><span class="mkapi-paren">(</span><span class="mkapi-arg">y</span><span class="mkapi-paren">)</span></span>
</p>
<div class="mkapi-document">
<p>Helper to handle indices and logical indices of NaNs</p>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2019-2025, 112 Lab, USTB
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.fc8c2696.min.js"></script>
<script src="../../../javascript/mkapi.js"></script>
<script src="../../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>